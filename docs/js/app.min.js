if(function(e){"use strict";const t={};"function"==typeof define&&define.amd?define(()=>t):"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.me=t),e.me=t}(this),window.onReady=function(e){console.warn("Deprecated: window.onReady, use me.device.onReady instead"),me.device.onReady.call(this,e)},window.throttle||(window.throttle=function(e,t,i){let n,o=window.performance.now();return"boolean"!=typeof t&&(t=!1),function(){const r=window.performance.now(),s=r-o,a=arguments;if(!(s<e))return o=r,i(...a);!1===t&&(clearTimeout(n),n=setTimeout(()=>(o=r,i(...a)),s))}}),"undefined"==typeof console&&(console={log(){},info(){},error(){alert(Array.prototype.slice.call(arguments).join(", "))}}),function(){let e=0;const t=["ms","moz","webkit","o"];let i,n=window.requestAnimationFrame,o=window.cancelAnimationFrame;for(i=0;i<t.length&&!n;++i)n=window[`${t[i]}RequestAnimationFrame`];for(i=0;i<t.length&&!o;++i)o=window[`${t[i]}CancelAnimationFrame`]||window[`${t[i]}CancelRequestAnimationFrame`];n&&o||(n=function(t){const i=window.performance.now(),n=Math.max(0,1e3/60-(i-e)),o=window.setTimeout(()=>{t(i+n)},n);return e=i+n,o},o=function(e){window.clearTimeout(e)},window.requestAnimationFrame=n,window.cancelAnimationFrame=o)}(),Function.prototype.defer=function(){return setTimeout(this.bind.apply(this,arguments),.01)},function(){function e(e,t,i){return e.prototype[t].apply(this,i)}const t=function(){Object.apply(this,arguments)};(t.prototype=Object.create(Object.prototype)).constructor=t,Object.defineProperty(t,"extend",{value:function t(){const i={},n=new Array(arguments.length);for(let e=0;e<arguments.length;e++)n.push(arguments[e]);function o(){return this.init.apply(this,arguments),this}if(o.prototype=Object.create(this.prototype),n.forEach(e=>{!function(e,t,i){Object.keys(i).forEach(n=>{if(t[n]=i[n],"function"!=typeof i[n])throw new TypeError(`extend: Method \`${n}\` is not a function`);Object.defineProperty(e.prototype,n,{configurable:!0,value:i[n]})})}(o,i,e.__methods__||e)}),!("init"in o.prototype))throw new TypeError("extend: Class is missing a constructor named `init`");return Object.defineProperty(o.prototype,"_super",{value:e}),Object.defineProperty(o,"__methods__",{value:i}),o.extend=t,o}}),"undefined"!=typeof window?window.Jay=t:module.exports=t}(),me.Object=window.Jay,Object.is||(Object.is=function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}),Object.assign||(Object.assign=function(e){"use strict";if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");const t=Object(e);for(let e=1;e<arguments.length;e++){const i=arguments[e];if(void 0!==i&&null!==i)for(const e in i)i.hasOwnProperty(e)&&(t[e]=i[e])}return t}),me.Error=me.Object.extend.bind(Error)({init(e){this.name="me.Error",this.message=e}}),Math.sign||(Math.sign=function(e){return 0===(e=+e)||isNaN(e)?Number(e):e>0?1:-1}),Number.prototype.clamp=function(e,t){return this<e?e:this>t?t:+this},Number.prototype.random=function(e,t){return t||(t=e,e=this),~~(Math.random()*(t-e))+e},Number.prototype.randomFloat=function(e,t){return t||(t=e,e=this),Math.random()*(t-e)+e},Number.prototype.weightedRandom=function(e,t){return t||(t=e,e=this),~~(Math.pow(Math.random(),2)*(t-e))+e},Number.prototype.round=function(e,t){const i=Math.pow(10,t||e||0);return~~(.5+(e=arguments.length<2?this:e)*i)/i},Number.prototype.toHex=function(){return"0123456789ABCDEF".charAt(this-this%16>>4)+"0123456789ABCDEF".charAt(this%16)},Number.prototype.degToRad=function(e){return(e||this)/180*Math.PI},Number.prototype.radToDeg=function(e){return(e||this)*(180/Math.PI)},String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")}),String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")}),String.prototype.isNumeric=function(){return!isNaN(this)&&""!==this.trim()},String.prototype.isBoolean=function(){const e=this.trim();return"true"===e||"false"===e},String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),String.prototype.toHex=function(){let e="",t=0;for(;t<this.length;)e+=this.charCodeAt(t++).toString(16);return e},Array.prototype.remove=function(e){const t=Array.prototype.indexOf.call(this,e);return-1!==t&&Array.prototype.splice.call(this,t,1),this},Array.prototype.random=function(e){return e[(0).random(e.length)]},Array.prototype.weightedRandom=function(e){return e[(0).weightedRandom(e.length)]},me.TypedArray=function(e){let t=0;if(Array.isArray(e))this.concat(e.slice());else{if(1!==arguments.length||"number"!=typeof e)throw new me.Error("TypedArray polyfill: Unsupported constructor arguments",arguments);for(t=0;t<e;t++)this.push(0)}},me.TypedArray.prototype=Array.prototype,me.TypedArray.prototype.set=function(e,t){if(t=t||0,e.length+t>this.length)throw new me.Error("TypedArray pollyfill: Buffer overflow in set");for(let i=0;i<e.length;i++,t++)this[t]=e[i]},window.Float32Array=window.Float32Array||me.TypedArray,window.Uint8Array=window.Uint8Array||me.TypedArray,window.Uint16Array=window.Uint16Array||me.TypedArray,window.Uint32Array=window.Uint32Array||me.TypedArray,void 0===window.performance&&(window.performance={}),!window.performance.now){let e=Date.now();window.performance.timing&&window.performance.timing.navigationStart&&(e=window.performance.timing.navigationStart),window.performance.now=function(){return Date.now()-e}}function rwc(e,t=50,i=Math.random,n=2){const o=(t-50)/50,r=e.length;if(!r)return null;const s=e.reduce((e,t)=>e+t.weight,0)/r,a={},h=e.reduce((e,t)=>{const{id:i,weight:r}=t;let h=r+o*n*(s-r);return h<0&&(h=0),a[i]=(a[i]||0)+h,e+h},0);let l=0;const c={};if(Object.keys(a).forEach(e=>{l+=a[e],c[e]=l}),h<1)return null;const u=i()*h,d=Object.keys(c);for(let e=0;e<d.length;e+=1){const t=d[e];if(u<=c[t])return t}}!function(e){"use strict";let t,i=Object.defineProperty,n=Object.is;function o(e,t){function n(e){if(!this||this.constructor!==n)return new n(e);this._keys=[],this._values=[],this._itp=[],this.objectOnly=t,e&&function(e){this.add?e.forEach(this.add,this):e.forEach(function(e){this.set(e[0],e[1])},this)}.call(this,e)}return t||i(e,"size",{get:f}),e.constructor=n,n.prototype=e,n}function r(e){return this.has(e)&&(this._keys.splice(t,1),this._values.splice(t,1),this._itp.forEach(e=>{t<e[0]&&e[0]--})),-1<t}function s(e){return this.has(e)?this._values[t]:void 0}function a(e,i){if(this.objectOnly&&i!==Object(i))throw new TypeError("Invalid value used as weak collection key");if(i!=i||0===i)for(t=e.length;t--&&!n(e[t],i););else t=e.indexOf(i);return-1<t}function h(e){return a.call(this,this._values,e)}function l(e){return a.call(this,this._keys,e)}function c(e,i){return this.has(e)?this._values[t]=i:this._values[this._keys.push(e)-1]=i,this}function u(e){return this.has(e)||this._values.push(e),this}function d(){(this._keys||0).length=this._values.length=0}function p(){return m(this._itp,this._values)}function m(e,t,i){let n=[0],o=!1;return e.push(n),{next(){let r,s=n[0];return!o&&s<t.length?(r=i?[t[s],i[s]]:t[s],n[0]++):(o=!0,e.splice(e.indexOf(n),1)),{done:o,value:r}}}}function f(){return this._values.length}function g(e,t){const i=this.entries();for(;;){const n=i.next();if(n.done)break;e.call(t,n.value[1],n.value[0],this)}}"undefined"==typeof WeakMap&&(e.WeakMap=o({delete:r,clear:d,get:s,has:l,set:c},!0)),"undefined"!=typeof Map&&"function"==typeof(new Map).values&&(new Map).values().next||(e.Map=o({delete:r,has:l,get:s,set:c,keys:function(){return m(this._itp,this._keys)},values:p,entries:function(){return m(this._itp,this._keys,this._values)},forEach:g,clear:d})),"undefined"!=typeof Set&&"function"==typeof(new Set).values&&(new Set).values().next||(e.Set=o({has:h,add:u,delete:r,clear:d,keys:p,values:p,entries:function(){return m(this._itp,this._values,this._values)},forEach:g})),"undefined"==typeof WeakSet&&(e.WeakSet=o({delete:r,add:u,clear:d,has:h},!0))}("undefined"!=typeof exports&&"undefined"!=typeof global?global:window),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ES6Promise=t()}(this,()=>{"use strict";function e(e){return"function"==typeof e}let t=void 0;const i=t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};let n=0,o=void 0,r=void 0,s=function(e,t){p[n]=e,p[n+1]=t,2===(n+=2)&&(r?r(m):f())};const a="undefined"!=typeof window?window:void 0,h=a||{},l=h.MutationObserver||h.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),u="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){const e=setTimeout;return function(){return e(m,1)}}var p=new Array(1e3);function m(){for(let e=0;e<n;e+=2){(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0}n=0}var f=void 0;function g(e,t){const i=this,n=new this.constructor(w);void 0===n[v]&&D(n);const o=i._state;if(o){const e=arguments[o-1];s(()=>I(o,n,e,i._result))}else O(i,n,e,t);return n}function y(e){if(e&&"object"==typeof e&&e.constructor===this)return e;const t=new this(w);return A(t,e),t}f=c?function(){return process.nextTick(m)}:l?function(){let e=0;const t=new l(m),i=document.createTextNode("");return t.observe(i,{characterData:!0}),function(){i.data=e=++e%2}}():u?function(){const e=new MessageChannel;return e.port1.onmessage=m,function(){return e.port2.postMessage(0)}}():void 0===a&&"function"==typeof require?function(){try{const e=require("vertx");return void 0!==(o=e.runOnLoop||e.runOnContext)?function(){o(m)}:d()}catch(e){return d()}}():d();var v=Math.random().toString(36).substring(16);function w(){}const b=void 0,x=1,E=2,_=new M;function T(e){try{return e.then}catch(e){return _.error=e,_}}function C(t,i,n){i.constructor===t.constructor&&n===g&&i.constructor.resolve===y?function(e,t){t._state===x?k(e,t._result):t._state===E?P(e,t._result):O(t,void 0,t=>A(e,t),t=>P(e,t))}(t,i):n===_?(P(t,_.error),_.error=null):void 0===n?k(t,i):e(n)?function(e,t,i){s(e=>{let n=!1;const o=function(e,t,i,n){try{e.call(t,i,n)}catch(e){return e}}(i,t,i=>{n||(n=!0,t!==i?A(e,i):k(e,i))},t=>{n||(n=!0,P(e,t))},e._label);!n&&o&&(n=!0,P(e,o))},e)}(t,i,n):k(t,i)}function A(e,t){e===t?P(e,new TypeError("You cannot resolve a promise with itself")):!function(e){const t=typeof e;return null!==e&&("object"===t||"function"===t)}(t)?k(e,t):C(e,t,T(t))}function S(e){e._onerror&&e._onerror(e._result),R(e)}function k(e,t){e._state===b&&(e._result=t,e._state=x,0!==e._subscribers.length&&s(R,e))}function P(e,t){e._state===b&&(e._state=E,e._result=t,s(S,e))}function O(e,t,i,n){const o=e._subscribers,r=o.length;e._onerror=null,o[r]=t,o[r+x]=i,o[r+E]=n,0===r&&e._state&&s(R,e)}function R(e){const t=e._subscribers,i=e._state;if(0===t.length)return;let n=void 0,o=void 0,r=e._result;for(let e=0;e<t.length;e+=3)n=t[e],o=t[e+i],n?I(i,n,o,r):o(r);e._subscribers.length=0}function M(){this.error=null}const B=new M;function I(t,i,n,o){let r=e(n),s=void 0,a=void 0,h=void 0,l=void 0;if(r){if((s=function(e,t){try{return e(t)}catch(e){return B.error=e,B}}(n,o))===B?(l=!0,a=s.error,s.error=null):h=!0,i===s)return void P(i,new TypeError("A promises callback cannot return that same promise."))}else s=o,h=!0;i._state!==b||(r&&h?A(i,s):l?P(i,a):t===x?k(i,s):t===E&&P(i,s))}let L=0;function D(e){e[v]=L++,e._state=void 0,e._result=void 0,e._subscribers=[]}const N=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(w),this.promise[v]||D(this.promise),i(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&k(this.promise,this._result))):P(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(let t=0;this._state===b&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){const i=this._instanceConstructor,n=i.resolve;if(n===y){const n=T(e);if(n===g&&e._state!==b)this._settledAt(e._state,t,e._result);else if("function"!=typeof n)this._remaining--,this._result[t]=e;else if(i===F){const o=new i(w);C(o,e,n),this._willSettleAt(o,t)}else this._willSettleAt(new i(t=>t(e)),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,i){const n=this.promise;n._state===b&&(this._remaining--,e===E?P(n,i):this._result[t]=i),0===this._remaining&&k(n,this._result)},e.prototype._willSettleAt=function(e,t){const i=this;O(e,void 0,e=>i._settledAt(x,t,e),e=>i._settledAt(E,t,e))},e}();var F=function(){function e(t){this[v]=L++,this._result=this._state=void 0,this._subscribers=[],w!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(t=>{A(e,t)},t=>{P(e,t)})}catch(t){P(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){const t=this.constructor;return this.then(i=>t.resolve(e()).then(()=>i),i=>t.resolve(e()).then(()=>{throw i}))},e}();return F.prototype.then=g,F.all=function(e){return new N(this,e).promise},F.race=function(e){const t=this;return i(e)?new t((i,n)=>{const o=e.length;for(let r=0;r<o;r++)t.resolve(e[r]).then(i,n)}):new t((e,t)=>t(new TypeError("You must pass an array to race.")))},F.resolve=y,F.reject=function(e){const t=new this(w);return P(t,e),t},F._setScheduler=function(e){r=e},F._setAsap=function(e){s=e},F._asap=s,F.polyfill=function(){let e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}const t=e.Promise;if(t){let e=null;try{e=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===e&&!t.cast)return}e.Promise=F},F.Promise=F,F.polyfill(),F}),function(){const e=function(e){return e.substring(0,1).toUpperCase()+e.substring(1,e.length)};me.agent=function(){const t={},i=["ms","MS","moz","webkit","o"];return t.prefixed=function(t,n){if(t in(n=n||window))return n[t];const o=e(t);let r;return i.some(e=>{const t=e+o;return r=t in n?n[t]:void 0}),r},t.setPrefixed=function(t,n,o){if(t in(o=o||window))return void(o[t]=n);const r=e(t);i.some(e=>{const t=e+r;return t in o&&(o[t]=n,!0)})},t}()}(),me.device=function(){const e={};let t=!1,i=!1,n=null,o=!0;const r=function(e){return e.preventDefault(),window.scroll(0,0),!1};let s=!1,a=!1,h=[];function l(t){t.reading?(e.accelerationX=t.reading.accelerationX,e.accelerationY=t.reading.accelerationY,e.accelerationZ=t.reading.accelerationZ):(e.accelerationX=t.accelerationIncludingGravity.x,e.accelerationY=t.accelerationIncludingGravity.y,e.accelerationZ=t.accelerationIncludingGravity.z)}function c(t){e.gamma=t.gamma,e.beta=t.beta,e.alpha=t.alpha}return e._domReady=function(e){if(!a){if(!document.body)return setTimeout(me.device._domReady,13);for(document.removeEventListener&&document.removeEventListener("DOMContentLoaded",me.device._domReady,!1),window.removeEventListener("load",me.device._domReady,!1);h.length;)h.shift().call(window,[]);a=!0}},e._check=function(){if(me.device._detectDevice(),me.device.isMobile&&!me.device.cocoon&&e.enableSwipe(!1),me.device.TouchEvent=!!("ontouchstart"in window),me.device.PointerEvent=!!window.PointerEvent,window.gesture=me.agent.prefixed("gesture"),me.device.touch=me.device.cocoon||me.device.TouchEvent||me.device.PointerEvent,me.device.maxTouchPoints=me.device.touch?me.device.PointerEvent?navigator.maxTouchPoints||1:10:1,me.device.wheel="onwheel"in document.createElement("div"),me.device.hasAccelerometer=void 0!==window.DeviceMotionEvent||void 0!==window.Windows&&"function"==typeof Windows.Devices.Sensors.Accelerometer,this.hasPointerLockSupport=me.agent.prefixed("pointerLockElement",document),this.hasPointerLockSupport&&(document.exitPointerLock=me.agent.prefixed("exitPointerLock",document)),window.DeviceOrientationEvent&&(me.device.hasDeviceOrientation=!0),void 0!==window.screen){const e=window.screen;e.orientation=me.agent.prefixed("orientation",e),e.lockOrientation=me.agent.prefixed("lockOrientation",e),e.unlockOrientation=me.agent.prefixed("unlockOrientation",e)}this.hasFullscreenSupport=me.agent.prefixed("fullscreenEnabled",document)||document.mozFullScreenEnabled,document.exitFullscreen=me.agent.prefixed("cancelFullScreen",document)||me.agent.prefixed("exitFullscreen",document),navigator.vibrate=me.agent.prefixed("vibrate",navigator);try{e.localStorage=!!window.localStorage}catch(t){e.localStorage=!1}let t,i;window.addEventListener("blur",()=>{me.sys.stopOnBlur&&me.state.stop(!0),me.sys.pauseOnBlur&&me.state.pause(!0)},!1),window.addEventListener("focus",()=>{me.sys.stopOnBlur&&me.state.restart(!0),me.sys.resumeOnFocus&&me.state.resume(!0)},!1),void 0!==document.hidden?(t="hidden",i="visibilitychange"):void 0!==document.mozHidden?(t="mozHidden",i="mozvisibilitychange"):void 0!==document.msHidden?(t="msHidden",i="msvisibilitychange"):void 0!==document.webkitHidden&&(t="webkitHidden",i="webkitvisibilitychange"),"string"==typeof i&&document.addEventListener(i,()=>{document[t]?(me.sys.stopOnBlur&&me.state.stop(!0),me.sys.pauseOnBlur&&me.state.pause(!0)):(me.sys.stopOnBlur&&me.state.restart(!0),me.sys.resumeOnFocus&&me.state.resume(!0))},!1)},e._detectDevice=function(){me.device.iOS=/iPhone|iPad|iPod/i.test(me.device.ua),me.device.android=/Android/i.test(me.device.ua),me.device.android2=/Android 2/i.test(me.device.ua),me.device.chromeOS=/CrOS/.test(me.device.ua),me.device.wp=/Windows Phone/i.test(me.device.ua),me.device.BlackBerry=/BlackBerry/i.test(me.device.ua),me.device.Kindle=/Kindle|Silk.*Mobile Safari/i.test(me.device.ua),me.device.isMobile=/Mobi/i.test(me.device.ua)||me.device.iOS||me.device.android||me.device.wp||me.device.BlackBerry||me.device.Kindle||!1,me.device.ejecta=void 0!==window.ejecta,me.device.cocoon=navigator.isCocoonJS||void 0!==window.Cocoon},e.ua=navigator.userAgent,e.localStorage=!1,e.hasAccelerometer=!1,e.hasDeviceOrientation=!1,e.hasFullscreenSupport=!1,e.hasPointerLockSupport=!1,e.nativeBase64="function"==typeof window.atob,e.maxTouchPoints=1,e.touch=!1,e.wheel=!1,e.isMobile=!1,e.iOS=!1,e.android=!1,e.android2=!1,e.ejecta=!1,e.cocoon=!1,e.chromeOS=!1,e.wp=!1,e.BlackBerry=!1,e.Kindle=!1,e.accelerationX=0,e.accelerationY=0,e.accelerationZ=0,e.gamma=0,e.beta=0,e.alpha=0,e.language=navigator.language||navigator.browserLanguage||navigator.userLanguage||"en",e.onReady=function(e){a?e.call(window,[]):(h.push(e),s||("complete"===document.readyState?window.setTimeout(me.device._domReady,0):(document.addEventListener&&document.addEventListener("DOMContentLoaded",me.device._domReady,!1),window.addEventListener("load",me.device._domReady,!1)),s=!0))},e.enableSwipe=function(e){!1!==e?!1===o&&(window.document.removeEventListener("touchmove",r,!1),o=!0):!0===o&&(window.document.addEventListener("touchmove",r,!1),o=!1)},e.requestFullscreen=function(e){this.hasFullscreenSupport&&((e=e||me.video.getWrapper()).requestFullscreen=me.agent.prefixed("requestFullscreen",e)||e.mozRequestFullScreen,e.requestFullscreen())},e.exitFullscreen=function(){this.hasFullscreenSupport&&document.exitFullscreen()},e.getPixelRatio=function(){if(null===n){let e;e=void 0!==me.video.renderer?me.video.renderer.getScreenContext():me.Renderer.prototype.getContext2d(document.createElement("canvas"));let t=window.devicePixelRatio||1,i=me.agent.prefixed("backingStorePixelRatio",e)||1;n=t/i}return n},e.getScreenOrientation=function(){const e=window.screen;if(void 0!==e){const t=e.orientation;if(void 0!==t&&(t.type,1))return t.type;if("string"==typeof t)return t}return"number"==typeof window.orientation?90===Math.abs(window.orientation)?"landscape":"portrait":window.outerWidth>window.outerHeight?"landscape":"portrait"},e.lockOrientation=function(e){return void 0!==window.screen&&void 0!==screen.lockOrientation&&screen.lockOrientation(e)},e.unlockOrientation=function(e){return void 0!==window.screen&&void 0!==screen.unlockOrientation&&screen.unlockOrientation(e)},e.isPortrait=function(){return me.device.getScreenOrientation().includes("portrait")},e.isLandscape=function(){return me.device.getScreenOrientation().includes("landscape")},e.getStorage=function(e){switch(e=e||"local"){case"local":return me.save;default:throw new me.Error(`storage type ${e} not supported`)}},e.turnOnPointerLock=function(){if(this.hasPointerLockSupport){const t=me.video.getWrapper();if(me.device.ua.match(/Firefox/i)){var e=function(){(me.agent.prefixed("fullscreenElement",document)||document.mozFullScreenElement)===t&&(document.removeEventListener("fullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),t.requestPointerLock=me.agent.prefixed("requestPointerLock",t),t.requestPointerLock())};document.addEventListener("fullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1),me.device.requestFullscreen()}else t.requestPointerLock()}},e.turnOffPointerLock=function(){this.hasPointerLockSupport&&document.exitPointerLock()},e.watchAccelerometer=function(){if(me.device.hasAccelerometer){if(!t){if("undefined"==typeof Windows)window.addEventListener("devicemotion",l,!1);else{const e=Windows.Devices.Sensors.Accelerometer.getDefault();if(e){const t=e.minimumReportInterval,i=t>=16?t:25;e.reportInterval=i,e.addEventListener("readingchanged",l,!1)}}t=!0}return!0}return!1},e.unwatchAccelerometer=function(){t&&("undefined"==typeof Windows?window.removeEventListener("devicemotion",l,!1):Windows.Device.Sensors.Accelerometer.getDefault().removeEventListener("readingchanged",l,!1),t=!1)},e.watchDeviceOrientation=function(){return me.device.hasDeviceOrientation&&!i&&(window.addEventListener("deviceorientation",c,!1),i=!0),!1},e.unwatchDeviceOrientation=function(){i&&(window.removeEventListener("deviceorientation",c,!1),i=!1)},e.vibrate=function(e){navigator.vibrate&&navigator.vibrate(e)},e}(),Object.defineProperty(me.device,"isFullscreen",{get:()=>!(!me.device.hasFullscreenSupport||!me.agent.prefixed("fullscreenElement",document)&&!document.mozFullScreenElement)}),Object.defineProperty(me.device,"sound",{get:()=>!Howler.noAudio}),me.game=function(){const e={};let t=!1,i=!0,n=!1,o=0,r=1,s=0,a=0,h=0,l=1e3/60,c=0,u=null,d=0,p=null;return e.viewport=null,e.world=null,e.mergeGroup=!0,e.sortOn="z",e.onLevelLoaded=function(){},e.HASH=null,e.init=function(n,o){t||(n=n||me.video.renderer.getWidth(),o=o||me.video.renderer.getHeight(),e.viewport=new me.Viewport(0,0,n,o),e.world=new me.Container(0,0,n,o),e.world.name="rootContainer",e.world._root=!0,e.world.anchorPoint.set(0,0),me.collision.init(),p=me.video.renderer,me.event.publish(me.event.GAME_INIT),me.input._translatePointerEvents(),i=!0,t=!0)},e.reset=function(){me.collision.quadTree.clear(),e.world.destroy(),e.world.anchorPoint.set(0,0),e.viewport&&e.viewport.reset(),p.reset(),me.event.publish(me.event.GAME_RESET),e.updateFrameRate()},e.updateFrameRate=function(){o=0,r=~~(.5+60/me.sys.fps),l=1e3/me.sys.updatesPerSecond,s=0,a=10*l,n=me.sys.fps>me.sys.updatesPerSecond},e.getParentContainer=function(e){return e.ancestor},e.repaint=function(){i=!0},e.update=function(t){if(++o%r==0)for(o=0,me.timer.update(t),me.input._updateGamepads(),s+=me.timer.getDelta(),s=Math.min(s,a),c=me.sys.interpolation?me.timer.getDelta():l,h=me.sys.interpolation?c:Math.max(c,d);s>=h||me.sys.interpolation;)if(u=window.performance.now(),me.collision.quadTree.clear(),me.collision.quadTree.insertContainer(e.world),i=e.world.update(c)||i,i=e.viewport.update(c)||i,me.timer.lastUpdate=window.performance.now(),d=me.timer.lastUpdate-u,s-=h,me.sys.interpolation){s=0;break}},e.draw=function(t){if(i||n){const i=(t=t||e.viewport).pos.x+t.offset.x,n=t.pos.y+t.offset.y;e.world.currentTransform.translate(-i,-n),p.clear(),t.preDraw(p),e.world.preDraw(p),e.world.draw(p,t),t.draw(p),e.world.postDraw(p),t.postDraw(p),e.world.currentTransform.translate(i,n)}i=!1,p.flush()},e}(),function(){me.mod="melonJS",me.version="5.1.0",me.sys={fps:60,updatesPerSecond:60,interpolation:!1,scale:null,gravity:void 0,stopOnAudioError:!0,pauseOnBlur:!0,resumeOnFocus:!0,stopOnBlur:!1,preRender:!1,checkVersion(e,t){t=t||me.version;const i=e.split("."),n=t.split("."),o=Math.min(i.length,n.length);let r=0;for(let e=0;e<o&&!(r=+i[e]-+n[e]);e++);return r||i.length-n.length}};let e=!1;Object.defineProperty(me,"initialized",{get:function(){return e}}),me.skipAutoInit=!1,me.boot=function(){e||(me.device._check(),me.save._init(),me.game.HASH=function(){const e={};return document.location.hash&&document.location.hash.substr(1).split("&").filter(e=>""!==e).forEach(t=>{const i=t.split("="),n=i.shift(),o=i.join("=");e[n]=o||!0}),e}(),me.loader.setNocache(me.game.HASH.nocache||!1),me.timer.init(),me.state.init(),me.pool.init(),!1===me.device.isMobile&&me.input._enableKeyboardEvent(),me.levelDirector.reset(),e=!0)},!1===me.skipAutoInit?me.device.onReady(()=>{me.boot()}):me.init=function(){me.boot(),me.device._domReady()}}(),me.timer=function(){const e={};let t=0,i=0,n=0,o=0,r=0;const s=Math.ceil(1e3/me.sys.fps),a=1e3/me.sys.fps*1.25,h=[];let l=0;const c=function(e){for(let t=0,i=h.length;t<i;t++)if(h[t].timerId===e){h.splice(t,1);break}};return e.tick=1,e.fps=0,e.lastUpdate=window.performance.now(),e.init=function(){e.reset(),o=n=0},e.reset=function(){n=o=window.performance.now(),r=0,i=0,t=0},e.setTimeout=function(e,t,i){return h.push({fn:e,delay:t,elapsed:0,repeat:!1,timerId:++l,pauseable:!0===i||!0}),l},e.setInterval=function(e,t,i){return h.push({fn:e,delay:t,elapsed:0,repeat:!0,timerId:++l,pauseable:!0===i||!0}),l},e.clearTimeout=function(e){c.defer(this,e)},e.clearInterval=function(e){c.defer(this,e)},e.getTime=function(){return o},e.getDelta=function(){return r},e.countFPS=function(){i+=r,++t%10==0&&(this.fps=(~~(1e3*t/i)).clamp(0,me.sys.fps),i=0,t=0)},e.update=function(t){return n=o,r=(o=t)-n,e.tick=r>a&&me.sys.interpolation?r/s:1,function(e){for(let t=0,i=h.length;t<i;t++){const i=h[t];i.pauseable&&me.state.isPaused()||(i.elapsed+=e),i.elapsed>=i.delay&&(i.fn.apply(this),!0===i.repeat?i.elapsed-=i.delay:me.timer.clearTimeout(i.timerId))}}(r),r},e}(),me.pool=function(){const e={},t={};return e.init=function(){e.register("me.Entity",me.Entity),e.register("me.CollectableEntity",me.CollectableEntity),e.register("me.LevelEntity",me.LevelEntity),e.register("me.Tween",me.Tween,!0),e.register("me.Color",me.Color,!0),e.register("me.Particle",me.Particle,!0),e.register("me.Sprite",me.Sprite),e.register("me.Vector2d",me.Vector2d,!0),e.register("me.Glyph",me.Glyph,!0),e.register("me.Matrix2d",me.Matrix2d,!0)},e.register=function(e,i,n){if(void 0===i)throw new me.Error(`Cannot register object '${e}', invalid class`);t[e]={class:i,pool:n?[]:void 0}},e.pull=function(e){const i=new Array(arguments.length);for(let e=0;e<arguments.length;e++)i[e]=arguments[e];const n=t[e];if(n){let t,o=n.class,r=n.pool;return r&&(t=r.pop())?(i.shift(),"function"==typeof t.onResetEvent?t.onResetEvent(...i):t.init(...i)):(i[0]=o,t=new(o.bind(...i)),r&&(t.className=e)),t}throw new me.Error(`Cannot instantiate entity of type '${e}'`)},e.purge=function(){for(const e in t)t[e]&&(t[e].pool=[])},e.push=function(e){const i=e.className;void 0!==i&&t[i]&&t[i].pool.push(e)},e.exists=function(e){return e in t},e}(),me.Vector2d=me.Object.extend({init(e,t){return this.set(e||0,t||0)},_set(e,t){return this.x=e,this.y=t,this},set(e,t){if(e!==+e||t!==+t)throw new me.Vector2d.Error("invalid x,y parameters (not a number)");return this._set(e,t)},setZero(){return this.set(0,0)},setV(e){return this._set(e.x,e.y)},add(e){return this._set(this.x+e.x,this.y+e.y)},sub(e){return this._set(this.x-e.x,this.y-e.y)},scale(e,t){return this._set(this.x*e,this.y*(void 0!==t?t:e))},toIso(){return this._set(this.x-this.y,.5*(this.x+this.y))},to2d(){return this._set(this.y+this.x/2,this.y-this.x/2)},scaleV(e){return this._set(this.x*e.x,this.y*e.y)},div(e){return this._set(this.x/e,this.y/e)},abs(){return this._set(this.x<0?-this.x:this.x,this.y<0?-this.y:this.y)},clamp(e,t){return new me.Vector2d(this.x.clamp(e,t),this.y.clamp(e,t))},clampSelf(e,t){return this._set(this.x.clamp(e,t),this.y.clamp(e,t))},minV(e){return this._set(this.x<e.x?this.x:e.x,this.y<e.y?this.y:e.y)},maxV(e){return this._set(this.x>e.x?this.x:e.x,this.y>e.y?this.y:e.y)},floor(){return new me.Vector2d(Math.floor(this.x),Math.floor(this.y))},floorSelf(){return this._set(Math.floor(this.x),Math.floor(this.y))},ceil(){return new me.Vector2d(Math.ceil(this.x),Math.ceil(this.y))},ceilSelf(){return this._set(Math.ceil(this.x),Math.ceil(this.y))},negate(){return new me.Vector2d(-this.x,-this.y)},negateSelf(){return this._set(-this.x,-this.y)},copy(e){return this._set(e.x,e.y)},equals(e){return this.x===e.x&&this.y===e.y},normalize(){const e=this.length();return e>0?this._set(this.x/e,this.y/e):this},perp(){return this._set(this.y,-this.x)},rotate(e){const t=this.x,i=this.y;return this._set(t*Math.cos(e)-i*Math.sin(e),t*Math.sin(e)+i*Math.cos(e))},dotProduct(e){return this.x*e.x+this.y*e.y},length2(){return this.dotProduct(this)},length(){return Math.sqrt(this.length2())},distance(e){let t=this.x-e.x,i=this.y-e.y;return Math.sqrt(t*t+i*i)},angle(e){return Math.acos((this.dotProduct(e)/(this.length()*e.length())).clamp(-1,1))},project(e){return this.scale(this.dotProduct(e)/e.length2())},projectN(e){return this.scale(this.dotProduct(e))},clone(){return new me.Vector2d(this.x,this.y)},toString(){return`x:${this.x},y:${this.y}`}}),me.Vector2d.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.Vector2d.Error"}}),me.Vector3d=me.Object.extend({init(e,t,i){return this.set(e||0,t||0,i||0)},_set(e,t,i){return this.x=e,this.y=t,this.z=i,this},set(e,t,i){if(e!==+e||t!==+t||i!==+i)throw new me.Vector3d.Error("invalid x, y, z parameters (not a number)");return this._set(e,t,i)},setZero(){return this.set(0,0,0)},setV(e){return this._set(e.x,e.y,void 0!==e.z?e.z:this.z)},add(e){return this._set(this.x+e.x,this.y+e.y,this.z+(e.z||0))},sub(e){return this._set(this.x-e.x,this.y-e.y,this.z-(e.z||0))},scale(e,t,i){return t=void 0!==t?t:e,i=void 0!==i?i:e,this._set(this.x*e,this.y*t,this.z*i)},scaleV(e){return this._set(this.x*e.x,this.y*e.y,this.z*(e.z||1))},toIso(){return this._set(this.x-this.y,.5*(this.x+this.y),this.z)},to2d(){return this._set(this.y+this.x/2,this.y-this.x/2,this.z)},div(e){return this._set(this.x/e,this.y/e,this.z/e)},abs(){return this._set(this.x<0?-this.x:this.x,this.y<0?-this.y:this.y,this.z<0?-this.z:this.z)},clamp(e,t){return new me.Vector3d(this.x.clamp(e,t),this.y.clamp(e,t),this.z.clamp(e,t))},clampSelf(e,t){return this._set(this.x.clamp(e,t),this.y.clamp(e,t),this.z.clamp(e,t))},minV(e){const t=e.z||0;return this._set(this.x<e.x?this.x:e.x,this.y<e.y?this.y:e.y,this.z<t?this.z:t)},maxV(e){const t=e.z||0;return this._set(this.x>e.x?this.x:e.x,this.y>e.y?this.y:e.y,this.z>t?this.z:t)},floor(){return new me.Vector3d(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))},floorSelf(){return this._set(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))},ceil(){return new me.Vector3d(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))},ceilSelf(){return this._set(Math.ceil(this.x),Math.ceil(this.y),Math.ceil(this.z))},negate(){return new me.Vector3d(-this.x,-this.y,-this.z)},negateSelf(){return this._set(-this.x,-this.y,-this.z)},copy(e){return this._set(e.x,e.y,void 0!==e.z?e.z:this.z)},equals(e){return this.x===e.x&&this.y===e.y&&this.z===(e.z||this.z)},normalize(){const e=this.length();return e>0?this._set(this.x/e,this.y/e,this.z/e):this},perp(){return this._set(this.y,-this.x,this.z)},rotate(e){const t=this.x,i=this.y;return this._set(t*Math.cos(e)-i*Math.sin(e),t*Math.sin(e)+i*Math.cos(e),this.z)},dotProduct(e){return this.x*e.x+this.y*e.y+this.z*(e.z||1)},length2(){return this.dotProduct(this)},length(){return Math.sqrt(this.length2())},distance(e){let t=this.x-e.x,i=this.y-e.y,n=this.z-(e.z||0);return Math.sqrt(t*t+i*i+n*n)},angle(e){return Math.acos((this.dotProduct(e)/(this.length()*e.length())).clamp(-1,1))},project(e){return this.scale(this.dotProduct(e)/e.length2())},projectN(e){return this.scale(this.dotProduct(e))},clone(){return new me.Vector3d(this.x,this.y,this.z)},toString(){return`x:${this.x},y:${this.y},z:${this.z}`}}),me.Vector3d.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.Vector3d.Error"}}),me.ObservableVector2d=me.Vector2d.extend({init(e,t,i){if(Object.defineProperty(this,"x",{get(){return this._x},set(e){const t=this.onUpdate(e,this._y,this._x,this._y);this._x=t&&"x"in t?t.x:e}}),Object.defineProperty(this,"y",{get(){return this._y},set(e){const t=this.onUpdate(this._x,e,this._x,this._y);this._y=t&&"y"in t?t.y:e}}),void 0===i)throw new me.ObservableVector2d.Error("undefined `onUpdate` callback");this.setCallback(i.onUpdate),this._x=e||0,this._y=t||0},_set(e,t){const i=this.onUpdate(e,t,this._x,this._y);return i&&"x"in i&&"y"in i?(this._x=i.x,this._y=i.y):(this._x=e,this._y=t),this},setMuted(e,t){return this._x=e,this._y=t,this},setCallback(e){if("function"!=typeof e)throw new me.ObservableVector2d.Error("invalid `onUpdate` callback");return this.onUpdate=e,this},add(e){return this._set(this._x+e.x,this._y+e.y)},sub(e){return this._set(this._x-e.x,this._y-e.y)},scale(e,t){return this._set(this._x*e,this._y*(void 0!==t?t:e))},scaleV(e){return this._set(this._x*e.x,this._y*e.y)},div(e){return this._set(this._x/e,this._y/e)},abs(){return this._set(this._x<0?-this._x:this._x,this._y<0?-this._y:this._y)},clamp(e,t){return new me.ObservableVector2d(this.x.clamp(e,t),this.y.clamp(e,t),{onUpdate:this.onUpdate})},clampSelf(e,t){return this._set(this._x.clamp(e,t),this._y.clamp(e,t))},minV(e){return this._set(this._x<e.x?this._x:e.x,this._y<e.y?this._y:e.y)},maxV(e){return this._set(this._x>e.x?this._x:e.x,this._y>e.y?this._y:e.y)},floor(){return new me.ObservableVector2d(Math.floor(this._x),Math.floor(this._y),{onUpdate:this.onUpdate})},floorSelf(){return this._set(Math.floor(this._x),Math.floor(this._y))},ceil(){return new me.ObservableVector2d(Math.ceil(this._x),Math.ceil(this._y),{onUpdate:this.onUpdate})},ceilSelf(){return this._set(Math.ceil(this._x),Math.ceil(this._y))},negate(){return new me.ObservableVector2d(-this._x,-this._y,{onUpdate:this.onUpdate})},negateSelf(){return this._set(-this._x,-this._y)},copy(e){return this._set(e.x,e.y)},equals(e){return this._x===e.x&&this._y===e.y},normalize(){const e=this.length();return e>0?this._set(this._x/e,this._y/e):this},perp(){return this._set(this._y,-this._x)},rotate(e){const t=this._x,i=this._y;return this._set(t*Math.cos(e)-i*Math.sin(e),t*Math.sin(e)+i*Math.cos(e))},dotProduct(e){return this._x*e.x+this._y*e.y},distance(e){return Math.sqrt((this._x-e.x)*(this._x-e.x)+(this._y-e.y)*(this._y-e.y))},clone(){return new me.ObservableVector2d(this._x,this._y,{onUpdate:this.onUpdate})},toVector2d(){return new me.Vector2d(this._x,this._y)},toString(){return`x:${this._x},y:${this._y}`}}),me.ObservableVector2d.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.ObservableVector2d.Error"}}),me.ObservableVector3d=me.Vector3d.extend({init(e,t,i,n){if(Object.defineProperty(this,"x",{get(){return this._x},set(e){const t=this.onUpdate(e,this._y,this._z,this._x,this._y,this._z);this._x=t&&"x"in t?t.x:e}}),Object.defineProperty(this,"y",{get(){return this._y},set(e){const t=this.onUpdate(this._x,e,this._z,this._x,this._y,this._z);this._y=t&&"y"in t?t.y:e}}),Object.defineProperty(this,"z",{get(){return this._z},set(e){const t=this.onUpdate(this._x,this._y,e,this._x,this._y,this._z);this._z=t&&"z"in t?t.z:e}}),void 0===n)throw new me.ObservableVector3d.Error("undefined `onUpdate` callback");this.setCallback(n.onUpdate),this._x=e||0,this._y=t||0,this._z=i||0},_set(e,t,i){const n=this.onUpdate(e,t,i,this._x,this._y,this._z);return n&&"x"in n&&"y"in n&&"z"in n?(this._x=n.x,this._y=n.y,this._z=n.z):(this._x=e,this._y=t,this._z=i),this},setMuted(e,t,i){return this._x=e,this._y=t,this._z=i,this},setCallback(e){if("function"!=typeof e)throw new me.ObservableVector3d.Error("invalid `onUpdate` callback");return this.onUpdate=e,this},add(e){return this._set(this._x+e.x,this._y+e.y,this._z+(e.z||0))},sub(e){return this._set(this._x-e.x,this._y-e.y,this._z-(e.z||0))},scale(e,t,i){return t=void 0!==t?t:e,i=void 0!==i?i:e,this._set(this._x*e,this._y*t,this._z*i)},scaleV(e){return this._set(this._x*e.x,this._y*e.y,this._z*(e.z||1))},div(e){return this._set(this._x/e,this._y/e,this._z/e)},abs(){return this._set(this._x<0?-this._x:this._x,this._y<0?-this._y:this._y,this._Z<0?-this._z:this._z)},clamp(e,t){return new me.ObservableVector3d(this._x.clamp(e,t),this._y.clamp(e,t),this._z.clamp(e,t),{onUpdate:this.onUpdate})},clampSelf(e,t){return this._set(this._x.clamp(e,t),this._y.clamp(e,t),this._z.clamp(e,t))},minV(e){const t=e.z||0;return this._set(this._x<e.x?this._x:e.x,this._y<e.y?this._y:e.y,this._z<t?this._z:t)},maxV(e){const t=e.z||0;return this._set(this._x>e.x?this._x:e.x,this._y>e.y?this._y:e.y,this._z>t?this._z:t)},floor(){return new me.ObservableVector3d(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z),{onUpdate:this.onUpdate})},floorSelf(){return this._set(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z))},ceil(){return new me.ObservableVector3d(Math.ceil(this._x),Math.ceil(this._y),Math.ceil(this._z),{onUpdate:this.onUpdate})},ceilSelf(){return this._set(Math.ceil(this._x),Math.ceil(this._y),Math.ceil(this._z))},negate(){return new me.ObservableVector3d(-this._x,-this._y,-this._z,{onUpdate:this.onUpdate})},negateSelf(){return this._set(-this._x,-this._y,-this._z)},copy(e){return this._set(e.x,e.y,void 0!==e.z?e.z:this._z)},equals(e){return this._x===e.x&&this._y===e.y&&this._z===(e.z||this._z)},normalize(){const e=this.length();return e>0?this._set(this._x/e,this._y/e,this._z/e):this},perp(){return this._set(this._y,-this._x,this._z)},rotate(e){const t=this._x,i=this._y;return this._set(t*Math.cos(e)-i*Math.sin(e),t*Math.sin(e)+i*Math.cos(e),this._z)},dotProduct(e){return this._x*e.x+this._y*e.y+this._z*(e.z||1)},distance(e){let t=this._x-e.x,i=this._y-e.y,n=this._z-(e.z||0);return Math.sqrt(t*t+i*i+n*n)},clone(){return new me.ObservableVector3d(this._x,this._y,this._z,{onUpdate:this.onUpdate})},toVector3d(){return new me.Vector3d(this._x,this._y,this._z)},toString(){return`x:${this._x},y:${this._y},z:${this._z}`}}),me.ObservableVector3d.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.ObservableVector3d.Error"}}),me.Matrix2d=me.Object.extend({init(){void 0===this.val&&(this.val=new Float32Array(9)),arguments.length&&arguments[0]instanceof me.Matrix2d?this.copy(arguments[0]):arguments.length>=6?this.setTransform.apply(this,arguments):this.identity()},identity(){return this.setTransform(1,0,0,0,1,0,0,0,1),this},setTransform(){const e=this.val;return 9===arguments.length?(e[0]=arguments[0],e[1]=arguments[1],e[2]=arguments[2],e[3]=arguments[3],e[4]=arguments[4],e[5]=arguments[5],e[6]=arguments[6],e[7]=arguments[7],e[8]=arguments[8]):6===arguments.length&&(e[0]=arguments[0],e[1]=arguments[2],e[2]=arguments[4],e[3]=arguments[1],e[4]=arguments[3],e[5]=arguments[5],e[6]=0,e[7]=0,e[8]=1),this},copy(e){return this.val.set(e.val),this},multiply(e){e=e.val;let t=this.val,i=t[0],n=t[1],o=t[3],r=t[4],s=e[0],a=e[1],h=e[3],l=e[4],c=e[6],u=e[7];return t[0]=i*s+o*a,t[1]=n*s+r*a,t[3]=i*h+o*l,t[4]=n*h+r*l,t[6]+=i*c+o*u,t[7]+=n*c+r*u,this},transpose(){let e,t=this.val;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},invert(){const e=this.val;let t=e[0],i=e[1],n=e[2],o=e[3],r=e[4],s=e[5],a=e[6],h=e[7],l=e[8],c=l*r-s*h,u=s*a-l*o,d=h*o-r*a;const p=t*c+i*u+n*d;return e[0]=c/p,e[1]=(n*h-l*i)/p,e[2]=(s*i-n*r)/p,e[3]=u/p,e[4]=(l*t-n*a)/p,e[5]=(n*o-s*t)/p,e[6]=d/p,e[7]=(i*a-h*t)/p,e[8]=(r*t-i*o)/p,this},multiplyVector(e){let t=this.val,i=e.x,n=e.y;return e.x=i*t[0]+n*t[3]+t[6],e.y=i*t[1]+n*t[4]+t[7],e},multiplyVectorInverse(e){let t=this.val,i=e.x,n=e.y;const o=1/(t[0]*t[4]+t[3]*-t[1]);return e.x=t[4]*o*i+-t[3]*o*n+(t[7]*t[3]-t[6]*t[4])*o,e.y=t[0]*o*n+-t[1]*o*i+(-t[7]*t[0]+t[6]*t[1])*o,e},scale(e,t){let i=this.val,n=e,o=void 0===t?n:t;return i[0]*=n,i[1]*=n,i[3]*=o,i[4]*=o,this},scaleV(e){return this.scale(e.x,e.y)},scaleX(e){return this.scale(e,1)},scaleY(e){return this.scale(1,e)},rotate(e){if(0!==e){let t=this.val,i=t[0],n=t[1],o=t[3],r=t[4],s=Math.sin(e),a=Math.cos(e);t[0]=i*a+o*s,t[1]=n*a+r*s,t[3]=i*-s+o*a,t[4]=n*-s+r*a}return this},translate(e,t){const i=this.val;return i[6]+=i[0]*e+i[3]*t,i[7]+=i[1]*e+i[4]*t,this},translateV(e){return this.translate(e.x,e.y)},isIdentity(){const e=this.val;return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&1===e[4]&&0===e[5]&&0===e[6]&&0===e[7]&&1===e[8]},clone(){return me.pool.pull("me.Matrix2d",this)},toString(){const e=this.val;return`me.Matrix2d(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]}, ${e[4]}, ${e[5]}, ${e[6]}, ${e[7]}, ${e[8]})`}}),me.Ellipse=me.Object.extend({init(e,t,i,n){this.pos=new me.Vector2d,this._bounds=void 0,this.radius=NaN,this.radiusV=new me.Vector2d,this.radiusSq=new me.Vector2d,this.ratio=new me.Vector2d,this.shapeType="Ellipse",this.setShape(e,t,i,n)},setShape(e,t,i,n){const o=i/2,r=n/2;this.pos.set(e,t),this.radius=Math.max(o,r),this.ratio.set(o/this.radius,r/this.radius),this.radiusV.set(this.radius,this.radius).scaleV(this.ratio);const s=this.radius*this.radius;return this.radiusSq.set(s,s).scaleV(this.ratio),this.updateBounds(),this},rotate(){return this},scale(e,t){return t=void 0!==t?t:e,this.setShape(this.pos.x,this.pos.y,2*this.radiusV.x*e,2*this.radiusV.y*t)},scaleV(e){return this.scale(e.x,e.y)},transform(){return this},translate(e,t){return this.pos.x+=e,this.pos.y+=t,this._bounds.translate(e,t),this},translateV(e){return this.pos.add(e),this._bounds.translateV(e),this},containsPointV(e){return this.containsPoint(e.x,e.y)},containsPoint(e,t){return e-=this.pos.x,t-=this.pos.y,e*e/this.radiusSq.x+t*t/this.radiusSq.y<=1},getBounds(){return this._bounds},updateBounds(){let e=this.radiusV.x,t=this.radiusV.y,i=this.pos.x-e,n=this.pos.y-t,o=2*e,r=2*t;return this._bounds?this._bounds.setShape(i,n,o,r):this._bounds=new me.Rect(i,n,o,r),this._bounds},clone(){return new me.Ellipse(this.pos.x,this.pos.y,2*this.radiusV.x,2*this.radiusV.y)}}),me.Polygon=me.Object.extend({init(e,t,i){this.pos=new me.Vector2d,this._bounds=void 0,this.points=null,this.shapeType="Polygon",this.setShape(e,t,i)},setShape(e,t,i){return this.pos.set(e,t),this.points=i,this.recalc(),this.updateBounds(),this},transform(e){const t=this.points,i=t.length;for(let n=0;n<i;n++)e.multiplyVector(t[n]);return this.recalc(),this.updateBounds(),this},toIso(){return this.rotate(Math.PI/4).scale(Math.SQRT2,Math.SQRT1_2)},to2d(){return this.scale(Math.SQRT1_2,Math.SQRT2).rotate(-Math.PI/4)},rotate(e){if(0!==e){const t=this.points,i=t.length;for(let n=0;n<i;n++)t[n].rotate(e);this.recalc(),this.updateBounds()}return this},scale(e,t){t=void 0!==t?t:e;const i=this.points,n=i.length;for(let o=0;o<n;o++)i[o].scale(e,t);return this.recalc(),this.updateBounds(),this},scaleV(e){return this.scale(e.x,e.y)},recalc(){let e;const t=this.edges=[],i=this.normals=[],n=this.points,o=n.length;if(o<3)throw new me.Polygon.Error("Requires at least 3 points");for(e=0;e<o;e++){const r=(new me.Vector2d).copy(n[(e+1)%o]).sub(n[e]);t.push(r),i.push((new me.Vector2d).copy(r).perp().normalize())}return this},translate(e,t){return this.pos.x+=e,this.pos.y+=t,this._bounds.translate(e,t),this},translateV(e){return this.pos.add(e),this._bounds.translateV(e),this},containsPointV(e){return this.containsPoint(e.x,e.y)},containsPoint(e,t){let i=!1,n=this.pos.x,o=this.pos.y;const r=this.points,s=r.length;for(let a=0,h=s-1;a<s;h=a++){let s=r[a].y+o,l=r[a].x+n,c=r[h].y+o,u=r[h].x+n;s>t!=c>t&&e<(u-l)*(t-s)/(c-s)+l&&(i=!i)}return i},getBounds(){return this._bounds},updateBounds(){return this._bounds||(this._bounds=new me.Rect(0,0,0,0)),this._bounds.setPoints(this.points),this._bounds.translateV(this.pos),this._bounds},clone(){const e=[];return this.points.forEach(t=>{e.push(new me.Vector2d(t.x,t.y))}),new me.Polygon(this.pos.x,this.pos.y,e)}}),me.Polygon.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.Polygon.Error"}}),me.Rect=me.Polygon.extend({init(e,t,i,n){this.pos=new me.Vector2d,this.shapeType="Rectangle",this.setShape(e,t,[new me.Vector2d(0,0),new me.Vector2d(i,0),new me.Vector2d(i,n),new me.Vector2d(0,n)])},setShape(e,t,i,n){let o=i;return 4===arguments.length&&((o=this.points)[0].set(0,0),o[1].set(i,0),o[2].set(i,n),o[3].set(0,n)),me.Polygon.prototype.setShape.apply(this,[e,t,o]),this._width=this.points[2].x,this._height=this.points[2].y,this},resize(e,t){return this.width=e,this.height=t,this},getBounds(){return this},setPoints(e){let t=1/0,i=1/0,n=-1/0,o=-1/0;return e.forEach(e=>{t=Math.min(t,e.x),i=Math.min(i,e.y),n=Math.max(n,e.x),o=Math.max(o,e.y)}),this.setShape(t,i,n-t,o-i),this},recalc(){return me.Polygon.prototype.recalc.apply(this),this._width=this.points[2].x,this._height=this.points[2].y,this},updateBounds(){return this},clone(){return new me.Rect(this.pos.x,this.pos.y,this._width,this._height)},copy(e){return this.setShape(e.pos.x,e.pos.y,e._width,e._height)},translate(e,t){return this.pos.x+=e,this.pos.y+=t,this},translateV(e){return this.translate(e.x,e.y)},union(e){const t=Math.min(this.left,e.left),i=Math.min(this.top,e.top);return this.resize(Math.max(this.right,e.right)-t,Math.max(this.bottom,e.bottom)-i),this.pos.set(t,i),this},overlaps(e){return this.left<e.right&&e.left<this.right&&this.top<e.bottom&&e.top<this.bottom},contains(e){return e.left>=this.left&&e.right<=this.right&&e.top>=this.top&&e.bottom<=this.bottom},containsPoint(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom},toPolygon(){return new me.Polygon(this.pos.x,this.pos.y,this.points)}}),Object.defineProperty(me.Rect.prototype,"left",{get(){return this.pos.x},configurable:!0}),Object.defineProperty(me.Rect.prototype,"right",{get(){const e=this._width;return this.pos.x+e||e},configurable:!0}),Object.defineProperty(me.Rect.prototype,"top",{get(){return this.pos.y},configurable:!0}),Object.defineProperty(me.Rect.prototype,"bottom",{get(){const e=this._height;return this.pos.y+e||e},configurable:!0}),Object.defineProperty(me.Rect.prototype,"width",{get(){return this._width},set(e){this.points[1].x=this.points[2].x=e,this.recalc()},configurable:!0}),Object.defineProperty(me.Rect.prototype,"height",{get(){return this._height},set(e){this.points[2].y=this.points[3].y=e,this.recalc()},configurable:!0}),me.Line=me.Polygon.extend({containsPointV(e){return this.containsPoint(e.x,e.y)},containsPoint(e,t){e-=this.pos.x,t-=this.pos.y;const i=this.points[0],n=this.points[1];return(t-i.y)*(n.x-i.x)==(n.y-i.y)*(e-i.x)},recalc(){const e=this.edges=[],t=this.normals=[],i=this.points;if(2!==i.length)throw new me.Line.Error("Requires exactly 2 points");const n=(new me.Vector2d).copy(i[1]).sub(i[0]);return e.push(n),t.push((new me.Vector2d).copy(n).perp().normalize()),this},clone(){const e=[];return this.points.forEach(t=>{e.push(new me.Vector2d(t.x,t.y))}),new me.Line(this.pos.x,this.pos.y,e)}}),me.Line.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.Line.Error"}}),me.Body=me.Rect.extend({init(e,t,i){if(this.ancestor=e,this.shapes=[],this.collisionMask=me.collision.types.ALL_OBJECT,this.collisionType=me.collision.types.ENEMY_OBJECT,void 0===this.vel&&(this.vel=new me.Vector2d),this.vel.set(0,0),void 0===this.accel&&(this.accel=new me.Vector2d),this.accel.set(0,0),void 0===this.friction&&(this.friction=new me.Vector2d),this.friction.set(0,0),this.bounce=0,void 0===this.maxVel&&(this.maxVel=new me.Vector2d),this.maxVel.set(1e3,1e3),this.gravity=void 0!==me.sys.gravity?me.sys.gravity:.98,this.falling=!1,this.jumping=!1,me.Rect.prototype.init.apply(this,[0,0,this.ancestor.width,this.ancestor.height]),"function"==typeof i&&(this.onBodyUpdate=i),void 0!==t){for(let e=0;e<t.length;e++)this.addShape(t[e].clone(),!0);this.updateBounds()}},addShape(e,t){return e instanceof me.Rect?this.shapes.push(e.toPolygon()):this.shapes.push(e),!0!==t&&this.updateBounds(),this.shapes.length},addShapesFromJSON(e,t,i){let n;if(i=i||1,void 0===e.rigidBodies){if(void 0===(n=e[t]))throw new me.Body.Error(`Identifier (${t}) undefined for the given PhysicsEditor JSON object)`);for(let e=0;e<n.length;e++){const t=[];for(let i=0;i<n[e].shape.length;i+=2)t.push(new me.Vector2d(n[e].shape[i],n[e].shape[i+1]));this.addShape(new me.Polygon(0,0,t),!0)}}else{if(e.rigidBodies.forEach(e=>{e.name===t&&(n=e)}),void 0===n)throw new me.Body.Error(`Identifier (${t}) undefined for the given PhysicsEditor JSON object)`);this.pos.set(n.origin.x,1-n.origin.y).scale(i);const o=this;n.polygons.forEach(e=>{const t=[];e.forEach(e=>{t.push(new me.Vector2d(e.x,1-e.y).scale(i))}),o.addShape(new me.Polygon(0,0,t),!0)}),n.circles.forEach(e=>{o.addShape(new me.Ellipse(e.cx*i,(1-e.cy)*i,2*e.r*i,2*e.r*i),!0)})}return this.updateBounds(),this.shapes.length},getShape(e){return this.shapes[e||0]},removeShape(e){return this.shapes.remove(e),this.updateBounds(),this.shapes.length},removeShapeAt(e){return this.removeShape(this.getShape(e))},setCollisionMask(e){this.collisionMask=e},respondToCollision(e){const t=e.overlapV;if(this.ancestor.pos.sub(t),0!==t.x&&(this.vel.x=~~(.5+this.vel.x-t.x)||0,this.bounce>0&&(this.vel.x*=-this.bounce)),0!==t.y){this.vel.y=~~(.5+this.vel.y-t.y)||0,this.bounce>0&&(this.vel.y*=-this.bounce);const e=Math.sign(this.gravity)||1;this.falling=t.y>=e,this.jumping=t.y<=-e}},updateBounds(){if(this.shapes.length>0){const e=this.shapes[0].getBounds();this.pos.setV(e.pos),this.resize(e.width,e.height);for(let e=1;e<this.shapes.length;e++)this.union(this.shapes[e].getBounds())}return"function"==typeof this.onBodyUpdate&&this.onBodyUpdate(this),this},setVelocity(e,t){this.accel.x=0!==e?e:this.accel.x,this.accel.y=0!==t?t:this.accel.y,this.setMaxVelocity(e,t)},setMaxVelocity(e,t){this.maxVel.x=e,this.maxVel.y=t},setFriction(e,t){this.friction.x=e||0,this.friction.y=t||0},applyFriction(e){let t=this.friction.x*me.timer.tick,i=e.x+t,n=e.x-t,o=this.friction.y*me.timer.tick,r=e.y+o,s=e.y-o;e.x=i<0?i:n>0?n:0,e.y=r<0?r:s>0?s:0},computeVelocity(e){this.gravity&&(e.y+=this.gravity*me.timer.tick,this.falling=e.y*Math.sign(this.gravity)>0,this.jumping=!this.falling&&this.jumping),(this.friction.x||this.friction.y)&&this.applyFriction(e),0!==e.y&&(e.y=e.y.clamp(-this.maxVel.y,this.maxVel.y)),0!==e.x&&(e.x=e.x.clamp(-this.maxVel.x,this.maxVel.x))},update(){return this.computeVelocity(this.vel),this.ancestor.pos.add(this.vel),0!==this.vel.x||0!==this.vel.y},destroy(){this.onBodyUpdate=null,this.ancestor=null,this.shapes=[]}}),me.Body.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.Body.Error"}}),function(){const e=[],t=function(t,i,n,o){if(e.length>0){const r=e.pop();return r.bounds=t,r.max_objects=i||4,r.max_levels=n||4,r.level=o||0,r}return new me.QuadTree(t,i,n,o)},i=new me.Vector2d;function n(e,t,i,n){this.max_objects=t||4,this.max_levels=i||4,this.level=n||0,this.bounds=e,this.objects=[],this.nodes=[]}n.prototype.split=function(){let e=this.level+1,i=~~(.5+this.bounds.width/2),n=~~(.5+this.bounds.height/2),o=~~(.5+this.bounds.pos.x),r=~~(.5+this.bounds.pos.y);this.nodes[0]=t({pos:{x:o+i,y:r},width:i,height:n},this.max_objects,this.max_levels,e),this.nodes[1]=t({pos:{x:o,y:r},width:i,height:n},this.max_objects,this.max_levels,e),this.nodes[2]=t({pos:{x:o,y:r+n},width:i,height:n},this.max_objects,this.max_levels,e),this.nodes[3]=t({pos:{x:o+i,y:r+n},width:i,height:n},this.max_objects,this.max_levels,e)},n.prototype.getIndex=function(e){let t=e.getBounds(),n=t.pos;(e.floating||e.ancestor&&e.ancestor.floating)&&(n=me.game.viewport.localToWorld(n.x,n.y,i));let o=-1,r=n.x,s=n.y,a=t.width,h=t.height,l=this.bounds.pos.x+this.bounds.width/2,c=this.bounds.pos.y+this.bounds.height/2,u=s<c&&s+h<c,d=s>c;return r<l&&r+a<l?u?o=1:d&&(o=2):r>l&&(u?o=0:d&&(o=3)),o},n.prototype.insertContainer=function(e){for(var t,i=e.children.length;i--,t=e.children[i];)!0!==t.isKinematic&&(t instanceof me.Container?("rootContainer"!==t.name&&this.insert(t),this.insertContainer(t)):"function"==typeof t.getBounds&&this.insert(t))},n.prototype.insert=function(e){let t=-1;if(this.nodes.length>0&&-1!==(t=this.getIndex(e)))this.nodes[t].insert(e);else if(this.objects.push(e),this.objects.length>this.max_objects&&this.level<this.max_levels){0===this.nodes.length&&this.split();let e=0;for(;e<this.objects.length;)-1!==(t=this.getIndex(this.objects[e]))?this.nodes[t].insert(this.objects.splice(e,1)[0]):e+=1}},n.prototype.retrieve=function(e,t){let i=this.objects;if(this.nodes.length>0){const t=this.getIndex(e);if(-1!==t)i=i.concat(this.nodes[t].retrieve(e));else for(let t=0;t<this.nodes.length;t+=1)i=i.concat(this.nodes[t].retrieve(e))}return"function"==typeof t&&i.sort(t),i},n.prototype.remove=function(e){let t=!1;if(void 0===e.getBounds)return!1;if(this.nodes.length>0){const i=this.getIndex(e);-1!==i&&(t=this.nodes[i].remove(e))&&this.nodes[i].isPrunable()&&this.nodes.splice(i,1)}return!1===t&&-1!==this.objects.indexOf(e)&&(this.objects.remove(e),t=!0),t},n.prototype.isPrunable=function(){return!(this.hasChildren()||this.objects.length>0)},n.prototype.hasChildren=function(){for(let e=0;e<this.nodes.length;e+=1){const t=this.nodes[e];if(t.length>0||t.objects.length>0)return!0}return!1},n.prototype.clear=function(t){this.objects.length=0;for(let t=0;t<this.nodes.length;t+=1)this.nodes[t].clear(),i=this.nodes[t],e.push(i);var i;this.nodes=[],void 0!==t&&this.bounds.setShape(t.pos.x,t.pos.y,t.width,t.height)},me.QuadTree=n}(),function(){const e=-1,t=0,i=1,n=[];for(let e=0;e<10;e++)n.push(new me.Vector2d);const o=[];for(let e=0;e<5;e++)o.push([]);const r={pos:new me.Vector2d(0,0),ancestor:{_absPos:new me.Vector2d(0,0)}};function s(e,t,i){let n=Number.MAX_VALUE,o=-Number.MAX_VALUE;const r=e.length;for(let i=0;i<r;i++){const r=e[i].dotProduct(t);r<n&&(n=r),r>o&&(o=r)}i[0]=n,i[1]=o}function a(e,t,i,r,a,h){const l=o.pop(),c=o.pop(),u=n.pop().copy(t).sub(e),d=u.dotProduct(a);if(s(i,a,l),s(r,a,c),c[0]+=d,c[1]+=d,l[0]>c[1]||c[0]>l[1])return n.push(u),o.push(l),o.push(c),!0;if(h){let e=0;if(l[0]<c[0])if(h.aInB=!1,l[1]<c[1])e=l[1]-c[0],h.bInA=!1;else{const t=l[1]-c[0],i=c[1]-l[0];e=t<i?t:-i}else if(h.bInA=!1,l[1]>c[1])e=l[0]-c[1],h.aInB=!1;else{const t=l[1]-c[0],i=c[1]-l[0];e=t<i?t:-i}const t=Math.abs(e);t<h.overlap&&(h.overlap=t,h.overlapN.copy(a),e<0&&h.overlapN.negateSelf())}return n.push(u),o.push(l),o.push(c),!1}function h(n,o){const r=n.length2(),s=o.dotProduct(n);return s<0?e:s>r?i:t}me.collision=function(){const t={quadTree:null,maxDepth:4,maxChildren:8,bounds:null,types:{NO_OBJECT:0,PLAYER_OBJECT:1,NPC_OBJECT:2,ENEMY_OBJECT:4,COLLECTABLE_OBJECT:8,ACTION_OBJECT:16,PROJECTILE_OBJECT:32,WORLD_SHAPE:64,USER:128,ALL_OBJECT:4294967295},init:function(){t.bounds=me.game.viewport.clone(),t.quadTree=new me.QuadTree(t.bounds,t.maxChildren,t.maxDepth),me.event.subscribe(me.event.LEVEL_LOADED,()=>{t.bounds=me.game.world.clone(),t.quadTree.clear(t.bounds)})},ResponseObject:function(){this.a=null,this.b=null,this.overlapN=new me.Vector2d,this.overlapV=new me.Vector2d,this.aInB=!0,this.bInA=!0,this.indexShapeA=-1,this.indexShapeB=-1,this.overlap=Number.MAX_VALUE}};return t.ResponseObject.prototype.clear=function(){return this.aInB=!0,this.bInA=!0,this.overlap=Number.MAX_VALUE,this.indexShapeA=-1,this.indexShapeB=-1,this},t.response=new t.ResponseObject,t.shouldCollide=function(e,t){return!0!==e.isKinematic&&!0!==t.isKinematic&&e.body&&t.body&&0!=(e.body.collisionMask&t.body.collisionType)&&0!=(e.body.collisionType&t.body.collisionMask)},t.check=function(e,i){let n=0;const o=i||t.response,r=t.quadTree.retrieve(e);for(var s,a=r.length;s=r[--a];)if(s!==e&&t.shouldCollide(e,s)&&e.getBounds().overlaps(s.getBounds())){const i=e.body.shapes.length,r=s.body.shapes.length;if(0===i||0===r)continue;let a=0;do{const i=e.body.getShape(a);let h=0;do{const r=s.body.getShape(h);!0===t[`test${i.shapeType}${r.shapeType}`].call(this,e,i,s,r,o.clear())&&(n++,o.indexShapeA=a,o.indexShapeB=h,e.onCollision&&!1!==e.onCollision(o,s)&&e.body.respondToCollision.call(e.body,o),s.onCollision&&!1!==s.onCollision(o,e)&&s.body.respondToCollision.call(s.body,o)),h++}while(h<r);a++}while(a<i)}return n>0},t.rayCast=function(e,i){let n=0;const o=i||[],s=t.quadTree.retrieve(e.getBounds());for(var a,h=s.length;a=s[--h];)if(a.body&&e.getBounds().overlaps(a.getBounds())){const i=a.body.shapes.length;if(0===a.body.shapes.length)continue;const s=e;let h=0;do{const e=a.body.getShape(h);t[`test${s.shapeType}${e.shapeType}`].call(this,r,s,a,e)&&(o[n]=a,n++),h++}while(h<i)}return o.length=n,o},t.testPolygonPolygon=function(e,t,i,o,r){const s=t.points,h=t.normals,l=h.length,c=o.points,u=o.normals,d=u.length,p=n.pop().copy(e.pos).add(e.ancestor._absPos).add(t.pos),m=n.pop().copy(i.pos).add(i.ancestor._absPos).add(o.pos);let f;for(f=0;f<l;f++)if(a(p,m,s,c,h[f],r))return n.push(p),n.push(m),!1;for(f=0;f<d;f++)if(a(p,m,s,c,u[f],r))return n.push(p),n.push(m),!1;return r&&(r.a=e,r.b=i,r.overlapV.copy(r.overlapN).scale(r.overlap)),n.push(p),n.push(m),!0},t.testEllipseEllipse=function(e,t,i,o,r){const s=n.pop().copy(i.pos).add(i.ancestor._absPos).add(o.pos).sub(e.pos).add(e.ancestor._absPos).sub(t.pos),a=t.radius,h=o.radius,l=a+h,c=l*l,u=s.length2();if(u>c)return n.push(s),!1;if(r){const t=Math.sqrt(u);r.a=e,r.b=i,r.overlap=l-t,r.overlapN.copy(s.normalize()),r.overlapV.copy(s).scale(r.overlap),r.aInB=a<=h&&t<=h-a,r.bInA=h<=a&&t<=a-h}return n.push(s),!0},t.testPolygonEllipse=function(t,o,r,s,a){const l=n.pop().copy(r.pos).add(r.ancestor._absPos).add(s.pos).sub(t.pos).add(t.ancestor._absPos).sub(o.pos),c=s.radius,u=c*c,d=o.points,p=o.edges,m=p.length,f=n.pop(),g=n.pop(),y=n.pop();let v=0;for(let t=0;t<m;t++){const r=t===m-1?0:t+1,s=0===t?m-1:t-1;let w=0,b=null;f.copy(p[t]),y.copy(l).sub(d[t]),a&&y.length2()>u&&(a.aInB=!1);let x=h(f,y),E=!0;if(x===e){let e=null;if(m>1&&(f.copy(p[s]),(x=h(f,e=n.pop().copy(l).sub(d[s])))!==i&&(E=!1)),E){if((v=y.length())>c)return n.push(l),n.push(f),n.push(g),n.push(y),e&&n.push(e),!1;a&&(a.bInA=!1,b=y.normalize(),w=c-v)}e&&n.push(e)}else if(x===i){if(m>1&&(f.copy(p[r]),y.copy(l).sub(d[r]),(x=h(f,y))!==e&&(E=!1)),E){if((v=y.length())>c)return n.push(l),n.push(f),n.push(g),n.push(y),!1;a&&(a.bInA=!1,b=y.normalize(),w=c-v)}}else{g.copy(o.normals[t]),v=y.dotProduct(g);const e=Math.abs(v);if((1===m||v>0)&&e>c)return n.push(l),n.push(f),n.push(g),n.push(y),!1;a&&(b=g,w=c-v,(v>=0||w<2*c)&&(a.bInA=!1))}b&&a&&Math.abs(w)<Math.abs(a.overlap)&&(a.overlap=w,a.overlapN.copy(b))}return a&&(a.a=t,a.b=r,a.overlapV.copy(a.overlapN).scale(a.overlap)),n.push(l),n.push(f),n.push(g),n.push(y),!0},t.testEllipsePolygon=function(e,i,n,o,r){const s=t.testPolygonEllipse(n,o,e,i,r);if(s&&r){const e=r.a,t=r.aInB;r.overlapN.negateSelf(),r.overlapV.negateSelf(),r.a=r.b,r.b=e,r.aInB=r.bInA,r.bInA=t}return s},t}()}(),me.Renderable=me.Rect.extend({init(e,t,i,n){this.isRenderable=!0,this.isKinematic=!0,this.body=void 0,void 0!==this.currentTransform?this.currentTransform.identity():this.currentTransform=me.pool.pull("me.Matrix2d"),this.GUID=void 0,this.inViewport=!1,this.alwaysUpdate=!1,this.updateWhenPaused=!1,this.isPersistent=!1,this.floating=!1,this.anchorPoint instanceof me.ObservableVector2d?this.anchorPoint.setMuted(.5,.5).setCallback(this.onAnchorUpdate.bind(this)):this.anchorPoint=new me.ObservableVector2d(.5,.5,{onUpdate:this.onAnchorUpdate.bind(this)}),this.autoTransform=!0,this.alpha=1,this.ancestor=void 0,this._bounds?this._bounds.setShape(e,t,i,n):this._bounds=new me.Rect(e,t,i,n),this._absPos?this._absPos.set(e,t):this._absPos=new me.Vector2d(e,t),this.pos instanceof me.ObservableVector3d?this.pos.setMuted(e,t,0).setCallback(this.updateBoundsPos.bind(this)):this.pos=new me.ObservableVector3d(e,t,0,{onUpdate:this.updateBoundsPos.bind(this)}),this._width=i,this._height=n,this._flip={lastX:!1,lastY:!1},this.shapeType="Rectangle",this.setOpacity(1)},getBounds(){return this._bounds},getOpacity(){return this.alpha},setOpacity(e){"number"==typeof e&&(this.alpha=e.clamp(0,1),isNaN(this.alpha)&&(this.alpha=1))},flipX(e){e!==this._flip.lastX&&(this._flip.lastX=e,this.currentTransform.scaleX(-1))},flipY(e){e!==this._flip.lastY&&(this._flip.lastY=e,this.currentTransform.scaleY(-1))},transform(e){const t=this.getBounds();return this.currentTransform.multiply(e),t.setPoints(t.transform(e).points),t.pos.setV(this.pos),this},scale(e,t){let i=e,n=void 0===t?i:t;return this.currentTransform.scale(i,n),this.getBounds().resize(this.width*i,this.height*n),this},scaleV(e){return this.scale(e.x,e.y),this},update:()=>!1,updateBoundsPos(e,t){const i=this.getBounds();return i.pos.set(e,t,i.pos.z),this.ancestor&&i.pos.add(this.ancestor._absPos),i},onAnchorUpdate(){},updateBounds(){return console.warn("Deprecated: me.Renderable.updateBounds"),me.Rect.prototype.updateBounds.apply(this)},preDraw(e){const t=this.getBounds();let i=t.width*this.anchorPoint.x,n=t.height*this.anchorPoint.y;e.save(),e.setGlobalAlpha(e.globalAlpha()*this.getOpacity()),!0!==this.autoTransform||this.currentTransform.isIdentity()?e.translate(-i,-n):(this.currentTransform.translate(-i,-n),e.transform(this.currentTransform),this.currentTransform.translate(i,n))},draw(){},postDraw(e){e.restore()},destroy(){this.currentTransform.identity(),void 0!==this.body&&(this.body.destroy.apply(this.body,arguments),this.body=void 0),this.onDestroyEvent.apply(this,arguments)},onDestroyEvent(){}}),Object.defineProperty(me.Renderable.prototype,"width",{get(){return this._width},set(e){this.getBounds().width=e,this._width=e},configurable:!0}),Object.defineProperty(me.Renderable.prototype,"height",{get(){return this._height},set(e){this.getBounds().height=e,this._height=e},configurable:!0}),me.Renderable.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.Renderable.Error"}}),me.ColorLayer=me.Renderable.extend({init(e,t,i){me.Renderable.prototype.init.apply(this,[0,0,1/0,1/0]),this.name=e,this.pos.z=i,this.floating=!0,t instanceof me.Color?this.color=t:this.color=me.pool.pull("me.Color").parseCSS(t),this.anchorPoint.set(0,0)},draw(e,t){const i=e.getColor(),n=me.game.viewport.pos;e.setColor(this.color),e.fillRect(t.left-n.x,t.top-n.y,t.width,t.height),e.setColor(i)}}),me.ImageLayer=me.Renderable.extend({init(e,t,i){if(this.name=i.name||"me.ImageLayer",this.image=me.utils.getImage(i.image),!this.image)throw new me.Error(`${"string"==typeof i.image?`'${i.image}'`:"Image"} file for Image Layer '${this.name}' not found!`);this.imagewidth=this.image.width,this.imageheight=this.image.height,me.Renderable.prototype.init.apply(this,[e,t,1/0,1/0]),this.floating=!0,this.pos.z=i.z||0,this.offset=new me.Vector2d(e,t),this.ratio=new me.Vector2d(1,1),void 0!==i.ratio&&("number"==typeof i.ratio?this.ratio.set(i.ratio,i.ratio):this.ratio.setV(i.ratio)),void 0===i.anchorPoint?this.anchorPoint.set(0,0):"number"==typeof i.anchorPoint?this.anchorPoint.set(i.anchorPoint,i.anchorPoint):this.anchorPoint.setV(i.anchorPoint),Object.defineProperty(this,"repeat",{get:function(){return this._repeat},set:function(e){switch(this._repeat=e,this._repeat){case"no-repeat":this.repeatX=!1,this.repeatY=!1;break;case"repeat-x":this.repeatX=!0,this.repeatY=!1;break;case"repeat-y":this.repeatX=!1,this.repeatY=!0;break;default:this.repeatX=!0,this.repeatY=!0}this.resize(me.game.viewport.width,me.game.viewport.height),this.createPattern()}}),this.repeat=i.repeat||"repeat"},onActivateEvent(){const e=this.updateLayer.bind(this);this.vpChangeHdlr=me.event.subscribe(me.event.VIEWPORT_ONCHANGE,e),this.vpResizeHdlr=me.event.subscribe(me.event.VIEWPORT_ONRESIZE,this.resize.bind(this)),this.vpLoadedHdlr=me.event.subscribe(me.event.LEVEL_LOADED,()=>{e(me.game.viewport.pos)}),!0!==this.ancestor._root&&this.updateLayer(me.game.viewport.pos)},resize(e,t){me.Renderable.prototype.resize.apply(this,[this.repeatX?1/0:e,this.repeatY?1/0:t])},createPattern(){this._pattern=me.video.renderer.createPattern(this.image,this._repeat)},updateLayer(e){let t=this.ratio.x,i=this.ratio.y;if(t===i===0)return;let n=me.game.viewport,o=this.imagewidth,r=this.imageheight,s=n.bounds.width,a=n.bounds.height,h=this.anchorPoint.x,l=this.anchorPoint.y,c=h*(t-1)*(s-n.width)+this.offset.x-t*e.x,u=l*(i-1)*(a-n.height)+this.offset.y-i*e.y;this.repeatX?this.pos.x=c%o:this.pos.x=c,this.repeatY?this.pos.y=u%r:this.pos.y=u},preDraw(e){e.save(),e.setGlobalAlpha(e.globalAlpha()*this.getOpacity())},draw(e){let t=me.game.viewport,i=this.imagewidth,n=this.imageheight,o=t.bounds.width,r=t.bounds.height,s=this.anchorPoint.x,a=this.anchorPoint.y,h=this.pos.x,l=this.pos.y;this.ratio.x===this.ratio.y===0&&(h+=s*(o-i),l+=a*(r-n)),e.translate(h,l),e.drawPattern(this._pattern,0,0,2*t.width,2*t.height)},onDeactivateEvent(){me.event.unsubscribe(this.vpChangeHdlr),me.event.unsubscribe(this.vpResizeHdlr),me.event.unsubscribe(this.vpLoadedHdlr)}}),me.Sprite=me.Renderable.extend({init(e,t,i){if(this.animationpause=!1,this.animationspeed=100,this.offset=new me.Vector2d,this.anim={},this.resetAnim=null,this.current={offset:new me.Vector2d,width:0,height:0,angle:0},this.dt=0,this._flicker={isFlickering:!1,duration:0,callback:null,state:!1},this.isSprite=!0,i.image instanceof me.CanvasRenderer.prototype.Texture){if(this.image=i.image.getTexture(),this.textureAtlas=i.image,void 0!==i.region){const e=i.image.getRegion(i.region);if(!e)throw new me.Renderable.Error(`Texture - region for ${i.region} not found`);this.setRegion(e),i.framewidth=i.framewidth||e.width,i.frameheight=i.frameheight||e.height}}else this.image=me.utils.getImage(i.image),i.framewidth=i.framewidth||this.image.width,i.frameheight=i.frameheight||this.image.height,this.textureAtlas=me.video.renderer.cache.get(this.image,i).getAtlas();this.current.width=i.framewidth,this.current.height=i.frameheight,void 0!==i.atlas?(this.textureAtlas=i.atlas,this.atlasIndices=i.atlasIndices):this.atlasIndices=null,me.Renderable.prototype.init.apply(this,[e,t,this.current.width,this.current.height]),void 0!==i.flipX&&this.flipX(!!i.flipX),void 0!==i.flipY&&this.flipY(!!i.flipY),void 0!==i.rotation&&this.currentTransform.rotate(i.rotation),i.anchorPoint&&this.anchorPoint.set(i.anchorPoint.x,i.anchorPoint.y),0!==this.addAnimation("default",null)&&this.setCurrentAnimation("default"),this.autoTransform=!0},isFlickering(){return this._flicker.isFlickering},flicker(e,t){this._flicker.duration=e,this._flicker.duration<=0?(this._flicker.isFlickering=!1,this._flicker.callback=null):this._flicker.isFlickering||(this._flicker.callback=t,this._flicker.isFlickering=!0)},addAnimation(e,t,i){this.anim[e]={name:e,frames:[],idx:0,length:0};let n=0;if("object"!=typeof this.textureAtlas)return 0;null==t&&(t=[],Object.keys(this.textureAtlas).forEach((e,i)=>{t[i]=i}));for(let r=0,s=t.length;r<s;r++){const s=t[r];var o;const a=(o="number"==typeof s||"string"==typeof s?{name:s,delay:i||this.animationspeed}:s).name;if("number"==typeof a)void 0!==this.textureAtlas[a]&&(this.anim[e].frames[r]=Object.assign({},this.textureAtlas[a],o),n++);else{if(null===this.atlasIndices)throw new me.Renderable.Error("string parameters for addAnimation are not allowed for standard spritesheet based Texture");this.anim[e].frames[r]=Object.assign({},this.textureAtlas[this.atlasIndices[a]],o),n++}}return this.anim[e].length=n,n},setCurrentAnimation(e,t,i){if(!this.anim[e])throw new me.Renderable.Error(`animation id '${e}' not defined`);this.current=this.anim[e],this.resetAnim=t||null,this.setAnimationFrame(this.current.idx),this.current.name=e,i||(this.dt=0)},isCurrentAnimation(e){return this.current.name===e},setRegion(e){this.current.offset.setV(e.offset),this.current.angle=e.angle,this.current.width=e.width,this.current.height=e.height},setAnimationFrame(e){this.current.idx=(e||0)%this.current.length;const t=this.current.name,i=this.getAnimationFrameObjectByIndex(this.current.idx);Object.assign(this.current,i),this.current.name=t,this.width=i.width,this.height=i.height,i.anchorPoint&&this.anchorPoint.setV(i.anchorPoint)},getCurrentAnimationFrame(){return this.current.idx},getAnimationFrameObjectByIndex(e){return this.current.frames[e]},update(e){let t=!1;if(!this.animationpause&&this.current&&this.current.length>1){let i=this.getAnimationFrameObjectByIndex(this.current.idx).delay;for(this.dt+=e;this.dt>=i;){if(t=!0,this.dt-=i,this.setAnimationFrame(this.current.idx+1),0===this.current.idx&&this.resetAnim)if("string"==typeof this.resetAnim)this.setCurrentAnimation(this.resetAnim,null,!0);else if(!1===this.resetAnim()){this.setAnimationFrame(this.current.length-1),this.dt%=i;break}i=this.getAnimationFrameObjectByIndex(this.current.idx).delay}}return this._flicker.isFlickering&&(this._flicker.duration-=e,this._flicker.duration<0&&("function"==typeof this._flicker.callback&&this._flicker.callback(),this.flicker(-1)),t=!0),t},updateBoundsPos(e,t){const i=this.getBounds();return i.pos.set(e-this.anchorPoint.x*i.width,t-this.anchorPoint.y*i.height),this.ancestor&&i.pos.add(this.ancestor._absPos),i},onAnchorUpdate(e,t){this.anchorPoint.setMuted(e,t),this.updateBoundsPos(this.pos.x,this.pos.y)},draw(e){if(this._flicker.isFlickering&&(this._flicker.state=!this._flicker.state,!this._flicker.state))return;const t=this.current;let i=this.pos.x,n=this.pos.y,o=t.width,r=t.height;const s=t.offset,a=this.offset;0!==t.angle&&(e.translate(-i,-n),e.rotate(t.angle),i-=r,o=t.height,r=t.width),e.drawImage(this.image,a.x+s.x,a.y+s.y,o,r,i,n,o,r)}}),me.AnimationSheet=me.Sprite,function(){let e=Math.min,t=Math.max;me.Viewport=me.Renderable.extend({init(e,t,i,n){me.Renderable.prototype.init.apply(this,[e,t,i-e,n-t]),this.AXIS={NONE:0,HORIZONTAL:1,VERTICAL:2,BOTH:3},this.bounds=new me.Rect(-1/0,-1/0,1/0,1/0),this.offset=new me.Vector2d,this.target=null,this.follow_axis=this.AXIS.NONE,this._shake={intensity:0,duration:0,axis:this.AXIS.BOTH,onComplete:null},this._fadeOut={color:null,tween:null},this._fadeIn={color:null,tween:null},this.setDeadzone(this.width/6,this.height/6),this.anchorPoint.set(0,0),this.isKinematic=!1},_followH(i){const n=this.pos.x;return i.x-this.pos.x>this.deadzone.right?this.pos.x=e(i.x-this.deadzone.right,this.bounds.width-this.width):i.x-this.pos.x<this.deadzone.pos.x&&(this.pos.x=t(i.x-this.deadzone.pos.x,this.bounds.pos.x)),n!==this.pos.x},_followV(i){const n=this.pos.y;return i.y-this.pos.y>this.deadzone.bottom?this.pos.y=e(i.y-this.deadzone.bottom,this.bounds.height-this.height):i.y-this.pos.y<this.deadzone.pos.y&&(this.pos.y=t(i.y-this.deadzone.pos.y,this.bounds.pos.y)),n!==this.pos.y},reset(e,t){this.pos.x=e||0,this.pos.y=t||0,this.unfollow(),this.currentTransform.identity()},setDeadzone(e,t){void 0===this.deadzone&&(this.deadzone=new me.Rect(0,0,0,0)),this.deadzone.pos.set(~~((this.width-e)/2),~~((this.height-t)/2-.25*t)),this.deadzone.resize(e,t),this.updateTarget()},resize(e,t){me.Renderable.prototype.resize.apply(this,[e,t]);const i=me.levelDirector.getCurrentLevel();return this.setBounds(0,0,Math.max(e,i?i.width:0),Math.max(t,i?i.height:0)),this.setDeadzone(e/6,t/6),this.moveTo(0,0),this.update(),me.event.publish(me.event.VIEWPORT_ONRESIZE,[this.width,this.height]),this},setBounds(e,t,i,n){this.bounds.pos.set(e,t),this.bounds.resize(i,n),this.moveTo(this.pos.x,this.pos.y)},follow(e,t){if(e instanceof me.Renderable)this.target=e.pos;else{if(!(e instanceof me.Vector2d||e instanceof me.Vector3d))throw new me.Renderable.Error("invalid target for viewport.follow");this.target=e}this.follow_axis=void 0===t?this.AXIS.BOTH:t,this.updateTarget()},unfollow(){this.target=null,this.follow_axis=this.AXIS.NONE},move(e,t){this.moveTo(this.pos.x+e,this.pos.y+t)},moveTo(e,t){this.pos.x=e.clamp(this.bounds.pos.x,this.bounds.width-this.width),this.pos.y=t.clamp(this.bounds.pos.y,this.bounds.height-this.height),me.event.publish(me.event.VIEWPORT_ONCHANGE,[this.pos])},updateTarget(){let e=!1;if(this.target)switch(this.follow_axis){case this.AXIS.NONE:break;case this.AXIS.HORIZONTAL:e=this._followH(this.target);break;case this.AXIS.VERTICAL:e=this._followV(this.target);break;case this.AXIS.BOTH:e=this._followH(this.target),e=this._followV(this.target)||e}return e},update(e){let t=this.updateTarget();return this._shake.duration>0&&(this._shake.duration-=e,this._shake.duration<=0?(this._shake.duration=0,this.offset.setZero(),"function"==typeof this._shake.onComplete&&this._shake.onComplete()):(this._shake.axis!==this.AXIS.BOTH&&this._shake.axis!==this.AXIS.HORIZONTAL||(this.offset.x=(Math.random()-.5)*this._shake.intensity),this._shake.axis!==this.AXIS.BOTH&&this._shake.axis!==this.AXIS.VERTICAL||(this.offset.y=(Math.random()-.5)*this._shake.intensity)),t=!0),!0===t&&me.event.publish(me.event.VIEWPORT_ONCHANGE,[this.pos]),null==this._fadeIn.tween&&null==this._fadeOut.tween||(t=!0),t},shake(e,t,i,n,o){0!==this._shake.duration&&!0!==o||(this._shake.intensity=e,this._shake.duration=t,this._shake.axis=i||this.AXIS.BOTH,this._shake.onComplete="function"==typeof n?n:void 0)},fadeOut(e,t,i){this._fadeOut.color=me.pool.pull("me.Color").copy(e),this._fadeOut.tween=me.pool.pull("me.Tween",this._fadeOut.color).to({alpha:0},t||1e3).onComplete(i||null),this._fadeOut.tween.isPersistent=!0,this._fadeOut.tween.start()},fadeIn(e,t,i){this._fadeIn.color=me.pool.pull("me.Color").copy(e);const n=this._fadeIn.color.alpha;this._fadeIn.color.alpha=0,this._fadeIn.tween=me.pool.pull("me.Tween",this._fadeIn.color).to({alpha:n},t||1e3).onComplete(i||null),this._fadeIn.tween.isPersistent=!0,this._fadeIn.tween.start()},getWidth(){return this.width},getHeight(){return this.height},focusOn(e){const t=e.getBounds();this.moveTo(e.pos.x+t.pos.x+t.width/2,e.pos.y+t.pos.y+t.height/2)},isVisible(e){return e.overlaps(this)},localToWorld(e,t,i){return(i=i||new me.Vector2d).set(e,t).add(this.pos).sub(me.game.world.pos),this.currentTransform.isIdentity()||this.currentTransform.multiplyVectorInverse(i),i},worldToLocal(e,t,i){return(i=i||new me.Vector2d).set(e,t),this.currentTransform.isIdentity()||this.currentTransform.multiplyVector(i),i.sub(this.pos).add(me.game.world.pos)},draw(e){this._fadeIn.tween&&(e.clearColor(this._fadeIn.color),1===this._fadeIn.color.alpha&&(this._fadeIn.tween=null,me.pool.push(this._fadeIn.color),this._fadeIn.color=null)),this._fadeOut.tween&&(e.clearColor(this._fadeOut.color),0===this._fadeOut.color.alpha&&(this._fadeOut.tween=null,me.pool.push(this._fadeOut.color),this._fadeOut.color=null))}})}(),me.GUI_Object=me.Sprite.extend({init(e,t,i){this.isClickable=!0,this.holdThreshold=250,this.isHoldable=!1,this.hover=!1,this.holdTimeout=null,this.updated=!1,this.released=!0,me.Sprite.prototype.init.apply(this,[e,t,i]),this.floating=!0,this.isKinematic=!1},update(){return!!this.updated&&(this.released||(this.updated=!1),!0)},clicked(e){if(0===e.button&&this.isClickable)return this.updated=!0,this.released=!1,this.isHoldable&&(null!==this.holdTimeout&&me.timer.clearTimeout(this.holdTimeout),this.holdTimeout=me.timer.setTimeout(this.hold.bind(this),this.holdThreshold,!1),this.released=!1),this.onClick(e)},onClick:()=>!1,enter(e){return this.hover=!0,this.onOver(e)},onOver(){},leave(e){return this.hover=!1,this.release.call(this,e),this.onOut(e)},onOut(){},release(e){if(!1===this.released)return this.released=!0,me.timer.clearTimeout(this.holdTimeout),this.onRelease(e)},onRelease:()=>!1,hold(){me.timer.clearTimeout(this.holdTimeout),this.released||this.onHold()},onHold(){},onActivateEvent(){me.input.registerPointerEvent("pointerdown",this,this.clicked.bind(this)),me.input.registerPointerEvent("pointerup",this,this.release.bind(this)),me.input.registerPointerEvent("pointercancel",this,this.release.bind(this)),me.input.registerPointerEvent("pointerenter",this,this.enter.bind(this)),me.input.registerPointerEvent("pointerleave",this,this.leave.bind(this))},onDeactivateEvent(){me.input.releasePointerEvent("pointerdown",this),me.input.releasePointerEvent("pointerup",this),me.input.releasePointerEvent("pointercancel",this),me.input.releasePointerEvent("pointerenter",this),me.input.releasePointerEvent("pointerleave",this),me.timer.clearTimeout(this.holdTimeout)}}),function(){let e=0;me.Container=me.Renderable.extend({init(e,t,i,n){this.pendingSort=null,this._root=!1,me.Renderable.prototype.init.apply(this,[e||0,t||0,i||1/0,n||1/0]),this.children=[],this.sortOn=me.game.sortOn,this.autoSort=!0,this.autoDepth=!0,this.onChildChange=function(){},this.drawCount=0,this.childBounds=this.getBounds().clone(),this.autoTransform=!0,this.isKinematic=!1},addChild(e,t){return e.ancestor instanceof me.Container?e.ancestor.removeChildNow(e):e.isRenderable&&(e.GUID=me.utils.createGUID(e.id)),e.ancestor=this,this.children.push(e),void 0!==e.pos&&("number"==typeof t?e.pos.z=t:!0===this.autoDepth&&(e.pos.z=this.children.length)),!0===this.autoSort&&this.sort(),"function"==typeof e.onActivateEvent&&this.isAttachedToRoot()&&e.onActivateEvent(),this.onChildChange.call(this,this.children.length-1),e},addChildAt(e,t){if(t>=0&&t<this.children.length)return e.ancestor instanceof me.Container?e.ancestor.removeChildNow(e):e.isRenderable&&(e.GUID=me.utils.createGUID()),e.ancestor=this,this.children.splice(t,0,e),"function"==typeof e.onActivateEvent&&this.isAttachedToRoot()&&e.onActivateEvent(),this.onChildChange.call(this,t),e;throw new me.Container.Error(`Index (${t}) Out Of Bounds for addChildAt()`)},forEach(e,t){let i=this,n=0;const o=this.children.length;if("function"!=typeof e)throw new me.Container.Error(`${e} is not a function`);for(arguments.length>1&&(i=t);n<o;)e.call(i,this.children[n],n,this.children),n++},swapChildren(e,t){const i=this.getChildIndex(e),n=this.getChildIndex(t);if(-1===i||-1===n)throw new me.Container.Error(`${e} Both the supplied childs must be a child of the caller ${this}`);{const o=e.pos.z;e.pos.z=t.pos.z,t.pos.z=o,this.children[i]=t,this.children[n]=e}},getChildAt(e){if(e>=0&&e<this.children.length)return this.children[e];throw new me.Container.Error(`Index (${e}) Out Of Bounds for getChildAt()`)},getChildIndex(e){return this.children.indexOf(e)},hasChild(e){return this===e.ancestor},getChildByProp(e,t){let i=[];function n(e,n){const o=e[n];t instanceof RegExp&&"string"==typeof o?t.test(o)&&i.push(e):o===t&&i.push(e)}for(let o=this.children.length-1;o>=0;o--){const r=this.children[o];n(r,e),r instanceof me.Container&&(i=i.concat(r.getChildByProp(e,t)))}return i},getChildByType(e){let t=[];for(let i=this.children.length-1;i>=0;i--){const n=this.children[i];n instanceof e&&t.push(n),n instanceof me.Container&&(t=t.concat(n.getChildByType(e)))}return t},getChildByName(e){return this.getChildByProp("name",e)},getChildByGUID(e){const t=this.getChildByProp("GUID",e);return t.length>0?t[0]:null},updateChildBounds(){let e;this.childBounds.pos.set(1/0,1/0),this.childBounds.resize(-1/0,-1/0);for(var t,i=this.children.length;i--,t=this.children[i];)t.isRenderable&&null!==(e=t instanceof me.Container?t.childBounds:t.getBounds())&&this.childBounds.union(e);return this.childBounds},isAttachedToRoot(){if(this._root)return!0;let e=this.ancestor;for(;e;){if(!0===e._root)return!0;e=e.ancestor}return!1},updateBoundsPos(e,t){me.Renderable.prototype.updateBoundsPos.apply(this,[e,t]),this._absPos.set(e,t),this.ancestor&&this._absPos.add(this.ancestor._absPos);for(var i,n=this.children.length;n--,i=this.children[n];)i.isRenderable&&i.updateBoundsPos(i.pos.x,i.pos.y);return this.getBounds()},onActivateEvent(){for(var e,t=this.children.length;t--,e=this.children[t];)"function"==typeof e.onActivateEvent&&e.onActivateEvent()},removeChild(e,t){if(!this.hasChild(e))throw new me.Container.Error("Child is not mine.");(function(e,t){this.removeChildNow(e,t)}).defer(this,e,t)},removeChildNow(e,t){if(this.hasChild(e)&&this.getChildIndex(e)>=0){"function"==typeof e.onDeactivateEvent&&e.onDeactivateEvent(),t||("function"==typeof e.destroy&&e.destroy(),me.pool.push(e));const i=this.getChildIndex(e);i>=0&&(this.children.splice(i,1),e.ancestor=void 0),this.onChildChange.call(this,i)}},setChildsProperty(e,t,i){for(let n=this.children.length;n>=0;n--){const o=this.children[n];!0===i&&o instanceof me.Container&&o.setChildsProperty(e,t,i),o[e]=t}},moveUp(e){const t=this.getChildIndex(e);t-1>=0&&this.swapChildren(e,this.getChildAt(t-1))},moveDown(e){const t=this.getChildIndex(e);t>=0&&t+1<this.children.length&&this.swapChildren(e,this.getChildAt(t+1))},moveToTop(e){const t=this.getChildIndex(e);t>0&&(this.children.splice(0,0,this.children.splice(t,1)[0]),e.pos.z=this.children[1].pos.z+1)},moveToBottom(e){const t=this.getChildIndex(e);t>=0&&t<this.children.length-1&&(this.children.splice(this.children.length-1,0,this.children.splice(t,1)[0]),e.pos.z=this.children[this.children.length-2].pos.z-1)},sort(e){if(!this.pendingSort){if(!0===e)for(var t,i=this.children.length;i--,t=this.children[i];)t instanceof me.Container&&t.sort(e);this.pendingSort=function(e){e.children.sort(e[`_sort${e.sortOn.toUpperCase()}`]),e.pendingSort=null,me.game.repaint()}.defer(this,this)}},onDeactivateEvent(){for(var e,t=this.children.length;t--,e=this.children[t];)"function"==typeof e.onDeactivateEvent&&e.onDeactivateEvent()},_sortZ:(e,t)=>t.pos&&e.pos?t.pos.z-e.pos.z:e.pos?-1/0:1/0,_sortReverseZ:(e,t)=>e.pos&&t.pos?e.pos.z-t.pos.z:e.pos?1/0:-1/0,_sortX(e,t){if(!t.pos||!e.pos)return e.pos?-1/0:1/0;return t.pos.z-e.pos.z||t.pos.x-e.pos.x},_sortY(e,t){if(!t.pos||!e.pos)return e.pos?-1/0:1/0;return t.pos.z-e.pos.z||t.pos.y-e.pos.y},destroy(){this.pendingSort&&(clearTimeout(this.pendingSort),this.pendingSort=null);for(var e,t=this.children.length;t>=0;e=this.children[--t])e&&!e.isPersistent&&this.removeChildNow(e);me.Renderable.prototype.destroy.apply(this,arguments)},update(t){me.Renderable.prototype.update.apply(this,[t]);let i=!1,n=!1;const o=me.state.isPaused(),r=me.game.viewport;this._absPos.setV(this.pos),this.ancestor&&this._absPos.add(this.ancestor._absPos);for(var s,a=this.children.length;a--,s=this.children[a];)o&&!s.updateWhenPaused||(s.isRenderable?((n=e>0||s.floating)&&e++,s.inViewport=n||r.isVisible(s.getBounds()),i=(s.inViewport||s.alwaysUpdate)&&s.update(t)||i,s._absPos.setV(this._absPos).add(s.pos),e>0&&e--):i=s.update(t)||i);return i},draw(e,t){let i=!1;this.drawCount=0,e.translate(this.pos.x,this.pos.y);for(var n,o=this.children.length;o--,n=this.children[o];)n.isRenderable&&(i=!0===n.floating,(n.inViewport||i)&&(i&&(e.save(),e.resetTransform()),n.preDraw(e),n.draw(e,t),n.postDraw(e),i&&e.restore(),this.drawCount++))}}),me.Container.Error=me.Renderable.Error.extend({init(e){me.Renderable.Error.prototype.init.apply(this,[e]),this.name="me.Container.Error"}})}(),me.Entity=me.Renderable.extend({init(e,t,i){if(this.children=[],"number"!=typeof i.width||"number"!=typeof i.height)throw new me.Entity.Error("height and width properties are mandatory when passing settings parameters to an object entity");me.Renderable.prototype.init.apply(this,[e,t,i.width,i.height]),i.image&&(this.renderable=new me.Sprite(0,0,{image:i.image,framewidth:~~(i.framewidth||i.width),frameheight:~~(i.frameheight||i.height),spacing:~~i.spacing,margin:~~i.margin,anchorPoint:i.anchorPoint})),i.anchorPoint&&this.anchorPoint.set(i.anchorPoint.x,i.anchorPoint.y),this.name=i.name||"",this.type=i.type||"",this.id=i.id||"",this.alive=!0;const n=Array.isArray(i.shapes)?i.shapes:[new me.Rect(0,0,this.width,this.height)];if(void 0!==this.body?this.body.init(this,n,this.onBodyUpdate.bind(this)):this.body=new me.Body(this,n,this.onBodyUpdate.bind(this)),0===this.width&&0===this.height&&this.resize(this.body.width,this.body.height),void 0!==i.collisionMask&&this.body.setCollisionMask(i.collisionMask),void 0!==i.collisionType){if(void 0===me.collision.types[i.collisionType])throw new me.Entity.Error("Invalid value for the collisionType property");this.body.collisionType=me.collision.types[i.collisionType]}this.autoTransform=!1,this.isKinematic=!1},distanceTo(e){const t=this.getBounds(),i=e.getBounds(),n=t.pos.x+t.width/2-(i.pos.x+i.width/2),o=t.pos.y+t.height/2-(i.pos.y+i.height/2);return Math.sqrt(n*n+o*o)},distanceToPoint(e){const t=this.getBounds(),i=t.pos.x+t.width/2-e.x,n=t.pos.y+t.height/2-e.y;return Math.sqrt(i*i+n*n)},angleTo(e){const t=this.getBounds(),i=e.getBounds(),n=i.pos.x+i.width/2-(t.pos.x+t.width/2),o=i.pos.y+i.height/2-(t.pos.y+t.height/2);return Math.atan2(o,n)},angleToPoint(e){const t=this.getBounds(),i=e.x-(t.pos.x+t.width/2),n=e.y-(t.pos.y+t.height/2);return Math.atan2(n,i)},update(e){return this.renderable?this.renderable.update(e):me.Renderable.prototype.update.apply(this,[e])},updateBoundsPos(e,t){if(void 0!==this.body){const i=this.body.pos;me.Renderable.prototype.updateBoundsPos.apply(this,[e+i.x,t+i.y])}else me.Renderable.prototype.updateBoundsPos.apply(this,[e,t]);return this.getBounds()},onBodyUpdate(e){this.getBounds().resize(e.width,e.height),this.updateBoundsPos(this.pos.x,this.pos.y)},preDraw(e){e.save(),e.translate(this.pos.x+this.body.pos.x,this.pos.y+this.body.pos.y),this.renderable instanceof me.Renderable&&e.translate(this.anchorPoint.x*this.body.width,this.anchorPoint.y*this.body.height)},draw(e,t){const i=this.renderable;i instanceof me.Renderable&&(i.preDraw(e),i.draw(e,t),i.postDraw(e))},destroy(){this.renderable&&(this.renderable.destroy.apply(this.renderable,arguments),this.children.splice(0,1)),me.Renderable.prototype.destroy.apply(this,arguments)},onDeactivateEvent(){this.renderable&&this.renderable.onDeactivateEvent&&this.renderable.onDeactivateEvent()},onCollision:()=>!1}),Object.defineProperty(me.Entity.prototype,"renderable",{get(){return this.children[0]},set(e){if(!(e instanceof me.Renderable))throw new me.Entity.Error(`${e}should extend me.Renderable`);this.children[0]=e},configurable:!0}),me.Entity.Error=me.Renderable.Error.extend({init(e){me.Renderable.Error.prototype.init.apply(this,[e]),this.name="me.Entity.Error"}}),me.ScreenObject=me.Object.extend({init(){},reset(){me.game.reset(),this.onResetEvent.apply(this,arguments)},destroy(){this.onDestroyEvent.apply(this,arguments)},onResetEvent(){},onDestroyEvent(){}}),me.state=function(){const e={};let t=-1,i=-1,n=!1;const o={},r={color:"",duration:0};let s=null,a=null,h=0;function l(){-1===i&&-1!==t&&(me.timer.reset(),i=window.requestAnimationFrame(c))}function c(e){me.game.update(e),me.game.draw(),-1!==i&&(i=window.requestAnimationFrame(c))}function u(){window.cancelAnimationFrame(i),i=-1}function d(e){u(),o[t]&&o[t].screen.destroy(),o[e]&&(o[t=e].screen.reset.apply(o[t].screen,a),l(),s&&s(),me.game.repaint())}return e.LOADING=0,e.MENU=1,e.READY=2,e.PLAY=3,e.GAMEOVER=4,e.GAME_END=5,e.SCORE=6,e.CREDITS=7,e.SETTINGS=8,e.USER=100,e.onPause=null,e.onResume=null,e.onStop=null,e.onRestart=null,e.init=function(){e.set(e.LOADING,new me.DefaultLoadingScreen)},e.stop=function(i){t!==e.LOADING&&e.isRunning()&&(u(),!0===i&&me.audio.pauseTrack(),h=window.performance.now(),me.event.publish(me.event.STATE_STOP),"function"==typeof e.onStop&&e.onStop())},e.pause=function(i){t===e.LOADING||e.isPaused()||(n=!0,!0===i&&me.audio.pauseTrack(),h=window.performance.now(),me.event.publish(me.event.STATE_PAUSE),"function"==typeof e.onPause&&e.onPause())},e.restart=function(t){e.isRunning()||(l(),!0===t&&me.audio.resumeTrack(),h=window.performance.now()-h,me.game.repaint(),me.event.publish(me.event.STATE_RESTART,[h]),"function"==typeof e.onRestart&&e.onRestart())},e.resume=function(i){e.isPaused()&&(n&&-1!==t&&(me.timer.reset(),n=!1),!0===i&&me.audio.resumeTrack(),h=window.performance.now()-h,me.event.publish(me.event.STATE_RESUME,[h]),"function"==typeof e.onResume&&e.onResume())},e.isRunning=function(){return-1!==i},e.isPaused=function(){return n},e.set=function(e,t){if(!(t instanceof me.ScreenObject))throw new me.Error(`${t} is not an instance of me.ScreenObject`);o[e]={},o[e].screen=t,o[e].transition=!0},e.current=function(){return o[t].screen},e.transition=function(e,t,i){"fade"===e&&(r.color=t,r.duration=i)},e.setTransition=function(e,t){o[e].transition=t},e.change=function(t){if(void 0===o[t])throw new me.Error(`Undefined ScreenObject for state '${t}'`);e.isCurrent(t)||(a=null,arguments.length>1&&(a=Array.prototype.slice.call(arguments,1)),r.duration&&o[t].transition?(s=function(){me.game.viewport.fadeOut(r.color,r.duration)},me.game.viewport.fadeIn(r.color,r.duration,function(){d.defer(this,t)})):d.defer(this,t))},e.isCurrent=function(e){return t===e},e}(),function(){const e=me.Renderable.extend({init(e,t,i,n){me.Renderable.prototype.init.apply(this,[e,t,i,n]),this.invalidate=!1,this.progress=0,this.anchorPoint.set(0,0)},onProgressUpdate(e){this.progress=~~(e*this.width),this.invalidate=!0},update(){return!0===this.invalidate&&(this.invalidate=!1,!0)},draw(e){const t=e.getColor(),i=e.getHeight();e.setColor("black"),e.fillRect(this.pos.x,i/2,this.width,this.height/2),e.setColor("#55aa00"),e.fillRect(this.pos.x,i/2,this.progress,this.height/2),e.setColor(t)}}),t=me.Renderable.extend({init(e,t){me.Renderable.prototype.init.apply(this,[e,t,100,85]),this.iconCanvas=me.video.createCanvas(me.utils.nextPowerOfTwo(this.width),me.utils.nextPowerOfTwo(this.height),!1);const i=me.video.renderer.getContext2d(this.iconCanvas);i.beginPath(),i.moveTo(.7,48.9),i.bezierCurveTo(10.8,68.9,38.4,75.8,62.2,64.5),i.bezierCurveTo(86.1,53.1,97.2,27.7,87,7.7),i.lineTo(87,7.7),i.bezierCurveTo(89.9,15.4,73.9,30.2,50.5,41.4),i.bezierCurveTo(27.1,52.5,5.2,55.8,.7,48.9),i.lineTo(.7,48.9),i.closePath(),i.fillStyle="rgb(255, 255, 255)",i.fill(),i.beginPath(),i.moveTo(84,7),i.bezierCurveTo(87.6,14.7,72.5,30.2,50.2,41.6),i.bezierCurveTo(27.9,53,6.9,55.9,3.2,48.2),i.bezierCurveTo(-.5,40.4,14.6,24.9,36.9,13.5),i.bezierCurveTo(59.2,2.2,80.3,-.8,84,7),i.lineTo(84,7),i.closePath(),i.lineWidth=5.3,i.strokeStyle="rgb(255, 255, 255)",i.lineJoin="miter",i.miterLimit=4,i.stroke(),this.anchorPoint.set(.5,.5)},draw(e){e.drawImage(this.iconCanvas,this.pos.x,this.pos.y)}}),i=me.Renderable.extend({init(e,t){me.Renderable.prototype.init.apply(this,[0,0,e,t]),this.fontCanvas=me.video.createCanvas(256,64),this.drawFont(me.video.renderer.getContext2d(this.fontCanvas)),this.anchorPoint.set(0,0)},drawFont(e){const t=new me.Font("century gothic",32,"white","middle"),i=new me.Font("century gothic",32,"#55aa00","middle");let n=0;i.bold(),t.textBaseline=i.textBaseline="top",e.font=t.font,e.fillStyle=t.fillStyle.toRGBA(),e.textAlign=t.textAlign,e.textBaseline=t.textBaseline,n=e.measureText("melon").width,this.pos.x=Math.round((this.width-n-e.measureText("JS").width)/2),this.pos.y=this.height/2+16,t._drawFont(e,"melon",0,0),i._drawFont(e,"JS",n,0)},draw(e){e.drawImage(this.fontCanvas,this.pos.x,this.pos.y)}});me.DefaultLoadingScreen=me.ScreenObject.extend({onResetEvent(){me.game.world.addChild(new me.ColorLayer("background","#202020",0),0);const n=new e(0,me.video.renderer.getHeight()/2,me.video.renderer.getWidth(),8);this.loaderHdlr=me.event.subscribe(me.event.LOADER_PROGRESS,n.onProgressUpdate.bind(n)),this.resizeHdlr=me.event.subscribe(me.event.VIEWPORT_ONRESIZE,n.resize.bind(n)),me.game.world.addChild(n,1);const o=new t(me.video.renderer.getWidth()/2,me.video.renderer.getHeight()/2-n.height-35);me.game.world.addChild(o,1),me.game.world.addChild(new i(me.video.renderer.getWidth(),me.video.renderer.getHeight()),1)},onDestroyEvent(){me.event.unsubscribe(this.loaderHdlr),me.event.unsubscribe(this.resizeHdlr),this.loaderHdlr=this.resizeHdlr=null}})}(),me.loader=function(){const e={},t={},i={},n={},o={},r={};let s=0,a=0,h=0;return e.nocache="",e.onload=void 0,e.onProgress=void 0,e.crossOrigin=void 0,e.withCredentials=!1,e.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.loader.Error"}}),e.onResourceLoaded=function(t){a++;const i=e.getLoadProgress();e.onProgress&&e.onProgress(i,t),me.event.publish(me.event.LOADER_PROGRESS,[i,t])},e.onLoadingError=function(t){throw new e.Error(`Failed loading resource ${t.src}`)},e.setNocache=function(t){e.nocache=t?`?${~~(1e7*Math.random())}`:""},e.setBaseURL=function(e,t){"*"!==e?r[e]=t:(r.audio=t,r.binary=t,r.image=t,r.json=t,r.tmx=t,r.tsx=t)},e.preload=function(t,i,n){for(let i=0;i<t.length;i++)s+=e.load(t[i],e.onResourceLoaded.bind(e,t[i]),e.onLoadingError.bind(e,t[i]));void 0!==i&&(e.onload=i),!1!==n&&me.state.change(me.state.LOADING),function t(i){if(a===s)if(i||e.onload){clearTimeout(h);const t=i||e.onload;setTimeout(()=>{t(),me.event.publish(me.event.LOADER_COMPLETE)},300)}else console.error("no load callback defined");else h=setTimeout(()=>{t(i)},100)}(i)},e.load=function(s,a,h){switch(void 0!==r[s.type]&&(s.src=r[s.type]+s.src),s.type){case"binary":return function(t,i,o){const r=new XMLHttpRequest;r.open("GET",t.src+e.nocache,!0),r.withCredentials=me.loader.withCredentials,r.responseType="arraybuffer",r.onerror=o,r.onload=function(){const e=r.response;if(e){const o=new Uint8Array(e),r=[];for(let e=0;e<o.byteLength;e++)r[e]=String.fromCharCode(o[e]);n[t.name]=r.join(""),i()}},r.send()}.call(this,s,a,h),1;case"image":return function(i,n,o){t[i.name]=new Image,t[i.name].onload=n,t[i.name].onerror=o,"string"==typeof e.crossOrigin&&(t[i.name].crossOrigin=e.crossOrigin),t[i.name].src=i.src+e.nocache}.call(this,s,a,h),1;case"json":return function(t,i,n){const r=new XMLHttpRequest;r.overrideMimeType&&r.overrideMimeType("application/json"),r.open("GET",t.src+e.nocache,!0),r.withCredentials=me.loader.withCredentials,r.ontimeout=n,r.onreadystatechange=function(){4===r.readyState&&(200===r.status||0===r.status&&r.responseText?(o[t.name]=JSON.parse(r.responseText),i()):n())},r.send(null)}.call(this,s,a,h),1;case"tmx":case"tsx":return function(t,n,o){function r(e){i[t.name]=e,"tmx"===t.type&&me.levelDirector.addTMXLevel(t.name)}if(t.data)return r(t.data),void n();const s=new XMLHttpRequest,a=me.utils.getFileExtension(t.src);s.overrideMimeType&&("json"===a?s.overrideMimeType("application/json"):s.overrideMimeType("text/xml")),s.open("GET",t.src+e.nocache,!0),s.withCredentials=me.loader.withCredentials,s.ontimeout=o,s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status||0===s.status&&s.responseText){let i=null;switch(a){case"xml":case"tmx":case"tsx":if(me.device.ua.match(/msie/i)||!s.responseXML){if(!window.DOMParser)throw new e.Error("XML file format loading not supported, use the JSON file format instead");i=(new DOMParser).parseFromString(s.responseText,"text/xml")}else i=s.responseXML;var t=me.TMXUtils.parse(i);switch(a){case"tmx":i=t.map;break;case"tsx":i=t.tilesets[0]}break;case"json":i=JSON.parse(s.responseText);break;default:throw new e.Error(`TMX file format ${a}not supported !`)}r(i),n()}else o()},s.send(null)}.call(this,s,a,h),1;case"audio":return me.audio.load(s,!!s.stream,a,h),1;default:throw new e.Error(`load : unknown or invalid resource type : ${s.type}`)}},e.unload=function(r){switch(r.type){case"binary":return r.name in n&&(delete n[r.name],!0);case"image":return r.name in t&&("function"==typeof t[r.name].dispose&&t[r.name].dispose(),delete t[r.name],!0);case"json":return r.name in o&&(delete o[r.name],!0);case"tmx":case"tsx":return r.name in i&&(delete i[r.name],!0);case"audio":return me.audio.unload(r.name);default:throw new e.Error(`unload : unknown or invalid resource type : ${r.type}`)}},e.unloadAll=function(){let r;for(r in n)n.hasOwnProperty(r)&&e.unload({name:r,type:"binary"});for(r in t)t.hasOwnProperty(r)&&e.unload({name:r,type:"image"});for(r in i)i.hasOwnProperty(r)&&e.unload({name:r,type:"tmx"});for(r in o)o.hasOwnProperty(r)&&e.unload({name:r,type:"json"});me.audio.unloadAll()},e.getTMX=function(e){return(e=`${e}`)in i?i[e]:null},e.getBinary=function(e){return(e=`${e}`)in n?n[e]:null},e.getImage=function(e){return(e=`${e}`)in t?t[e]:null},e.getJSON=function(e){return(e=`${e}`)in o?o[e]:null},e.getLoadProgress=function(){return a/s},e}(),function(){const e=["ex","em","pt","px"],t=[12,24,.75,1];me.Font=me.Renderable.extend({init(e,t,i,n){this.fontSize=new me.Vector2d,this.fillStyle=(new me.Color).copy(i),this.strokeStyle=new me.Color(0,0,0),this.lineWidth=1,this.textAlign=n||"left",this.textBaseline="top",this.lineHeight=1,me.Renderable.prototype.init.apply(this,[0,0,0,0]),this.setFont(e,t,i,n),this.gid||(this.gid=me.utils.createGUID())},bold(){this.font=`bold ${this.font}`},italic(){this.font=`italic ${this.font}`},setFont(i,n,o,r){const s=i.split(",").map(e=>(e=e.trim(),/(^".*"$)|(^'.*'$)/.test(e)?e:`"${e}"`));if("number"==typeof n)this.fontSize.y=n,n+="px";else{const i=n.match(/([-+]?[\d.]*)(.*)/);this.fontSize.y=parseFloat(i[1]),i[2]?this.fontSize.y*=t[e.indexOf(i[2])]:n+="px"}this.height=this.fontSize.y,this.font=`${n} ${s.join(",")}`,void 0!==o&&this.fillStyle.copy(o),r&&(this.textAlign=r)},measureText(e,t){const i=e.getFontContext();i.font=this.font,i.fillStyle=this.fillStyle.toRGBA(),i.textAlign=this.textAlign,i.textBaseline=this.textBaseline,this.height=this.width=0;const n=`${t}`.split("\n");for(let e=0;e<n.length;e++)this.width=Math.max(i.measureText(n[e].trimRight()).width,this.width),this.height+=this.fontSize.y*this.lineHeight;return{width:this.width,height:this.height}},draw(e,t,i,n){const o=e.globalAlpha();e.setGlobalAlpha(o*this.getOpacity()),e.drawFont(this._drawFont(e.getFontContext(),t,~~i,~~n,!1)),e.setGlobalAlpha(o)},drawStroke(e,t,i,n){const o=e.globalAlpha();e.setGlobalAlpha(o*this.getOpacity()),e.drawFont(this._drawFont(e.getFontContext(),t,~~i,~~n,!0)),e.setGlobalAlpha(o)},_drawFont(e,t,i,n,o){e.font=this.font,e.fillStyle=this.fillStyle.toRGBA(),o&&(e.strokeStyle=this.strokeStyle.toRGBA(),e.lineWidth=this.lineWidth),e.textAlign=this.textAlign,e.textBaseline=this.textBaseline;let r=`${t}`.split("\n"),s="",a=0,h=n;const l=this.fontSize.y*this.lineHeight;for(let t=0;t<r.length;t++)s=r[t].trimRight(),a=Math.max(a,e.measureText(s).width),e[o?"strokeText":"fillText"](s,i,n),n+=l;const c="right"===this.textAlign?i-a:"center"===this.textAlign?i-~~(a/2):i;return h=0===this.textBaseline.search(/^(top|hanging)$/)?h:"middle"===this.textBaseline?h-~~(l/2):h-l,this.getBounds().setShape(~~c,~~h,~~(a+.5),~~(r.length*l+.5))}})}(),function(){const e=function(e,t){const i=t.split("");let n=0,o=null;for(let t=0;t<i.length;t++){const r=i[t].charCodeAt(0),s=e.bitmapFontData.glyphs[r],a=o&&o.kerning?o.getKerning(r):0;n+=(s.xadvance+a)*e.fontScale.x,o=s}return n};me.BitmapFont=me.Renderable.extend({init(e,t,i,n,o){this.sSize=me.pool.pull("me.Vector2d",0,0),this.fontImage=t,this.bitmapFontData=new me.BitmapFontData(e),this.fontScale=me.pool.pull("me.Vector2d",1,1),this.charCount=0,me.Renderable.prototype.init.apply(this,[0,0,0,0,0,0]),this.textAlign=n||"left",this.textBaseline=o||"top",this.lineHeight=1,i&&this.resize(i)},set(e,t){this.textAlign=e,t&&this.resize(t)},resize(e){this.fontScale.set(e,e)},measureText(t){const i=`${t}`.split("\n");let n=0,o=0;const r=this.bitmapFontData.capHeight*this.lineHeight;for(let t=0;t<i.length;t++)n=Math.max(e(this,i[t]),n),o+=r;return{width:n,height:o*this.fontScale.y}},draw(t,i,n,o){const r=`${i}`.split("\n"),s=n,a=this.bitmapFontData.capHeight*this.lineHeight*this.fontScale.y,h=t.globalAlpha();t.setGlobalAlpha(h*this.getOpacity()),this.pos.set(n,o,this.pos.z);for(let i=0;i<r.length;i++){n=s;const h=r[i].trimRight(),l=e(this,h);switch(this.textAlign){case"right":n-=l;break;case"center":n-=.5*l}switch(this.textBaseline){case"middle":o-=.5*a;break;case"ideographic":case"alphabetic":case"bottom":o-=a}let c=null;for(let e=0,i=h.length;e<i;e++){const i=h.charCodeAt(e),r=this.bitmapFontData.glyphs[i],s=c&&c.kerning?c.getKerning(i):0;0!==r.width&&0!==r.height&&t.drawImage(this.fontImage,r.src.x,r.src.y,r.width,r.height,n+r.offset.x,o+r.offset.y*this.fontScale.y,r.width*this.fontScale.x,r.height*this.fontScale.y),n+=(r.xadvance+s)*this.fontScale.x,c=r}o+=a}t.setGlobalAlpha(h)}})}(),me.BitmapFontData=me.Object.extend({init(e){this.padTop=0,this.padRight=0,this.padBottom=0,this.padLeft=0,this.lineHeight=0,this.capHeight=1,this.descent=0,this.scale=new me.Vector2d,this.glyphs={},this.xChars=["x","e","a","o","n","s","r","c","u","m","v","w","z"],this.capChars=["M","N","B","D","C","E","F","K","A","G","H","I","J","L","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.parse(e)},_createSpaceGlyph(){const e=" ".charCodeAt(0);let t=this.glyphs[e];t||((t=me.pool.pull("me.Glyph")).id=e,t.xadvance=this._getFirstGlyph().xadvance,this.glyphs[e]=t)},_getFirstGlyph(){const e=Object.keys(this.glyphs);for(let t=0;t<e.length;t++)if(e[t]>32)return this.glyphs[e[t]];return null},_getValueFromPair(e,t){const i=e.match(t);if(!i)throw`Could not find pattern ${t} in string: ${e}`;return i[0].split("=")[1]},parse(e){if(!e)throw"File containing font data was empty, cannot load the bitmap font.";const t=e.split(/\r\n|\n/),i=e.match(/padding\=\d+,\d+,\d+,\d+/g);if(!i)throw"Padding not found in first line";const n=i[0].split("=")[1].split(",");this.padTop=parseFloat(n[0]),this.padLeft=parseFloat(n[1]),this.padBottom=parseFloat(n[2]),this.padRight=parseFloat(n[3]),this.lineHeight=parseFloat(this._getValueFromPair(t[1],/lineHeight\=\d+/g));const o=parseFloat(this._getValueFromPair(t[1],/base\=\d+/g)),r=this.padTop+this.padBottom;let s=null;for(var a=4;a<t.length;a++){const e=t[a],i=e.split(/=|\s+/);if(e&&!/^kernings/.test(e))if(/^kerning\s/.test(e)){const e=parseFloat(i[2]),t=parseFloat(i[4]),n=parseFloat(i[6]);null!==(s=this.glyphs[e])&&void 0!==s&&s.setKerning(t,n)}else{s=me.pool.pull("me.Glyph");const e=parseFloat(i[2]);s.id=e,s.src.set(parseFloat(i[4]),parseFloat(i[6])),s.width=parseFloat(i[8]),s.height=parseFloat(i[10]);const t=parseFloat(i[14]);s.offset.set(parseFloat(i[12]),t),s.xadvance=parseFloat(i[16]),s.width>0&&s.height>0&&(this.descent=Math.min(o+s.yoffset,this.descent)),this.glyphs[e]=s}}this.descent+=this.padBottom,this._createSpaceGlyph();let h=null;for(a=0;a<this.xChars.length;a++){const e=this.xChars[a];if(h=this.glyphs[e.charCodeAt(0)])break}h||(h=this._getFirstGlyph());let l=null;for(a=0;a<this.capChars.length;a++){const e=this.capChars[a];if(l=this.glyphs[e.charCodeAt(0)])break}if(l)this.capHeight=l.height;else for(const e in this.glyphs)if(this.glyphs.hasOwnProperty(e)){if(0===(s=this.glyphs[e]).height||0===s.width)continue;this.capHeight=Math.max(this.capHeight,s.height)}this.capHeight-=r}}),me.Glyph=me.Object.extend({init(){this.src=new me.Vector2d,this.offset=new me.Vector2d,this.onResetEvent()},onResetEvent(){this.id=0,this.src.set(0,0),this.width=0,this.height=0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.offset.set(0,0),this.xadvance=0,this.fixedWidth=!1},getKerning(e){if(this.kerning){const t=this.kerning[e>>>9];if(t)return t[511&e]||0}return 0},setKerning(e,t){this.kerning||(this.kerning={});let i=this.kerning[e>>>9];void 0===i&&(this.kerning[e>>>9]={},i=this.kerning[e>>>9]),i[511&e]=t}}),me.audio=function(){const e={},t={};let i=null,n=0;return e.init=function(e){if(!me.initialized)throw new me.audio.Error("me.audio.init() called before engine initialization.");return e="string"==typeof e?e:"mp3",this.audioFormats=e.split(","),!Howler.noAudio},e.enable=function(){this.unmuteAll()},e.disable=function(){this.muteAll()},e.load=function(e,i,o,r){const s=[];if(void 0===this.audioFormats||0===this.audioFormats.length)throw new me.audio.Error("target audio extension(s) should be set through me.audio.init() before calling the preloader.");for(let t=0;t<this.audioFormats.length;t++)s.push(`${e.src+e.name}.${this.audioFormats[t]}${me.loader.nocache}`);return t[e.name]=new Howl({src:s,volume:Howler.volume(),html5:!0===i,xhrWithCredentials:me.loader.withCredentials,onloaderror(){(function(e,i){if(n++>3){const t=`melonJS: failed loading ${e}`;if(!1!==me.sys.stopOnAudioError)throw new me.audio.Error(t);me.audio.disable(),i&&i(),console.log(`${t}, disabling audio`)}else t[e].load()}).call(me.audio,e.name,r)},onload(){n=0,o&&o()}}),1},e.play=function(e,i,n,o){const r=t[e];if(r&&void 0!==r){const e=r.play();return"boolean"==typeof i&&r.loop(i,e),r.volume("number"==typeof o?o.clamp(0,1):Howler.volume(),e),"function"==typeof n&&(!0===i?r.on("end",n,e):r.once("end",n,e)),e}throw new me.audio.Error(`audio clip ${e} does not exist`)},e.fade=function(e,i,n,o,r){const s=t[e];if(!s||void 0===s)throw new me.audio.Error(`audio clip ${e} does not exist`);s.fade(i,n,o,r)},e.seek=function(e,i,n){const o=t[e];if(o&&void 0!==o)return o.seek(...Array.prototype.slice.call(arguments,1));throw new me.audio.Error(`audio clip ${e} does not exist`)},e.rate=function(e,i,n){const o=t[e];if(o&&void 0!==o)return o.rate(...Array.prototype.slice.call(arguments,1));throw new me.audio.Error(`audio clip ${e} does not exist`)},e.stop=function(e,i){const n=t[e];if(!n||void 0===n)throw new me.audio.Error(`audio clip ${e} does not exist`);n.stop(i),n.off("end",void 0,i)},e.pause=function(e,i){const n=t[e];if(!n||void 0===n)throw new me.audio.Error(`audio clip ${e} does not exist`);n.pause(i)},e.resume=function(e,i){const n=t[e];if(!n||void 0===n)throw new me.audio.Error(`audio clip ${e} does not exist`);n.play(i)},e.playTrack=function(e,t){return i=e,me.audio.play(i,!0,null,t)},e.stopTrack=function(){null!==i&&(t[i].stop(),i=null)},e.pauseTrack=function(){null!==i&&t[i].pause()},e.resumeTrack=function(){null!==i&&t[i].play()},e.getCurrentTrack=function(){return i},e.setVolume=function(e){Howler.volume(e)},e.getVolume=function(){return Howler.volume()},e.mute=function(e,i,n){n=void 0===n||!!n;const o=t[e];if(!o||void 0===o)throw new me.audio.Error(`audio clip ${e} does not exist`);o.mute(n,i)},e.unmute=function(t,i){e.mute(t,i,!1)},e.muteAll=function(){Howler.mute(!0)},e.unmuteAll=function(){Howler.mute(!1)},e.muted=function(){return Howler._muted},e.unload=function(e){return e in t&&(t[e].unload(),"function"==typeof t[e].dispose&&t[e].dispose(),delete t[e],!0)},e.unloadAll=function(){for(const i in t)t.hasOwnProperty(i)&&e.unload(i)},e}(),me.audio.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.audio.Error"}}),me.video=function(){const e={};let t=null,i=0,n=1,o=0,r=0,s=1/0,a=1/0,h={wrapper:void 0,renderer:0,doubleBuffering:!1,autoScale:!1,scale:1,scaleMethod:"fit",transparent:!1,antiAlias:!1,subPixel:!1,verbose:!1};return e.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.video.Error"}}),e._canvasOffset=null,e.CANVAS=0,e.WEBGL=1,e.AUTO=2,e.init=function(i,s,a){if(!me.initialized)throw new e.Error("me.video.init() called before engine initialization.");(h=Object.assign(h,a||{})).doubleBuffering=!!h.doubleBuffering,h.useParentDOMSize=!!h.useParentDOMSize,h.autoScale="auto"===h.scale||!1,0!==h.scaleMethod.search(/^(fill-(min|max)|fit|flex(-(width|height))?|stretch)$/)&&(h.scaleMethod="fit"),h.transparent=!!h.transparent,!0===me.game.HASH.webgl&&(h.renderer=e.WEBGL),h.scale=h.autoScale?1:+h.scale||1,me.sys.scale=new me.Vector2d(h.scale,h.scale),(h.autoScale||1!==h.scale)&&(h.doubleBuffering=!0),n=i/s,o=i,r=s;const l=i*me.sys.scale.x,c=s*me.sys.scale.y;if(h.zoomX=l,h.zoomY=c,window.addEventListener("resize",throttle(100,!1,e=>{me.event.publish(me.event.WINDOW_ONRESIZE,[e])}),!1),window.addEventListener("orientationchange",e=>{me.event.publish(me.event.WINDOW_ONORIENTATION_CHANGE,[e])},!1),window.addEventListener("onmozorientationchange",e=>{me.event.publish(me.event.WINDOW_ONORIENTATION_CHANGE,[e])},!1),void 0!==window.screen&&(window.screen.onorientationchange=function(e){me.event.publish(me.event.WINDOW_ONORIENTATION_CHANGE,[e])}),window.addEventListener("scroll",throttle(100,!1,t=>{e._canvasOffset=null,me.event.publish(me.event.WINDOW_ONSCROLL,[t])}),!1),me.event.subscribe(me.event.WINDOW_ONRESIZE,me.video.onresize.bind(me.video)),me.event.subscribe(me.event.WINDOW_ONORIENTATION_CHANGE,me.video.onresize.bind(me.video)),t=!0===me.device.ejecta?document.getElementById("canvas"):e.createCanvas(l,c,!0),a.wrapper&&(h.wrapper=document.getElementById(a.wrapper)),h.wrapper||(h.wrapper=document.body),h.wrapper.appendChild(t),!t.getContext)return!1;switch(h.renderer){case e.WEBGL:this.renderer=new me.WebGLRenderer(t,i,s,h);break;case e.AUTO:this.renderer=function(e,t,i,n){try{return new me.WebGLRenderer(e,t,i,n)}catch(o){return new me.CanvasRenderer(e,t,i,n)}}(t,i,s,h);break;default:this.renderer=new me.CanvasRenderer(t,i,s,h)}const u=me.device.getPixelRatio();if(u>1&&(t.style.width=`${t.width/u}px`,t.style.height=`${t.height/u}px`),window.getComputedStyle){const e=window.getComputedStyle(t,null);me.video.setMaxSize(parseInt(e.maxWidth,10),parseInt(e.maxHeight,10))}return me.game.init(),me.video.onresize(),!0},e.getPos=function(t){return void 0===t?(null===e._canvasOffset&&(t=this.renderer.getScreenCanvas(),e._canvasOffset=t&&t.getBoundingClientRect?t.getBoundingClientRect():{left:0,top:0}),e._canvasOffset):t.getBoundingClientRect?t.getBoundingClientRect():{left:0,top:0}},e.setMaxSize=function(e,t){s=e||1/0,a=t||1/0,this.onresize.defer(this)},e.createCanvas=function(i,n,o){if(0===i||0===n)throw new e.Error("width or height was zero, Canvas could not be initialized !");const r=document.createElement("canvas");return!0===o&&me.device.cocoon&&!0!==me.device.android2&&(r.screencanvas=!0),r.width=i||t.width,r.height=n||t.height,r},e.getWrapper=function(){return h.wrapper},e.onresize=function(){let t=1,l=1;if(e._canvasOffset=null,h.autoScale){let e,c;const u=me.video.renderer.getScreenCanvas().parentNode;if(void 0!==u)if(h.useParentDOMSize&&"function"==typeof u.getBoundingClientRect){const t=u.getBoundingClientRect();e=t.width||t.right-t.left,c=t.height||t.bottom-t.top}else e=u.width,c=u.height;const d=Math.min(s,e||window.innerWidth),p=Math.min(a,c||window.innerHeight),m=d/p;let f=1/0,g=1/0;"fill-min"===h.scaleMethod&&m>n||"fill-max"===h.scaleMethod&&m<n||"flex-width"===h.scaleMethod?(t=l=d/(f=Math.min(s,r*m)),f=~~(f+.5),this.renderer.resize(f,r),me.game.viewport.resize(f,r),me.game.world.updateChildBounds()):"fill-min"===h.scaleMethod&&m<n||"fill-max"===h.scaleMethod&&m>n||"flex-height"===h.scaleMethod?(t=l=p/(g=Math.min(a,o*(p/d))),g=~~(g+.5),this.renderer.resize(o,g),me.game.viewport.resize(o,g),me.game.world.updateChildBounds()):"flex"===h.scaleMethod?(this.renderer.resize(d,p),me.game.viewport.resize(d,p),me.game.world.updateChildBounds()):"stretch"===h.scaleMethod?(t=d/o,l=p/r):t=l=m<n?d/o:p/r,t*=me.device.getPixelRatio(),l*=me.device.getPixelRatio(),i&&clearTimeout(i),i=me.video.updateDisplaySize.defer(this,t,l)}},e.updateDisplaySize=function(t,n){e._canvasOffset=null,me.sys.scale.set(t,n),this.renderer.scaleCanvas(t,n),me.game.repaint(),i=0},e}(),me.Renderer=me.Object.extend({init(e,t,i,n){return n=n||{},this.transparent=!!n.transparent,this.doubleBuffering=!!n.doubleBuffering,this.antiAlias=!!n.antiAlias,this.subPixel=!!n.subPixel,this.verbose=!!n.verbose,this.gameWidthZoom=n.zoomX||t,this.gameHeightZoom=n.zoomY||i,this.canvas=this.backBufferCanvas=e,this.context=null,this.currentColor=new me.Color(255,255,255,1),this.uvOffset=0,this},applyRGBFilter(e,t,i){const n=this.getContext2d(me.video.createCanvas(e.width,e.height,!1)),o=me.utils.getPixels(e),r=o.data;let s,a;switch(t){case"b&w":for(s=0,a=r.length;s<a;s+=4){const e=3*r[s]+4*r[s+1]+r[s+2]>>>3;r[s]=e,r[s+1]=e,r[s+2]=e}break;case"brightness":var h=Math.abs(i).clamp(0,1);for(s=0,a=r.length;s<a;s+=4)r[s]*=h,r[s+1]*=h,r[s+2]*=h;break;case"transparent":var l=me.pool.pull("me.Color").parseCSS(i),c=me.pool.pull("me.Color");for(s=0,a=r.length;s<a;s+=4)c.setColor(r[s],r[s+1],r[s+2]),c.equals(l)&&(r[s+3]=0);me.pool.push(l),me.pool.push(c);break;default:return null}return n.putImageData(o,0,0),n},clear(){},reset(){this.resetTransform(),this.cache.reset()},getCanvas(){return this.backBufferCanvas},getScreenCanvas(){return this.canvas},getScreenContext(){return this.context},getContext2d(e,t){if(void 0===e||null===e)throw new me.video.Error("You must pass a canvas element in order to create a 2d context");if(void 0===e.getContext)throw new me.video.Error("Your browser does not support HTML5 canvas.");let i;return(i=me.device.cocoon?e.getContext("2d",{antialias:this.antiAlias,alpha:!t}):e.getContext("2d",{alpha:!t})).canvas||(i.canvas=e),this.setAntiAlias(i,this.antiAlias),i},getWidth(){return this.backBufferCanvas.width},getHeight(){return this.backBufferCanvas.height},getColor(){return this.currentColor},globalAlpha(){return this.currentColor.glArray[3]},resize(e,t){this.backBufferCanvas.width=e,this.backBufferCanvas.height=t},setAntiAlias(e,t){void 0!==e&&me.agent.setPrefixed("imageSmoothingEnabled",!0===t,e);const i=e.canvas.style["image-rendering"];!1!==t||""!==i&&"auto"!==i?!0===t&&"pixelated"===i&&(e.canvas.style["image-rendering"]="auto"):e.canvas.style["image-rendering"]="pixelated"},drawFont(){}}),me.Renderer.TextureCache=me.Object.extend({init(e){this.max_size=e||1/0,this.reset()},reset(){this.cache=new Map,this.units=new Map,this.length=0},validate(){if(this.length>=this.max_size)throw new me.video.Error(`Texture cache overflow: ${this.max_size} texture units available.`)},get(e,t){return this.cache.has(e)||(t||(t=me.video.renderer.Texture.prototype.createAtlas.apply(me.video.renderer.Texture.prototype,[e.width,e.height,e.src?me.utils.getBasename(e.src):void 0])),this.put(e,new me.video.renderer.Texture(t,e,!1))),this.cache.get(e)},put(e,t){this.validate(),this.cache.set(e,t),this.units.set(t,this.length++)},getUnit(e){return this.units.get(e)}}),me.CanvasRenderer=me.Renderer.extend({init(e,t,i,n){return me.Renderer.prototype.init.apply(this,[e,t,i,n]),this.context=this.getContext2d(this.canvas,!this.transparent),this.doubleBuffering?(this.backBufferCanvas=me.video.createCanvas(t,i,!1),this.backBufferContext2D=this.getContext2d(this.backBufferCanvas),this.transparent&&(this.context.globalCompositeOperation="copy")):(this.backBufferCanvas=this.canvas,this.backBufferContext2D=this.context),this.setColor(this.currentColor),this.cache=new me.Renderer.TextureCache,!1===n.textureSeamFix||this.antiAlias||(this.uvOffset=1),this},clear(){this.transparent&&this.clearColor("rgba(0,0,0,0)",!0)},flush(){this.doubleBuffering&&this.context.drawImage(this.backBufferCanvas,0,0,this.backBufferCanvas.width,this.backBufferCanvas.height,0,0,this.gameWidthZoom,this.gameHeightZoom)},clearColor(e,t){const i=this.backBufferContext2D,n=i.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.globalCompositeOperation=t?"copy":"source-over",i.fillStyle=e instanceof me.Color?e.toRGBA():e,i.fillRect(0,0,n.width,n.height),i.restore()},clearRect(e,t,i,n){this.backBufferContext2D.clearRect(e,t,i,n)},createPattern(e,t){return this.backBufferContext2D.createPattern(e,t)},drawImage(e,t,i,n,o,r,s,a,h){this.backBufferContext2D.globalAlpha<1/255||(!1===this.subPixel?(void 0===n?(n=a=e.width,o=h=e.height,r=t,s=i,t=0,i=0):void 0===r&&(r=t,s=i,a=n,h=o,n=e.width,o=e.height,t=0,i=0),this.backBufferContext2D.drawImage(e,t,i,n,o,~~r,~~s,a,h)):this.backBufferContext2D.drawImage.apply(this.backBufferContext2D,arguments))},drawPattern(e,t,i,n,o){if(this.backBufferContext2D.globalAlpha<1/255)return;const r=this.backBufferContext2D.fillStyle;this.backBufferContext2D.fillStyle=e,this.backBufferContext2D.fillRect(t,i,n,o),this.backBufferContext2D.fillStyle=r},fillArc(e,t,i,n,o,r){this.backBufferContext2D.globalAlpha<1/255||(this.translate(e+i,t+i),this.backBufferContext2D.beginPath(),this.backBufferContext2D.arc(0,0,i,n,o,r||!1),this.backBufferContext2D.fill(),this.backBufferContext2D.closePath(),this.translate(-(e+i),-(t+i)))},fillRect(e,t,i,n){this.backBufferContext2D.globalAlpha<1/255||this.backBufferContext2D.fillRect(e,t,i,n)},getContext(){return this.backBufferContext2D},getFontContext(){return this.getContext()},resetTransform(){this.backBufferContext2D.setTransform(1,0,0,1,0,0)},scaleCanvas(e,t){this.canvas.width=this.gameWidthZoom=this.backBufferCanvas.width*e,this.canvas.height=this.gameHeightZoom=this.backBufferCanvas.height*t,me.device.getPixelRatio()>1&&(this.canvas.style.width=`${this.canvas.width/me.device.getPixelRatio()}px`,this.canvas.style.height=`${this.canvas.height/me.device.getPixelRatio()}px`),this.doubleBuffering&&this.transparent&&(this.context.globalCompositeOperation="copy"),this.setAntiAlias(this.context,this.antiAlias),this.flush()},save(){this.backBufferContext2D.save()},restore(){this.backBufferContext2D.restore(),this.currentColor.glArray[3]=this.backBufferContext2D.globalAlpha},rotate(e){this.backBufferContext2D.rotate(e)},scale(e,t){this.backBufferContext2D.scale(e,t)},setColor(e){this.backBufferContext2D.strokeStyle=this.backBufferContext2D.fillStyle=e instanceof me.Color?e.toRGBA():e},setGlobalAlpha(e){this.backBufferContext2D.globalAlpha=this.currentColor.glArray[3]=e},setLineWidth(e){this.backBufferContext2D.lineWidth=e},strokeArc(e,t,i,n,o,r){this.backBufferContext2D.globalAlpha<1/255||(this.translate(e+i,t+i),this.backBufferContext2D.beginPath(),this.backBufferContext2D.arc(0,0,i,n,o,r||!1),this.backBufferContext2D.stroke(),this.backBufferContext2D.closePath(),this.translate(-(e+i),-(t+i)))},strokeEllipse(e,t,i,n){if(this.backBufferContext2D.globalAlpha<1/255)return;let o=e-i,r=e+i,s=t-n,a=t+n,h=.551784*i,l=.551784*n,c=e-h,u=e+h,d=t-l,p=t+l;this.backBufferContext2D.beginPath(),this.backBufferContext2D.moveTo(e,s),this.backBufferContext2D.bezierCurveTo(u,s,r,d,r,t),this.backBufferContext2D.bezierCurveTo(r,p,u,a,e,a),this.backBufferContext2D.bezierCurveTo(c,a,o,p,o,t),this.backBufferContext2D.bezierCurveTo(o,d,c,s,e,s),this.backBufferContext2D.stroke()},strokeLine(e,t,i,n){this.backBufferContext2D.globalAlpha<1/255||(this.backBufferContext2D.beginPath(),this.backBufferContext2D.moveTo(e,t),this.backBufferContext2D.lineTo(i,n),this.backBufferContext2D.stroke())},strokePolygon(e){if(this.backBufferContext2D.globalAlpha<1/255)return;let t;this.translate(e.pos.x,e.pos.y),this.backBufferContext2D.beginPath(),this.backBufferContext2D.moveTo(e.points[0].x,e.points[0].y);for(let i=1;i<e.points.length;i++)t=e.points[i],this.backBufferContext2D.lineTo(t.x,t.y);this.backBufferContext2D.lineTo(e.points[0].x,e.points[0].y),this.backBufferContext2D.stroke(),this.backBufferContext2D.closePath(),this.translate(-e.pos.x,-e.pos.y)},strokeRect(e,t,i,n){this.backBufferContext2D.globalAlpha<1/255||this.backBufferContext2D.strokeRect(e,t,i,n)},drawShape(e){"Rectangle"===e.shapeType?this.strokeRect(e.left,e.top,e.width,e.height):e instanceof me.Line||e instanceof me.Polygon?this.strokePolygon(e):e instanceof me.Ellipse&&(e.radiusV.x===e.radiusV.y?this.strokeArc(e.pos.x-e.radius,e.pos.y-e.radius,e.radius,0,2*Math.PI):this.strokeEllipse(e.pos.x,e.pos.y,e.radiusV.x,e.radiusV.y))},setTransform(e){this.resetTransform(),this.transform(e)},transform(e){const t=e.val;let i=t[6],n=t[7];!1===this.subPixel&&(i=~~i,n=~~n),this.backBufferContext2D.transform(t[0],t[1],t[3],t[4],i,n)},translate(e,t){!1===this.subPixel?this.backBufferContext2D.translate(~~e,~~t):this.backBufferContext2D.translate(e,t)}}),function(){const e=-Math.PI/2;me.CanvasRenderer.prototype.Texture=me.Object.extend({init(e,t,i){if(this.format=null,this.source=t||null,this.atlas=null,void 0!==e)if(void 0!==e.meta){if(e.meta.app.includes("texturepacker")){if(this.format="texturepacker","undefined"==typeof texture){const t=e.meta.image;if(this.source=me.utils.getImage(t),!this.source)throw new me.video.renderer.Texture.Error(`Atlas texture '${t}' not found`)}this.repeat="no-repeat"}else if(e.meta.app.includes("ShoeBox")){if(!e.meta.exporter||!e.meta.exporter.includes("melonJS"))throw new me.video.renderer.Texture.Error("ShoeBox requires the JSON exporter : https://github.com/melonjs/melonJS/tree/master/media/shoebox_JSON_export.sbx");this.format="ShoeBox",this.repeat="no-repeat"}else e.meta.app.includes("melonJS")&&(this.format="melonJS",this.repeat=e.meta.repeat||"no-repeat");this.atlas=this.parse(e)}else void 0!==e.framewidth&&void 0!==e.frameheight&&(this.format="Spritesheet (fixed cell size)",void 0!==typeof this.source&&(e.image=this.source),this.atlas=this.parseFromSpriteSheet(e),this.repeat="no-repeat");if(!this.atlas)throw new me.video.renderer.Texture.Error("texture atlas format not supported");!1!==i&&(i instanceof me.Renderer.TextureCache?i.put(this.source,this):me.video.renderer.cache.put(this.source,this))},createAtlas:(e,t,i,n)=>({meta:{app:"melonJS",size:{w:e,h:t},repeat:n||"no-repeat"},frames:[{filename:i||"default",frame:{x:0,y:0,w:e,h:t}}]}),parse(t){const i={};return t.frames.forEach(t=>{if(t.hasOwnProperty("filename")){const n=t.frame;let o,r;const s=t.spriteSourceSize&&t.sourceSize&&t.pivot;s&&(o=t.sourceSize.w*t.pivot.x-(t.trimmed?t.spriteSourceSize.x:0),r=t.sourceSize.h*t.pivot.y-(t.trimmed?t.spriteSourceSize.y:0)),i[t.filename]={name:t.filename,offset:new me.Vector2d(n.x,n.y),anchorPoint:s?new me.Vector2d(o/n.w,r/n.h):null,width:n.w,height:n.h,angle:!0===t.rotated?e:0}}}),i},parseFromSpriteSheet(e){const t={},i=e.image,n=e.spacing||0,o=e.margin||0;let r=i.width,s=i.height;const a=new me.Vector2d(~~((r-o+n)/(e.framewidth+n)),~~((s-o+n)/(e.frameheight+n)));r%(e.framewidth+n)==0&&s%(e.frameheight+n)==0||(r=a.x*(e.framewidth+n),s=a.y*(e.frameheight+n),console.warn(`Spritesheet Texture for image: ${i.src} is not divisible by ${e.framewidth+n}x${e.frameheight+n}, truncating effective size to ${r}x${s}`));for(let i=0,r=a.x*a.y;i<r;i++)t[`${i}`]={name:`${i}`,offset:new me.Vector2d(o+(n+e.framewidth)*(i%a.x),o+(n+e.frameheight)*~~(i/a.x)),anchorPoint:e.anchorPoint||null,width:e.framewidth,height:e.frameheight,angle:0};return t},getAtlas(){return this.atlas},getTexture(){return this.source},getRegion(e){return this.atlas[e]},createSpriteFromName(e,t){return me.pool.pull("me.Sprite",0,0,Object.assign({image:this,region:e},t||{}))},createAnimationFromName(e,t){let i,n=[],o={},r=0,s=0;for(let t=0;t<e.length;++t){if(null==(i=this.getRegion(e[t])))throw new me.video.renderer.Texture.Error(`Texture - region for ${e[t]} not found`);n[t]=i,o[e[t]]=t,r=Math.max(i.width,r),s=Math.max(i.height,s)}return new me.Sprite(0,0,Object.assign({image:this,framewidth:r,frameheight:s,margin:0,spacing:0,atlas:n,atlasIndices:o},t||{}))}}),me.CanvasRenderer.prototype.Texture.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.CanvasRenderer.Texture.Error"}})}(),me.video.shader=function(){const e={};function t(e,t,i){const n=e.createShader(t);if(e.shaderSource(n,i),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new me.video.Error(e.getShaderInfoLog(n));return n}const i={bool:"1i",int:"1i",float:"1f",vec2:"2fv",vec3:"3fv",vec4:"4fv",bvec2:"2iv",bvec3:"3iv",bvec4:"4iv",ivec2:"2iv",ivec3:"3iv",ivec4:"4iv",mat2:"Matrix2fv",mat3:"Matrix3fv",mat4:"Matrix4fv",sampler2D:"1i"};return e.createShader=function(e,n,o){let r,s={attributes:{},uniforms:{},handle:null},a=s.handle=e.createProgram(),h=/attribute\s+\w+\s+(\w+)/g,l=/uniform\s+(\w+)\s+(\w+)/g,c=[],u={},d={},p={};if(e.attachShader(a,t(e,e.VERTEX_SHADER,n)),e.attachShader(a,t(e,e.FRAGMENT_SHADER,o)),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new me.video.Error(e.getProgramInfoLog(a));for(e.useProgram(a);r=h.exec(n);)c.push(r[1]);var m;return[n,o].forEach(e=>{for(;r=l.exec(e);)u[r[2]]=r[1]}),c.forEach(t=>{s.attributes[t]=e.getAttribLocation(a,t),e.enableVertexAttribArray(s.attributes[t])}),Object.keys(u).forEach(t=>{const n=u[t];p[t]=e.getUniformLocation(a,t),d[t]={get:(t=t,function(){return p[t]}),set:function(t,i,n){return 0===i.indexOf("mat")?function(i){e[n](p[t],!1,i)}:function(i){let o=n;i.length&&"v"!==n.substr(-1)&&(o+="v"),e[o](p[t],i)}}(t,n,`uniform${i[n]}`)}}),Object.defineProperties(s.uniforms,d),s},e.createTexture=function(e,t,i,n,o,r,s,a){o=o||"no-repeat",me.utils.isPowerOfTwo(r||i.width)&&me.utils.isPowerOfTwo(s||i.height)||console.warn(`[WebGL Renderer] ${i} is not a POT texture `+`(${r||i.width}x${s||i.height})`);let h=e.createTexture(),l=0===o.search(/^repeat(-x)?$/)?e.REPEAT:e.CLAMP_TO_EDGE,c=0===o.search(/^repeat(-y)?$/)?e.REPEAT:e.CLAMP_TO_EDGE;return e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,h),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,l),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,c),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n),r||s||a?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r,s,a,e.RGBA,e.UNSIGNED_BYTE,i):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i),h},e}(),me.WebGLRenderer=me.Renderer.extend({init(e,t,i,n){me.Renderer.prototype.init.apply(this,[e,t,i,n]),this.gl=this.getContextGL(e,!this.transparent),this._colorStack=[],this._matrixStack=[],this._linePoints=[new me.Vector2d,new me.Vector2d,new me.Vector2d,new me.Vector2d],this.currentTransform=new me.Matrix2d;const o=n.compositor||me.WebGLRenderer.Compositor;return this.compositor=new o(this),this.cache=new me.Renderer.TextureCache(this.compositor.maxTextures),this.createFillTexture(this.cache),this.scaleCanvas(1,1),this},createFillTexture(e){const t=new Uint8Array([255,255,255,255]);this.fillTexture=new this.Texture(this.Texture.prototype.createAtlas.apply(this.Texture.prototype,[1,1,"fillTexture"]),t,e),this.compositor.uploadTexture(this.fillTexture,1,1,0)},createFontTexture(e){const t=me.video.createCanvas(me.utils.nextPowerOfTwo(this.backBufferCanvas.width),me.utils.nextPowerOfTwo(this.backBufferCanvas.height));this.fontContext2D=this.getContext2d(t),this.fontTexture=new this.Texture(this.Texture.prototype.createAtlas.apply(this.Texture.prototype,[this.backBufferCanvas.width,this.backBufferCanvas.height,"fontTexture"]),t,e),this.compositor.uploadTexture(this.fontTexture)},createPattern(e,t){if(!me.utils.isPowerOfTwo(e.width)||!me.utils.isPowerOfTwo(e.height))throw new me.video.Error(`[WebGL Renderer] ${e} is not a POT texture `+`(${e.width}x${e.height})`);const i=new this.Texture(this.Texture.prototype.createAtlas.apply(this.Texture.prototype,[e.width,e.height,"pattern",t]),e);return this.compositor.uploadTexture(i),i},flush(){this.compositor.flush()},clearColor(e,t){const i=this.currentColor.clone(),n=this.currentTransform.clone();this.currentColor.copy(e),this.currentTransform.identity(),t?this.compositor.clear():this.fillRect(0,0,this.canvas.width,this.canvas.height),this.currentTransform.copy(n),this.currentColor.copy(i),me.pool.push(i)},clearRect(e,t,i,n){const o=this.currentColor.clone();this.currentColor.copy("#0000"),this.fillRect(e,t,i,n),this.currentColor.copy(o),me.pool.push(o)},drawFont(e){const t=this.getFontContext();this.compositor.flush(),this.compositor.uploadTexture(this.fontTexture,0,0,0,!0);const i=`${e.pos.x},${e.pos.y},${e.width},${e.height}`;this.compositor.addQuad(this.fontTexture,i,e.pos.x,e.pos.y,e.width,e.height),t.clearRect(0,0,this.backBufferCanvas.width,this.backBufferCanvas.height)},drawImage(e,t,i,n,o,r,s,a,h){void 0===n?(n=a=e.width,o=h=e.height,r=t,s=i,t=0,i=0):void 0===r&&(r=t,s=i,a=n,h=o,n=e.width,o=e.height,t=0,i=0),!1===this.subPixel&&(r=~~r,s=~~s);const l=`${t},${i},${n},${o}`;this.compositor.addQuad(this.cache.get(e),l,r,s,a,h)},drawPattern(e,t,i,n,o){const r=`0,0,${n},${o}`;this.compositor.addQuad(e,r,t,i,n,o)},fillRect(e,t,i,n){this.compositor.addQuad(this.fillTexture,"default",e,t,i,n)},getScreenContext(){return this.gl},getContextGL(e,t){if(void 0===e||null===e)throw new me.video.Error("You must pass a canvas element in order to create a GL context");if(void 0===e.getContext)throw new me.video.Error("Your browser does not support WebGL.");const i={antialias:this.antiAlias,alpha:!t};return e.getContext("webgl",i)||e.getContext("experimental-webgl",i)},getContext(){return this.gl},getFontContext(){return void 0===this.fontContext2D&&(console.warn("[WebGL Renderer] WARNING : Using Standard me.Font with WebGL will severly impact performances !"),this.createFontTexture(this.cache)),this.fontContext2D},resetTransform(){this.currentTransform.identity()},reset(){this.resetTransform(),this.cache.reset(),this.compositor.reset(),this.createFillTexture(),void 0!==this.fontContext2D&&this.createFontTexture()},scaleCanvas(e,t){const i=this.canvas.width*e,n=this.canvas.height*t;me.device.getPixelRatio()>1?(this.canvas.style.width=`${i/me.device.getPixelRatio()}px`,this.canvas.style.height=`${n/me.device.getPixelRatio()}px`):(this.canvas.style.width=`${i}px`,this.canvas.style.height=`${n}px`),this.compositor.setProjection(this.canvas.width,this.canvas.height)},restore(){if(0!==this._matrixStack.length){const e=this._colorStack.pop(),t=this._matrixStack.pop();this.currentColor.copy(e),this.currentTransform.copy(t),me.pool.push(e),me.pool.push(t)}},save(){this._colorStack.push(this.currentColor.clone()),this._matrixStack.push(this.currentTransform.clone())},rotate(e){this.currentTransform.rotate(e)},scale(e,t){this.currentTransform.scale(e,t)},setAntiAlias(e,t){me.Renderer.prototype.setAntiAlias.apply(this,[e,t])},setGlobalAlpha(e){this.currentColor.glArray[3]=e},setColor(e){const t=this.currentColor.glArray[3];this.currentColor.copy(e),this.currentColor.glArray[3]*=t},setLineWidth(e){this.compositor.lineWidth(e)},strokeArc(){},strokeEllipse(){},strokeLine(e,t,i,n){const o=this._linePoints.slice(0,2);o[0].x=e,o[0].y=t,o[1].x=i,o[1].y=n,this.compositor.drawLine(o,!0)},strokePolygon(e){let t,i,n=e.points.length;for(i=this._linePoints.length;i<n;i++)this._linePoints.push(new me.Vector2d);for(t=this._linePoints.slice(0,n),i=0;i<n;i++)t[i].x=e.pos.x+e.points[i].x,t[i].y=e.pos.y+e.points[i].y;this.compositor.drawLine(t)},strokeRect(e,t,i,n){const o=this._linePoints.slice(0,4);o[0].x=e,o[0].y=t,o[1].x=e+i,o[1].y=t,o[2].x=e+i,o[2].y=t+n,o[3].x=e,o[3].y=t+n,this.compositor.drawLine(o)},drawShape(e){"Rectangle"===e.shapeType?this.strokeRect(e.left,e.top,e.width,e.height):e instanceof me.Line||e instanceof me.Polygon?this.strokePolygon(e):e instanceof me.Ellipse&&(e.radiusV.x===e.radiusV.y?this.strokeArc(e.pos.x-e.radius,e.pos.y-e.radius,e.radius,0,2*Math.PI):this.strokeEllipse(e.pos.x,e.pos.y,e.radiusV.x,e.radiusV.y))},setTransform(e){this.resetTransform(),this.transform(e)},transform(e){if(this.currentTransform.multiply(e),!1===this.subPixel){const e=this.currentTransform.val;e[6]=~~e[6],e[7]=~~e[7]}},translate(e,t){!1===this.subPixel?this.currentTransform.translate(~~e,~~t):this.currentTransform.translate(e,t)}}),me.WebGLRenderer.prototype.Texture=me.CanvasRenderer.prototype.Texture.extend({parse(e){const t=e.meta.size.w,i=e.meta.size.h,n=me.CanvasRenderer.prototype.Texture.prototype.parse.apply(this,[e]);return this._addStMap(n,t,i)},parseFromSpriteSheet(e){const t=e.image.width,i=e.image.height,n=me.CanvasRenderer.prototype.Texture.prototype.parseFromSpriteSheet.apply(this,[e]);return this._addStMap(n,t,i)},_addStMap:(e,t,i)=>(Object.keys(e).forEach(n=>{const o=e[n].offset,r=e[n].width,s=e[n].height;e[n].stMap=new Float32Array([o.x/t,o.y/i,(o.x+r)/t,(o.y+s)/i]);const a=`${o.x},${o.y},${t},${i}`;e[a]=e[n]}),e),_insertRegion(e,t,i,n,o){const r=this.source.width,s=this.source.height;return this.atlas[e]={name:e,offset:new me.Vector2d(t,i),width:n,height:o,angle:0,stMap:new Float32Array([t/r,i/s,(t+n)/r,(i+o)/s])},this.atlas[e]}}),me.WebGLRenderer.prototype.Texture.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.WebGLRenderer.Texture.Error"}}),function(){const e=9*Float32Array.BYTES_PER_ELEMENT,t=0*Float32Array.BYTES_PER_ELEMENT,i=2*Float32Array.BYTES_PER_ELEMENT,n=6*Float32Array.BYTES_PER_ELEMENT,o=7*Float32Array.BYTES_PER_ELEMENT;me.WebGLRenderer.Compositor=me.Object.extend({init(r){const s=r.gl;this.length=0,this.units=[],this.maxTextures=Math.min(24,s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS)),this.v=[new me.Vector2d,new me.Vector2d,new me.Vector2d,new me.Vector2d],this.renderer=r,this.gl=r.gl,this.matrix=r.currentTransform,this.color=r.currentColor,this.uMatrix=new me.Matrix2d;const a=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision<16?"mediump":"highp";this.lineShader=me.video.shader.createShader(this.gl,"precision highp float;attribute vec2 aVertex;uniform mat3 uMatrix;void main(void){gl_Position=vec4((uMatrix*vec3(aVertex,1)).xy,0,1);}","precision "+{precision:a}.precision+" float;uniform vec4 uColor;void main(void){gl_FragColor=uColor;}"),this.quadShader=me.video.shader.createShader(this.gl,"precision highp float;attribute vec2 aVertex;attribute vec4 aColor;attribute float aTexture;attribute vec2 aRegion;uniform mat3 uMatrix;varying vec4 vColor;varying float vTexture;varying vec2 vRegion;void main(void){gl_Position=vec4((uMatrix*vec3(aVertex,1)).xy,0,1);vColor=vec4(aColor.rgb*aColor.a,aColor.a);vTexture=aTexture;vRegion=aRegion;}",function(e){for(var t="precision "+e.precision+" float;uniform sampler2D uSampler["+e.maxTextures+"];varying vec4 vColor;varying float vTexture;varying vec2 vRegion;void main(void){int texture=int(vTexture);if(texture==0){gl_FragColor=texture2D(uSampler[0],vRegion)*vColor;}",i=1;i<e.maxTextures-1;i++)t+="else if(texture=="+i+"){gl_FragColor=texture2D(uSampler["+i+"],vRegion)*vColor;}";return t+="else{gl_FragColor=texture2D(uSampler["+(e.maxTextures-1)+"],vRegion)*vColor;}}"}({precision:a,maxTextures:this.maxTextures})),this.shader=this.quadShader.handle,this.sb=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,this.sb),s.bufferData(s.ARRAY_BUFFER,16e3*e*4,s.STREAM_DRAW),this.sbSize=256,this.sbIndex=0,this.stream=new Float32Array(9*this.sbSize*4),this.ib=s.createBuffer(),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this.ib),s.bufferData(s.ELEMENT_ARRAY_BUFFER,this.createIB(),s.STATIC_DRAW),s.vertexAttribPointer(this.quadShader.attributes.aVertex,2,s.FLOAT,!1,e,t),s.vertexAttribPointer(this.quadShader.attributes.aColor,4,s.FLOAT,!1,e,i),s.vertexAttribPointer(this.quadShader.attributes.aTexture,1,s.FLOAT,!1,e,n),s.vertexAttribPointer(this.quadShader.attributes.aRegion,2,s.FLOAT,!1,e,o),this.reset(),this.setProjection(s.canvas.width,s.canvas.height),s.clearColor(0,0,0,1),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1)},setProjection(e,t){this.flush(),this.gl.viewport(0,0,e,t),this.uMatrix.setTransform(2/e,0,0,0,-2/t,0,-1,1,1),this.quadShader.uniforms.uMatrix=this.uMatrix.val},uploadTexture(e,t,i,n,o){const r=this.renderer.cache.getUnit(e);return this.units[r]&&!o||(this.units[r]=!0,me.video.shader.createTexture(this.gl,r,e.source,this.renderer.antiAlias?this.gl.LINEAR:this.gl.NEAREST,e.repeat,t,i,n)),r},reset(){this.sbIndex=0,this.length=0;const e=[];for(let t=0;t<this.maxTextures;t++)this.units[t]=!1,e[t]=t;this.quadShader.uniforms.uSampler=e},createIB(){const e=[0,1,2,2,1,3],t=new Array(96e3);for(let i=0;i<t.length;i++)t[i]=e[i%6]+4*~~(i/6);return new Uint16Array(t)},resizeSB(){this.sbSize<<=1;const e=new Float32Array(9*this.sbSize*4);e.set(this.stream),this.stream=e},useShader(e){this.shader!==e&&(this.flush(),this.shader=e,this.gl.useProgram(this.shader))},addQuad(e,t,i,n,o,r){const s=this.color.toGL();if(s[3]<1/255)return;this.useShader(this.quadShader.handle),this.length>=16e3&&this.flush(),this.length>=this.sbSize&&this.resizeSB();let a=this.matrix,h=this.v[0].set(i,n),l=this.v[1].set(i+o,n),c=this.v[2].set(i,n+r),u=this.v[3].set(i+o,n+r);a.isIdentity()||(a.multiplyVector(h),a.multiplyVector(l),a.multiplyVector(c),a.multiplyVector(u));let d=this.sbIndex,p=d+9,m=p+9,f=m+9;this.stream[d+0+0]=h.x,this.stream[d+0+1]=h.y,this.stream[p+0+0]=l.x,this.stream[p+0+1]=l.y,this.stream[m+0+0]=c.x,this.stream[m+0+1]=c.y,this.stream[f+0+0]=u.x,this.stream[f+0+1]=u.y,this.stream.set(s,d+2),this.stream.set(s,p+2),this.stream.set(s,m+2),this.stream.set(s,f+2);const g=this.uploadTexture(e);this.stream[d+6]=this.stream[p+6]=this.stream[m+6]=this.stream[f+6]=g;let y=e.getRegion(t);if(void 0===y){!0===me.video.renderer.verbose&&console.warn("Adding texture region",t,"for texture",e);let i=t.split(","),n=+i[0],o=+i[1],r=+i[2],s=+i[3];y=e._insertRegion(t,n,o,r,s)}const v=y.stMap;this.stream[d+7+0]=v[0],this.stream[d+7+1]=v[1],this.stream[p+7+0]=v[2],this.stream[p+7+1]=v[1],this.stream[m+7+0]=v[0],this.stream[m+7+1]=v[3],this.stream[f+7+0]=v[2],this.stream[f+7+1]=v[3],this.sbIndex+=36,this.length++},flush(){if(this.length){const e=this.gl,t=9*this.length*4;e.bufferData(e.ARRAY_BUFFER,this.stream.subarray(0,t),e.STREAM_DRAW),e.drawElements(e.TRIANGLES,6*this.length,e.UNSIGNED_SHORT,0),this.sbIndex=0,this.length=0}},drawLine(r,s){this.useShader(this.lineShader.handle);let a=0;for(let e=0;e<r.length;e++)this.matrix.isIdentity()||this.matrix.multiplyVector(r[e]),this.stream[a++]=r[e].x,this.stream[a++]=r[e].y;const h=this.gl;this.lineShader.uniforms.uMatrix=this.uMatrix.val,this.lineShader.uniforms.uColor=this.color.glArray,h.bufferData(h.ARRAY_BUFFER,this.stream.subarray(0,2*r.length),h.STREAM_DRAW),h.vertexAttribPointer(this.lineShader.attributes.aVertex,2,h.FLOAT,!1,0,0),h.drawArrays(s?h.LINE_STRIP:h.LINE_LOOP,0,r.length),h.vertexAttribPointer(this.quadShader.attributes.aVertex,2,h.FLOAT,!1,e,t),h.vertexAttribPointer(this.quadShader.attributes.aColor,4,h.FLOAT,!1,e,i),h.vertexAttribPointer(this.quadShader.attributes.aTexture,1,h.FLOAT,!1,e,n),h.vertexAttribPointer(this.quadShader.attributes.aRegion,2,h.FLOAT,!1,e,o)},lineWidth(e){this.gl.lineWidth(e)},clear(){this.flush(),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}})}(),me.input=function(){const e={_preventDefaultFn:function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1,!1},preventDefault:!0};return e}(),function(e){e._KeyBinding={};const t={},i={},n={},o={},r={};let s=!1;e._enableKeyboardEvent=function(){s||(window.addEventListener("keydown",e._keydown,!1),window.addEventListener("keyup",e._keyup,!1),s=!0)},e._keydown=function(i,s,a){s=s||i.keyCode||i.button;const h=e._KeyBinding[s];if(me.event.publish(me.event.KEYDOWN,[h,s,!h||!n[h]]),h){if(!n[h]){const e=void 0!==typeof a?a:s;o[h][e]||(t[h]++,o[h][e]=!0)}return!r[s]||e._preventDefaultFn(i)}return!0},e._keyup=function(i,s,a){s=s||i.keyCode||i.button;const h=e._KeyBinding[s];if(me.event.publish(me.event.KEYUP,[h,s]),h){const l=void 0!==typeof a?a:s;return o[h][l]=void 0,t[h]>0&&t[h]--,n[h]=!1,!r[s]||e._preventDefaultFn(i)}return!0},e.KEY={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,WINDOW_KEY:91,NUMPAD0:96,NUMPAD1:97,NUMPAD2:98,NUMPAD3:99,NUMPAD4:100,NUMPAD5:101,NUMPAD6:102,NUMPAD7:103,NUMPAD8:104,NUMPAD9:105,MULTIPLY:106,ADD:107,SUBSTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,TILDE:126,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWAND_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222},e.isKeyPressed=function(e){return!(!t[e]||n[e])&&(i[e]&&(n[e]=!0),!0)},e.keyStatus=function(e){return t[e]>0},e.triggerKeyEvent=function(t,i){i?e._keydown({},t):e._keyup({},t)},e.bindKey=function(s,a,h,l){e._enableKeyboardEvent(),"boolean"!=typeof l&&(l=e.preventDefault),e._KeyBinding[s]=a,r[s]=l,t[a]=0,i[a]=h||!1,n[a]=!1,o[a]={}},e.unlockKey=function(e){n[e]=!1},e.unbindKey=function(n){const s=e._KeyBinding[n];t[s]=0,i[s]=!1,o[s]={},e._KeyBinding[n]=null,r[n]=null}}(me.input),function(){const e=new me.Vector2d;me.Pointer=me.Rect.extend({init(e,t,i,n){this.event=void 0,this.type=void 0,this.button=0,this.isPrimary=!1,this.clientX=void 0,this.clientY=void 0,this.gameX=void 0,this.gameY=void 0,this.gameScreenX=void 0,this.gameScreenY=void 0,this.gameWorldX=void 0,this.gameWorldY=void 0,this.gameLocalX=void 0,this.gameLocalY=void 0,this.pointerId=void 0,me.Rect.prototype.init.apply(this,[e||0,t||0,i||1,n||1])},setEvent(t,i,n,o){let r=1,s=1;this.event=t,this.clientX=i||0,this.clientY=n||0,me.input.globalToLocal(i,n,this.pos),this.isNormalized=!me.device.PointerEvent||me.device.PointerEvent&&!(t instanceof window.PointerEvent),"wheel"===t.type&&(this.deltaMode=1,this.deltaX=t.deltaX,this.deltaY=-.025*t.wheelDelta,t.wheelDeltaX&&(this.deltaX=-.025*t.wheelDeltaX)),this.pointerId=void 0!==o?o:1,this.isPrimary=void 0===t.isPrimary||t.isPrimary,this.button=t.button||0,this.type=t.type,this.gameScreenX=this.pos.x,this.gameScreenY=this.pos.y,me.game.viewport.localToWorld(this.gameScreenX,this.gameScreenY,e),this.gameWorldX=e.x,this.gameWorldY=e.y,!1===this.isNormalized?(r=t.width,s=t.height):"number"==typeof t.radiusX&&(r=2*t.radiusX,s=2*t.radiusY),this.resize(r,s)}})}(),function(e){const t=[],i=new Map,n=new me.Rect(0,0,1,1);let o=!1,r=0,s=[];const a=["wheel"],h=["pointermove","mousemove","touchmove"],l=["pointerdown","mousedown","touchstart"],c=["pointerup","mouseup","touchend"],u=["pointercancel","mousecancel","touchcancel"],d=["pointerenter","mouseenter","touchenter"],p=["pointerover","mouseover","touchover"],m=["pointerleave","mouseleave","touchleave"],f=[a[0],h[0],l[0],c[0],u[0],d[0],p[0],m[0]],g=[a[0],h[1],l[1],c[1],u[1],d[1],p[1],m[1]],y=[h[2],l[2],c[2],u[2],d[2],p[2],m[2]],v={wheel:a,pointermove:h,pointerdown:l,pointerup:c,pointercancel:u,pointerenter:d,pointerover:p,pointerleave:m},w=[];function b(){if(!o){for(let e=0;e<me.device.maxTouchPoints;e++)t.push(new me.Pointer);let i;s=me.device.PointerEvent?f:g,me.device.touch&&!me.device.PointerEvent&&(s=s.concat(y)),function(e,t){for(let i=0;i<e.length;i++)-1===h.indexOf(e[i])&&me.video.renderer.getScreenCanvas().addEventListener(e[i],t,!1)}(s,k),me.device.wheel||window.addEventListener("mousewheel",A,!1),void 0===e.throttlingInterval&&(e.throttlingInterval=~~(1e3/me.sys.fps));const n=E(s,h);if(e.throttlingInterval<17)for(i=0;i<n.length;i++)-1!==s.indexOf(n[i])&&me.video.renderer.getScreenCanvas().addEventListener(n[i],S,!1);else for(i=0;i<n.length;i++)-1!==s.indexOf(n[i])&&me.video.renderer.getScreenCanvas().addEventListener(n[i],throttle(e.throttlingInterval,!1,S),!1);me.input.setTouchAction(me.video.renderer.getScreenCanvas()),o=!0}}function x(e,t){for(let i=0;i<t.length;i++){if(-1!==e.indexOf(t[i]))return t[i]}}function E(e,t){const i=[];for(let n=0;n<t.length;n++){-1!==e.indexOf(t[n])&&i.push(t[n])}return i}function _(e,t,i,n){let o;if(e.callbacks[t]){e.pointerId=n;for(let n=e.callbacks[t].length-1;n>=0&&(o=e.callbacks[t][n]);n--)if(!1===o(i))return!0}return!1}function T(o){let a=!1;for(;o.length>0;){const f=o.pop();if(t.push(f),void 0!==f.event.timeStamp){if(f.event.timeStamp<r)continue;r=f.event.timeStamp}n.setShape(f.gameWorldX,f.gameWorldY,f.width,f.height);let g=me.collision.quadTree.retrieve(n,me.Container.prototype._sortReverseZ);for(var l,p=(g=g.concat([me.game.viewport])).length;l=g[--p];){if(i.has(l)&&!0!==l.isKinematic){const t=i.get(l),n=t.region,o=n.ancestor,r=n.getBounds();let p=!1;if(!0===n.floating?(f.gameX=f.gameLocalX=f.gameScreenX,f.gameY=f.gameLocalY=f.gameScreenY):(f.gameX=f.gameLocalX=f.gameWorldX,f.gameY=f.gameLocalY=f.gameWorldY),void 0!==o){const e=o.getBounds().pos;f.gameLocalX=f.gameX-e.x,f.gameLocalY=f.gameY-e.y}if(n instanceof me.Sprite){let e=f.gameX,t=f.gameY;if(!n.currentTransform.isIdentity()){const i=n.currentTransform.multiplyVectorInverse(me.pool.pull("me.Vector2d",e,t));e=i.x,t=i.y,me.pool.push(i)}p=r.containsPoint(e,t)}else p=r.containsPoint(f.gameX,f.gameY)&&(r===n||n.containsPoint(f.gameLocalX,f.gameLocalY));switch(f.type){case h[0]:case h[1]:case h[2]:case h[3]:if(t.pointerId!==f.pointerId||p){if(null===t.pointerId&&p&&_(t,x(s,d),f,f.pointerId)){a=!0;break}}else if(_(t,x(s,m),f,null)){a=!0;break}if(p&&_(t,f.type,f,f.pointerId)){a=!0;break}break;case c[0]:case c[1]:case c[2]:case c[3]:if(t.pointerId===f.pointerId&&p&&_(t,f.type,f,null)){a=!0;break}break;case u[0]:case u[1]:case u[2]:case u[3]:if(t.pointerId===f.pointerId&&_(t,f.type,f,null)){a=!0;break}break;default:if(p&&_(t,f.type,f,f.pointerId)){a=!0,"wheel"===f.type&&e._preventDefaultFn(f.event);break}}}if(!0===a)break}}return a}function C(i){let n;if(me.device.TouchEvent&&i instanceof TouchEvent)for(let e=0,o=i.changedTouches.length;e<o;e++){const o=i.changedTouches[e];(n=t.pop()).setEvent(i,o.clientX,o.clientY,o.identifier),w.push(n)}else(n=t.pop()).setEvent(i,i.clientX,i.clientY,i.pointerId),w.push(n);return!1===i.isPrimary?w:(w[0].isPrimary=!0,Object.assign(e.pointer,w[0]),w)}function A(e){return e.target!==me.video.renderer.getScreenCanvas()||(e.type="wheel",T(C(e)))}function S(e){return T(C(e)),!0}function k(t){let i=!0;C(t);const n=w[0].button;(T(w)||e.preventDefault)&&(i=e._preventDefaultFn(t));const o=e.pointer.bind[n];return o?-1!==l.indexOf(t.type)?e._keydown(t,o,n+1):e._keyup(t,o,n+1):i}e.pointer=new me.Pointer(0,0,1,1),e.pointer.bind=[0,0,0],e.pointer.LEFT=0,e.pointer.MIDDLE=1,e.pointer.RIGHT=2,e.throttlingInterval=void 0,e.globalToLocal=function(e,t,i){i=i||new me.Vector2d;const n=me.video.getPos(),o=me.device.getPixelRatio();e-=n.left,t-=n.top;const r=me.sys.scale;return 1===r.x&&1===r.y||(e/=r.x,t/=r.y),i.set(e*o,t*o)},e.setTouchAction=function(e,t){e.style["touch-action"]=t||"none"},e.bindPointer=function(){const t=arguments.length<2?e.pointer.LEFT:arguments[0],i=arguments.length<2?arguments[0]:arguments[1];if(b(),!e._KeyBinding[i])throw new me.Error(`no action defined for keycode ${i}`);e.pointer.bind[t]=i},e.unbindPointer=function(t){e.pointer.bind[void 0===t?e.pointer.LEFT:t]=null},e.registerPointerEvent=function(e,t,n){if(b(),-1===f.indexOf(e))throw new me.Error(`invalid event type : ${e}`);const o=E(s,v[e]);i.has(t)||i.set(t,{region:t,callbacks:{},pointerId:null});const r=i.get(t);for(let t=0;t<o.length;t++)e=o[t],r.callbacks[e]?r.callbacks[e].push(n):r.callbacks[e]=[n]},e.releasePointerEvent=function(e,t,n){if(-1===f.indexOf(e))throw new me.Error(`invalid event type : ${e}`);const o=E(s,v[e]),r=i.get(t);if(void 0!==r){for(let t=0;t<o.length;t++)if(e=o[t],r.callbacks[e]){if(void 0!==n)r.callbacks[e].remove(n);else for(;r.callbacks[e].length>0;)r.callbacks[e].pop();0===r.callbacks[e].length&&delete r.callbacks[e]}0===Object.keys(r.callbacks).length&&i.delete(t)}},e._translatePointerEvents=function(){e.registerPointerEvent("pointermove",me.game.viewport,e=>{me.event.publish(me.event.POINTERMOVE,[e])})}}(me.input),function(e){let t=.1;function i(e){return e}function n(t,i,n){return t=t>0?n===e.GAMEPAD.BUTTONS.L2?Math.max(0,t-2e4)/111070:(t-1)/131070:(65536+t)/131070+.5}const o=/^([0-9a-f]{1,4})-([0-9a-f]{1,4})-/i,r=/^0+/;function s(e,t){const n=e.replace(o,(e,t,i)=>`${"000".substr(t.length-1)+t}-${"000".substr(i.length-1)}${i}-`),s=e.replace(o,(e,t,i)=>`${t.replace(r,"")}-${i.replace(r,"")}-`);t.analog=t.analog||t.buttons.map(()=>-1),t.normalize_fn=t.normalize_fn||i,h.set(n,t),h.set(s,t)}const a={};var h=new Map;[["45e-28e-Xbox 360 Wired Controller",{axes:[0,1,3,4],buttons:[11,12,13,14,8,9,-1,-1,5,4,6,7,0,1,2,3,10],analog:[-1,-1,-1,-1,-1,-1,2,5,-1,-1,-1,-1,-1,-1,-1,-1,-1],normalize_fn:function(t,i,n){return n===e.GAMEPAD.BUTTONS.L2||n===e.GAMEPAD.BUTTONS.R2?(t+1)/2:t}}],["54c-268-PLAYSTATION(R)3 Controller",{axes:[0,1,2,3],buttons:[14,13,15,12,10,11,8,9,0,3,1,2,4,6,7,5,16]}],["54c-5c4-Wireless Controller",{axes:[0,1,2,3],buttons:[1,0,2,3,4,5,6,7,8,9,10,11,14,15,16,17,12,13]}],["2836-1-OUYA Game Controller",{axes:[0,3,7,9],buttons:[3,6,4,5,7,8,15,16,-1,-1,9,10,11,12,13,14,-1],analog:[-1,-1,-1,-1,-1,-1,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1],normalize_fn:n}],["OUYA Game Controller (Vendor: 2836 Product: 0001)",{axes:[0,1,3,4],buttons:[0,3,1,2,4,5,12,13,-1,-1,6,7,8,9,10,11,-1],analog:[-1,-1,-1,-1,-1,-1,2,5,-1,-1,-1,-1,-1,-1,-1,-1,-1],normalize_fn:n}]].forEach(e=>{s(e[0],e[1])}),window.addEventListener("gamepadconnected",e=>{me.event.publish(me.event.GAMEPAD_CONNECTED,[e.gamepad])},!1),window.addEventListener("gamepaddisconnected",e=>{me.event.publish(me.event.GAMEPAD_DISCONNECTED,[e.gamepad])},!1),e._updateGamepads=navigator.getGamepads?function(){const i=navigator.getGamepads(),n={};Object.keys(a).forEach(o=>{const r=i[o];if(!r)return;let s=null;"standard"!==r.mapping&&(s=h.get(r.id));const l=a[o];Object.keys(l.buttons).forEach(i=>{const a=l.buttons[i];let h=i,c=-1;if(s&&(h=s.buttons[i],c=s.analog[i],h<0&&c<0))return;let u=r.buttons[h]||{};if(s&&c>=0){const e=s.normalize_fn(r.axes[c],-1,+i);u={value:e,pressed:u.pressed||Math.abs(e)>=t}}me.event.publish(me.event.GAMEPAD_UPDATE,[o,"buttons",+i,u]),!a.pressed&&u.pressed?e._keydown(n,a.keyCode,h+256):a.pressed&&!u.pressed&&e._keyup(n,a.keyCode,h+256),a.value=u.value,a.pressed=u.pressed}),Object.keys(l.axes).forEach(i=>{const a=l.axes[i];let h=i;if(s&&(h=s.axes[i])<0)return;let c=r.axes[h];if(void 0===c)return;s&&(c=s.normalize_fn(c,+i,-1));let u=Math.sign(c)||1;if(0===a[u].keyCode)return;const d=Math.abs(c)>=t+Math.abs(a[u].threshold);me.event.publish(me.event.GAMEPAD_UPDATE,[o,"axes",+i,c]),!a[u].pressed&&d?(a[-u].pressed&&(e._keyup(n,a[-u].keyCode,h+256),a[-u].value=0,a[-u].pressed=!1),e._keydown(n,a[u].keyCode,h+256)):!a[u].pressed&&!a[-u].pressed||d||(u=a[u].pressed?u:-u,e._keyup(n,a[u].keyCode,h+256)),a[u].value=c,a[u].pressed=d})})}:function(){},e.GAMEPAD={AXES:{LX:0,LY:1,RX:2,RY:3,EXTRA_1:4,EXTRA_2:5,EXTRA_3:6,EXTRA_4:7},BUTTONS:{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L1:4,R1:5,L2:6,R2:7,SELECT:8,BACK:8,START:9,FORWARD:9,L3:10,R3:11,UP:12,DOWN:13,LEFT:14,RIGHT:15,HOME:16,EXTRA_1:17,EXTRA_2:18,EXTRA_3:19,EXTRA_4:20}},e.bindGamepad=function(t,i,n){if(!e._KeyBinding[n])throw new me.Error(`no action defined for keycode ${n}`);a[t]||(a[t]={axes:{},buttons:{}});const o={keyCode:n,value:0,pressed:!1,threshold:i.threshold},r=a[t][i.type];if("buttons"===i.type)r[i.code]=o;else if("axes"===i.type){const e=Math.sign(i.threshold)||1;r[i.code]||(r[i.code]={});const t=r[i.code];t[e]=o,t[-e]||(t[-e]={keyCode:0,value:0,pressed:!1,threshold:-e})}},e.unbindGamepad=function(e,t){if(!a[e])throw new me.Error(`no bindings for gamepad ${e}`);a[e].buttons[t]={}},e.setGamepadDeadzone=function(e){t=e},e.setGamepadMapping=s}(me.input),function(){const e=function(){const e={},t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return e.decode=function(e){if(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),me.device.nativeBase64)return window.atob(e);let i,n,o,r,s,a,h,l=[],c=0;for(;c<e.length;)i=(r=t.indexOf(e.charAt(c++)))<<2|(s=t.indexOf(e.charAt(c++)))>>4,n=(15&s)<<4|(a=t.indexOf(e.charAt(c++)))>>2,o=(3&a)<<6|(h=t.indexOf(e.charAt(c++))),l.push(String.fromCharCode(i)),64!==a&&l.push(String.fromCharCode(n)),64!==h&&l.push(String.fromCharCode(o));return l=l.join("")},e.encode=function(e){if(e=e.replace(/\r\n/g,"\n"),me.device.nativeBase64)return window.btoa(e);let i,n,o,r,s,a,h,l=[],c=0;for(;c<e.length;)r=(i=e.charCodeAt(c++))>>2,s=(3&i)<<4|(n=e.charCodeAt(c++))>>4,a=(15&n)<<2|(o=e.charCodeAt(c++))>>6,h=63&o,isNaN(n)?a=h=64:isNaN(o)&&(h=64),l.push(t.charAt(r)),l.push(t.charAt(s)),l.push(t.charAt(a)),l.push(t.charAt(h));return l=l.join("")},e}();me.utils=function(){const t={};let i="",n=0;const o=/^.*(\\|\/|\:)/,r=/\.[^\.]*$/;return t.decodeBase64=function(t){return e.decode(t)},t.encodeBase64=function(t){return e.encode(t)},t.decodeBase64AsArray=function(t,i){i=i||1;let n,o,r,s=e.decode(t);const a=new Uint32Array(s.length/i);for(n=0,r=s.length/i;n<r;n++)for(a[n]=0,o=i-1;o>=0;--o)a[n]+=s.charCodeAt(n*i+o)<<(o<<3);return a},t.decompress=function(){throw new me.Error("GZIP/ZLIB compressed TMX Tile Map not supported!")},t.decodeCSV=function(e){const t=e.replace("\n","").trim().split(","),i=[];for(let e=0;e<t.length;e++)i.push(+t[e]);return i},t.getBasename=function(e){return e.replace(o,"").replace(r,"")},t.getFileExtension=function(e){return e.substring(e.lastIndexOf(".")+1,e.length)},t.getPixels=function(e){if(e instanceof HTMLImageElement){const t=me.CanvasRenderer.getContext2d(me.video.createCanvas(e.width,e.height));return t.drawImage(e,0,0),t.getImageData(0,0,e.width,e.height)}return e.getContext("2d").getImageData(0,0,e.width,e.height)},t.getImage=function(e){return"string"==typeof e?me.loader.getImage(me.utils.getBasename(e)):e},t.resetGUID=function(e,t){i=e.toString().toUpperCase().toHex(),n=t||0},t.createGUID=function(e){return n+=e||1,`${i}-${e||n}`},t.isPowerOfTwo=function(e){return 0==(e&e-1)},t.nextPowerOfTwo=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},t}()}(),function(){const e=/^rgba?\((\d+), ?(\d+), ?(\d+)(, ?([\d\.]+))?\)$/,t=/^#([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,i=/^#([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,n=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/,o=/^#([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})([\da-fA-F]{2})$/,r=new Map;[["black",[0,0,0]],["silver",[192,192,129]],["gray",[128,128,128]],["white",[255,255,255]],["maroon",[128,0,0]],["red",[255,0,0]],["purple",[128,0,128]],["fuchsia",[255,0,255]],["green",[0,128,0]],["lime",[0,255,0]],["olive",[128,128,0]],["yellow",[255,255,0]],["navy",[0,0,128]],["blue",[0,0,255]],["teal",[0,128,128]],["aqua",[0,255,255]],["orange",[255,165,0]],["aliceblue",[240,248,245]],["antiquewhite",[250,235,215]],["aquamarine",[127,255,212]],["azure",[240,255,255]],["beige",[245,245,220]],["bisque",[255,228,196]],["blanchedalmond",[255,235,205]],["blueviolet",[138,43,226]],["brown",[165,42,42]],["burlywood",[222,184,35]],["cadetblue",[95,158,160]],["chartreuse",[127,255,0]],["chocolate",[210,105,30]],["coral",[255,127,80]],["cornflowerblue",[100,149,237]],["cornsilk",[255,248,220]],["crimson",[220,20,60]],["darkblue",[0,0,139]],["darkcyan",[0,139,139]],["darkgoldenrod",[184,134,11]],["darkgray[*]",[169,169,169]],["darkgreen",[0,100,0]],["darkgrey[*]",[169,169,169]],["darkkhaki",[189,183,107]],["darkmagenta",[139,0,139]],["darkolivegreen",[85,107,47]],["darkorange",[255,140,0]],["darkorchid",[153,50,204]],["darkred",[139,0,0]],["darksalmon",[233,150,122]],["darkseagreen",[143,188,143]],["darkslateblue",[72,61,139]],["darkslategray",[47,79,79]],["darkslategrey",[47,79,79]],["darkturquoise",[0,206,209]],["darkviolet",[148,0,211]],["deeppink",[255,20,147]],["deepskyblue",[0,191,255]],["dimgray",[105,105,105]],["dimgrey",[105,105,105]],["dodgerblue",[30,144,255]],["firebrick",[178,34,34]],["floralwhite",[255,250,240]],["forestgreen",[34,139,34]],["gainsboro",[220,220,220]],["ghostwhite",[248,248,255]],["gold",[255,215,0]],["goldenrod",[218,165,32]],["greenyellow",[173,255,47]],["grey",[128,128,128]],["honeydew",[240,255,240]],["hotpink",[255,105,180]],["indianred",[205,92,92]],["indigo",[75,0,130]],["ivory",[255,255,240]],["khaki",[240,230,140]],["lavender",[230,230,250]],["lavenderblush",[255,240,245]],["lawngreen",[124,252,0]],["lemonchiffon",[255,250,205]],["lightblue",[173,216,230]],["lightcoral",[240,128,128]],["lightcyan",[224,255,255]],["lightgoldenrodyellow",[250,250,210]],["lightgray",[211,211,211]],["lightgreen",[144,238,144]],["lightgrey",[211,211,211]],["lightpink",[255,182,193]],["lightsalmon",[255,160,122]],["lightseagreen",[32,178,170]],["lightskyblue",[135,206,250]],["lightslategray",[119,136,153]],["lightslategrey",[119,136,153]],["lightsteelblue",[176,196,222]],["lightyellow",[255,255,224]],["limegreen",[50,205,50]],["linen",[250,240,230]],["mediumaquamarine",[102,205,170]],["mediumblue",[0,0,205]],["mediumorchid",[186,85,211]],["mediumpurple",[147,112,219]],["mediumseagreen",[60,179,113]],["mediumslateblue",[123,104,238]],["mediumspringgreen",[0,250,154]],["mediumturquoise",[72,209,204]],["mediumvioletred",[199,21,133]],["midnightblue",[25,25,112]],["mintcream",[245,255,250]],["mistyrose",[255,228,225]],["moccasin",[255,228,181]],["navajowhite",[255,222,173]],["oldlace",[253,245,230]],["olivedrab",[107,142,35]],["orangered",[255,69,0]],["orchid",[218,112,214]],["palegoldenrod",[238,232,170]],["palegreen",[152,251,152]],["paleturquoise",[175,238,238]],["palevioletred",[219,112,147]],["papayawhip",[255,239,213]],["peachpuff",[255,218,185]],["peru",[205,133,63]],["pink",[255,192,203]],["plum",[221,160,221]],["powderblue",[176,224,230]],["rosybrown",[188,143,143]],["royalblue",[65,105,225]],["saddlebrown",[139,69,19]],["salmon",[250,128,114]],["sandybrown",[244,164,96]],["seagreen",[46,139,87]],["seashell",[255,245,238]],["sienna",[160,82,45]],["skyblue",[135,206,235]],["slateblue",[106,90,205]],["slategray",[112,128,144]],["slategrey",[112,128,144]],["snow",[255,250,250]],["springgreen",[0,255,127]],["steelblue",[70,130,180]],["tan",[210,180,140]],["thistle",[216,191,216]],["tomato",[255,99,71]],["turquoise",[64,224,208]],["violet",[238,130,238]],["wheat",[245,222,179]],["whitesmoke",[245,245,245]],["yellowgreen",[154,205,50]]].forEach(e=>{r.set(e[0],e[1])}),me.Color=me.Object.extend({init(e,t,i,n){return void 0===this.glArray&&(this.glArray=new Float32Array([0,0,0,1])),this.setColor(e,t,i,n)},setColor(e,t,i,n){return e instanceof me.Color?(this.glArray.set(e.glArray),e):(this.r=e,this.g=t,this.b=i,this.alpha=n,this)},clone(){return me.pool.pull("me.Color",this)},copy(e){return e instanceof me.Color?(this.glArray.set(e.glArray),this):this.parseCSS(e)},add(e){return this.glArray[0]=(this.glArray[0]+e.glArray[0]).clamp(0,1),this.glArray[1]=(this.glArray[1]+e.glArray[1]).clamp(0,1),this.glArray[2]=(this.glArray[2]+e.glArray[2]).clamp(0,1),this.glArray[3]=(this.glArray[3]+e.glArray[3])/2,this},darken(e){return e=e.clamp(0,1),this.glArray[0]*=e,this.glArray[1]*=e,this.glArray[2]*=e,this},lighten(e){return e=e.clamp(0,1),this.glArray[0]=(this.glArray[0]+(1-this.glArray[0])*e).clamp(0,1),this.glArray[1]=(this.glArray[1]+(1-this.glArray[1])*e).clamp(0,1),this.glArray[2]=(this.glArray[2]+(1-this.glArray[2])*e).clamp(0,1),this},random(){return this.setColor(256*Math.random(),256*Math.random(),256*Math.random(),this.alpha)},equals(e){return this.glArray[0]===e.glArray[0]&&this.glArray[1]===e.glArray[1]&&this.glArray[2]===e.glArray[2]&&this.glArray[3]===e.glArray[3]},parseCSS(e){return r.has(e)?this.setColor.apply(this,r.get(e)):this.parseRGB(e)},parseRGB(t){const i=e.exec(t);return i?this.setColor(+i[1],+i[2],+i[3],+i[5]):this.parseHex(t)},parseHex(e){let r;if(r=o.exec(e))return this.setColor(parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16),(parseInt(r[4],16).clamp(0,255)/255).toFixed(1));if(r=n.exec(e))return this.setColor(parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16));if(r=i.exec(e))return this.setColor(parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16),parseInt(r[3]+r[3],16),(parseInt(r[4]+r[4],16).clamp(0,255)/255).toFixed(1));if(r=t.exec(e))return this.setColor(parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16),parseInt(r[3]+r[3],16));throw new me.Color.Error(`invalid parameter: ${e}`)},toGL(){return this.glArray},toHex(){return`#${this.r.toHex()}${this.g.toHex()}${this.b.toHex()}`},toHex8(){return`#${this.r.toHex()}${this.g.toHex()}${this.b.toHex()}${this.alpha.toHex()}`},toRGB(){return`rgb(${this.r},${this.g},${this.b})`},toRGBA(){return`rgba(${this.r},${this.g},${this.b},${this.alpha})`}}),Object.defineProperty(me.Color.prototype,"r",{get(){return~~(255*this.glArray[0])},set(e){this.glArray[0]=(~~e||0).clamp(0,255)/255},enumerable:!0,configurable:!0}),Object.defineProperty(me.Color.prototype,"g",{get(){return~~(255*this.glArray[1])},set(e){this.glArray[1]=(~~e||0).clamp(0,255)/255},enumerable:!0,configurable:!0}),Object.defineProperty(me.Color.prototype,"b",{get(){return~~(255*this.glArray[2])},set(e){this.glArray[2]=(~~e||0).clamp(0,255)/255},enumerable:!0,configurable:!0}),Object.defineProperty(me.Color.prototype,"alpha",{get(){return this.glArray[3]},set(e){this.glArray[3]=void 0===e?1:(+e).clamp(0,1)},enumerable:!0,configurable:!0}),me.Color.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.Color.Error"}})}(),me.save=function(){const e={};function t(e){return"add"===e||"remove"===e}var i={_init(){!0===me.device.localStorage&&(JSON.parse(localStorage.getItem("me.save"))||[]).forEach(t=>{e[t]=JSON.parse(localStorage.getItem(`me.save.${t}`))})},add(n){var o;Object.keys(n).forEach(r=>{t(r)||(o=r,Object.defineProperty(i,o,{configurable:!0,enumerable:!0,get:()=>e[o],set(t){e[o]=t,!0===me.device.localStorage&&localStorage.setItem(`me.save.${o}`,JSON.stringify(t))}}),r in e||(i[r]=n[r]))}),!0===me.device.localStorage&&localStorage.setItem("me.save",JSON.stringify(Object.keys(e)))},remove(i){t(i)||void 0!==e[i]&&(delete e[i],!0===me.device.localStorage&&(localStorage.removeItem(`me.save.${i}`),localStorage.setItem("me.save",JSON.stringify(Object.keys(e)))))}};return i}(),function(){me.TMXUtils=function(){const api={};function setTMXValue(name,type,value){let match;if("string"!=typeof value)return value;switch(type){case"int":case"float":value=Number(value);break;case"bool":value="true"===value;break;default:if(!value||value.isBoolean())value=!value||"true"===value;else if(value.isNumeric())value=Number(value);else if(0===value.search(/^json:/i)){match=value.split(/^json:/i)[1];try{value=JSON.parse(match)}catch(e){throw new me.Error(`Unable to parse JSON: ${match}`)}}else if(0===value.search(/^eval:/i)){match=value.split(/^eval:/i)[1];try{value=eval(match)}catch(e){throw new me.Error(`Unable to evaluate: ${match}`)}}else((match=value.match(/^#([\da-fA-F])([\da-fA-F]{3})$/))||(match=value.match(/^#([\da-fA-F]{2})([\da-fA-F]{6})$/)))&&(value=`#${match[2]}${match[1]}`);0===name.search(/^(ratio|anchorPoint)$/)&&"number"==typeof value&&(value={x:value,y:value})}return value}function parseAttributes(e,t){if(t.attributes&&t.attributes.length>0)for(let i=0;i<t.attributes.length;i++){const n=t.attributes.item(i);void 0!==n.name?e[n.name]=n.value:e[n.nodeName]=n.nodeValue}}return api.decode=function(e,t,i){switch(i=i||"none",t=t||"none"){case"csv":return me.utils.decodeCSV(e);case"base64":var n=me.utils.decodeBase64AsArray(e,4);return"none"===i?n:me.utils.decompress(n,i);case"none":return e;case"xml":throw new me.Error("XML encoding is deprecated, use base64 instead");default:throw new me.Error(`Unknown layer encoding: ${t}`)}},api.normalize=function(e,t){const i=t.nodeName;switch(i){case"data":var n=api.parse(t);n.encoding=n.encoding||"xml",e.data=api.decode(n.text,n.encoding,n.compression),e.encoding="none";break;case"imagelayer":case"layer":case"objectgroup":case"group":var o=api.parse(t);o.type="layer"===i?"tilelayer":i,o.image&&(o.image=o.image.source),e.layers=e.layers||[],e.layers.push(o);break;case"animation":e.animation=api.parse(t).frames;break;case"frame":case"object":var r=`${i}s`;e[r]=e[r]||[],e[r].push(api.parse(t));break;case"tile":var s=api.parse(t);s.image&&(s.imagewidth=s.image.width,s.imageheight=s.image.height,s.image=s.image.source),e.tiles=e.tiles||{},e.tiles[s.id]=s;break;case"tileset":var a=api.parse(t);a.image&&(a.imagewidth=a.image.width,a.imageheight=a.image.height,a.image=a.image.source),e.tilesets=e.tilesets||[],e.tilesets.push(a);break;case"polygon":case"polyline":e[i]=[];for(var h,l=api.parse(t).points.split(" "),c=0;c<l.length;c++)h=l[c].split(","),e[i].push({x:+h[0],y:+h[1]});break;case"properties":e.properties=api.parse(t);break;case"property":var u=api.parse(t);e[u.name]=setTMXValue(u.name,u.type||"string",u.value);break;default:e[i]=api.parse(t)}},api.parse=function(e){const t={};let i="";if(1===e.nodeType&&parseAttributes(t,e),e.hasChildNodes())for(let n=0;n<e.childNodes.length;n++){const o=e.childNodes.item(n);switch(o.nodeType){case 1:api.normalize(t,o);break;case 3:i+=o.nodeValue.trim()}}return i&&(t.text=i),t},api.applyTMXProperties=function(e,t){const i=t.properties,n=t.propertytypes;if(void 0!==i)for(const t in i)if(i.hasOwnProperty(t)){let o="string";void 0!==n&&(o=n[t]),e[t]=setTMXValue(t,o,i[t])}},api}()}(),me.TMXGroup=me.Object.extend({init(e,t,i){this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.z=i,this.objects=[];const n=void 0===t.visible||t.visible;this.opacity=!0===n?(+t.opacity||1).clamp(0,1):0,me.TMXUtils.applyTMXProperties(this,t);const o=this;t.objects&&t.objects.forEach(t=>{o.objects.push(new me.TMXObject(e,t,i))}),t.layers&&t.layers.forEach(t=>{const n=new me.TMXLayer(e.tilewidth,e.tileheight,e.orientation,e.tilesets,i++);n.initFromJSON(t),n.setRenderer(e.getRenderer(n)),o.width=Math.max(o.width,n.width),o.height=Math.max(o.height,n.height),o.objects.push(n)})},destroy(){this.objects=null},getObjectCount(){return this.objects.length},getObjectByIndex(e){return this.objects[e]}}),me.TMXObject=me.Object.extend({init(e,t,i){if(this.points=void 0,this.name=t.name,this.x=+t.x,this.y=+t.y,this.z=+i,this.width=+t.width||0,this.height=+t.height||0,this.gid=+t.gid||null,this.type=t.type,this.rotation=Number.prototype.degToRad(+t.rotation||0),this.id=+t.id||void 0,this.orientation=e.orientation,this.shapes=void 0,this.isEllipse=!1,this.isPolygon=!1,this.isPolyLine=!1,"number"==typeof this.gid)this.setTile(e.tilesets);else if(void 0!==t.ellipse)this.isEllipse=!0;else{let e=t.polygon;if(void 0!==e?this.isPolygon=!0:void 0!==(e=t.polyline)&&(this.isPolyLine=!0),void 0!==e){this.points=[];const t=this;e.forEach(e=>{t.points.push(new me.Vector2d(e.x,e.y))})}}e.getRenderer().adjustPosition(this),me.TMXUtils.applyTMXProperties(this,t),this.shapes||(this.shapes=this.parseTMXShapes())},setTile(e){const t=e.getTilesetByGid(this.gid);!1===t.isCollection&&(this.width=this.framewidth=t.tilewidth,this.height=this.frameheight=t.tileheight),this.tile=new me.Tile(this.x,this.y,this.gid,t)},parseTMXShapes(){let e=0;const t=[];if(!0===this.isEllipse)t.push(new me.Ellipse(this.width/2,this.height/2,this.width,this.height).rotate(this.rotation));else if(!0===this.isPolygon)t.push(new me.Polygon(0,0,this.points).rotate(this.rotation));else if(!0===this.isPolyLine){const i=this.points;let n,o;const r=i.length-1;for(e=0;e<r;e++)n=i[e],o=i[e+1].clone(),0!==this.rotation&&(n=n.rotate(this.rotation),o=o.rotate(this.rotation)),t.push(new me.Line(0,0,[n,o]))}else t.push(new me.Polygon(0,0,[new me.Vector2d,new me.Vector2d(this.width,0),new me.Vector2d(this.width,this.height),new me.Vector2d(0,this.height)]).rotate(this.rotation));if("isometric"===this.orientation)for(e=0;e<t.length;e++)t[e].toIso();return t},getObjectPropertyByName(e){return this[e]}}),me.Tile=me.Rect.extend({init(e,t,i,n){let o,r;if(n.isCollection){const e=n.getTileImage(536870911&i);o=e.width,r=e.height}else o=n.tilewidth,r=n.tileheight;me.Rect.prototype.init.apply(this,[e*o,t*r,o,r]),this.tileset=n,this.currentTransform=null,this.col=e,this.row=t,this.tileId=i,this.flippedX=0!=(2147483648&this.tileId),this.flippedY=0!=(1073741824&this.tileId),this.flippedAD=0!=(536870912&this.tileId),this.flipped=this.flippedX||this.flippedY||this.flippedAD,!0===this.flipped&&this.createTransform(),this.tileId&=536870911},createTransform(){null===this.currentTransform?this.currentTransform=new me.Matrix2d:this.currentTransform.identity(),this.flippedAD&&(this.currentTransform.setTransform(0,1,0,1,0,0,0,0,1),this.currentTransform.translate(0,this.height-this.width)),this.flippedX&&(this.currentTransform.translate(this.flippedAD?0:this.width,this.flippedAD?this.height:0),this.currentTransform.scaleX(-1)),this.flippedY&&(this.currentTransform.translate(this.flippedAD?this.width:0,this.flippedAD?0:this.height),this.currentTransform.scaleY(-1))},getRenderable(e){let t;const i=this.tileset;if(i.animations.has(this.tileId)){const n=[],o=[];i.animations.get(this.tileId).frames.forEach(e=>{o.push(e.tileid),n.push({name:`${e.tileid}`,delay:e.duration})}),(t=i.texture.createAnimationFromName(o,e)).addAnimation(this.tileId-i.firstgid,n),t.setCurrentAnimation(this.tileId-i.firstgid)}else if(!0===i.isCollection){const n=i.getTileImage(this.tileId);(t=new me.Sprite(0,0,Object.assign({image:n}))).anchorPoint.set(0,0),t.scale(e.width/this.width,e.height/this.height),void 0!==e.rotation&&(t.anchorPoint.set(.5,.5),t.currentTransform.rotate(e.rotation),t.currentTransform.translate(e.width/2,e.height/2),e.rotation=void 0)}else t=i.texture.createSpriteFromName(this.tileId-i.firstgid,e);return this.flippedX&&t.currentTransform.scaleX(-1),this.flippedY&&t.currentTransform.scaleY(-1),t}}),me.TMXTileset=me.Object.extend({init(e){let t=0;if(this.TileProperties=[],this.imageCollection=[],this.firstgid=this.lastgid=+e.firstgid,void 0!==e.source){const t=e.source,i=me.utils.getFileExtension(t);if(("tsx"===i||"json"===i)&&!(e=me.loader.getTMX(me.utils.getBasename(t))))throw new me.Error(`${t} external TSX/JSON tileset not found`)}this.name=e.name,this.tilewidth=+e.tilewidth,this.tileheight=+e.tileheight,this.spacing=+e.spacing||0,this.margin=+e.margin||0,this.tileoffset=new me.Vector2d,this.isAnimated=!1,this.isCollection=!1,this.animations=new Map,this._lastUpdate=0;const i=e.tiles;for(t in i)if(i.hasOwnProperty(t)&&("animation"in i[t]&&(this.isAnimated=!0,this.animations.set(+t+this.firstgid,{dt:0,idx:0,frames:i[t].animation,cur:i[t].animation[0]})),"properties"in i[t]&&this.setTileProperty(+t+this.firstgid,i[t].properties),"image"in i[t])){const e=me.utils.getImage(i[t].image);if(!e)throw new me.TMXTileset.Error(`melonJS: '${i[t].image}' file for tile '${+t+this.firstgid}' not found!`);this.imageCollection[+t+this.firstgid]=e}this.isCollection=this.imageCollection.length>0;const n=e.tileoffset;n&&(this.tileoffset.x=+n.x,this.tileoffset.y=+n.y);const o=e.tileproperties;if(o)for(t in o)o.hasOwnProperty(t)&&this.setTileProperty(+t+this.firstgid,o[t]);if(!1===this.isCollection){if(this.image=me.utils.getImage(e.image),!this.image)throw new me.TMXTileset.Error(`melonJS: '${e.image}' file for tileset '${this.name}' not found!`);this.texture=me.video.renderer.cache.get(this.image,{framewidth:this.tilewidth,frameheight:this.tileheight,margin:this.margin,spacing:this.spacing}),this.atlas=this.texture.getAtlas();const t=+e.columns||~~(this.image.width/(this.tilewidth+this.spacing)),i=~~(this.image.height/(this.tileheight+this.spacing));this.lastgid=this.firstgid+(t*i-1||0),e.tilecount&&this.lastgid-this.firstgid+1!=+e.tilecount&&console.warn(`Computed tilecount (${this.lastgid-this.firstgid+1}) does not match expected tilecount (${e.tilecount})`)}},getTileImage(e){return this.imageCollection[e]},setTileProperty(e,t){this.TileProperties[e]=t},contains(e){return e>=this.firstgid&&e<=this.lastgid},getViewTileId(e){return this.animations.has(e)?e=this.animations.get(e).cur.tileid:e-=this.firstgid,e},getTileProperties(e){return this.TileProperties[e]},update(e){let t=0,i=me.timer.getTime(),n=!1;return this._lastUpdate!==i&&(this._lastUpdate=i,this.animations.forEach(i=>{for(i.dt+=e,t=i.cur.duration;i.dt>=t;)i.dt-=t,i.idx=(i.idx+1)%i.frames.length,i.cur=i.frames[i.idx],t=i.cur.duration,n=!0})),n},drawTile(e,t,i,n){if(n.flipped&&(e.save(),e.translate(t,i),e.transform(n.currentTransform),t=i=0),!0===this.isCollection)e.drawImage(this.imageCollection[n.tileId],0,0,n.width,n.height,t,i,n.width,n.height);else{const o=this.atlas[this.getViewTileId(n.tileId)].offset;e.drawImage(this.image,o.x,o.y,this.tilewidth,this.tileheight,t,i,this.tilewidth+e.uvOffset,this.tileheight+e.uvOffset)}n.flipped&&e.restore()}}),me.TMXTilesetGroup=me.Object.extend({init(){this.tilesets=[],this.length=0},add(e){this.tilesets.push(e),this.length++},getTilesetByIndex(e){return this.tilesets[e]},getTilesetByGid(e){let t=-1;e&=536870911;for(let i=0,n=this.tilesets.length;i<n;i++){if(this.tilesets[i].contains(e))return this.tilesets[i];this.tilesets[i].firstgid===this.tilesets[i].lastgid&&e>=this.tilesets[i].firstgid&&(t=i)}if(-1!==t)return this.tilesets[t];throw new me.Error(`no matching tileset found for gid ${e}`)}}),me.TMXTileset.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.TMXTileset.Error"}}),function(){const e=[{x:0,y:0},{x:1,y:-1},{x:1,y:0},{x:2,y:0}],t=[{x:0,y:0},{x:-1,y:1},{x:0,y:1},{x:0,y:2}];me.TMXRenderer=me.Object.extend({init(e,t,i,n){this.cols=e,this.rows=t,this.tilewidth=i,this.tileheight=n},canRender(e){return this.cols===e.cols&&this.rows===e.rows&&this.tilewidth===e.tilewidth&&this.tileheight===e.tileheight},pixelToTileCoords:(e,t,i)=>i,tileToPixelCoords:(e,t,i)=>i,pixelToTileX(e){},pixelToTileY(e){},drawTile(e,t,i,n){},drawTileLayer(e,t,i){}}),me.TMXOrthogonalRenderer=me.TMXRenderer.extend({canRender(e){return"orthogonal"===e.orientation&&me.TMXRenderer.prototype.canRender.apply(this,[e])},pixelToTileCoords(e,t,i){return(i||new me.Vector2d).set(this.pixelToTileX(e),this.pixelToTileY(t))},pixelToTileX(e){return e/this.tilewidth},pixelToTileY(e){return e/this.tileheight},tileToPixelCoords(e,t,i){return(i||new me.Vector2d).set(e*this.tilewidth,t*this.tileheight)},adjustPosition(e){"number"==typeof e.gid&&(e.y-=e.height)},drawTile(e,t,i,n){const o=n.tileset;o.drawTile(e,o.tileoffset.x+t*this.tilewidth,o.tileoffset.y+(i+1)*this.tileheight-o.tileheight,n)},drawTileLayer(e,t,i){const n=this.pixelToTileCoords(Math.max(i.pos.x-(t.maxTileSize.width-t.tilewidth),0),Math.max(i.pos.y-(t.maxTileSize.height-t.tileheight),0),me.pool.pull("me.Vector2d")).floorSelf(),o=this.pixelToTileCoords(i.pos.x+i.width+this.tilewidth,i.pos.y+i.height+this.tileheight,me.pool.pull("me.Vector2d")).ceilSelf();o.x=o.x>this.cols?this.cols:o.x,o.y=o.y>this.rows?this.rows:o.y;for(let i=n.y;i<o.y;i++)for(let r=n.x;r<o.x;r++){const n=t.layerData[r][i];n&&this.drawTile(e,r,i,n)}me.pool.push(n),me.pool.push(o)}}),me.TMXIsometricRenderer=me.TMXRenderer.extend({init(e,t,i,n){me.TMXRenderer.prototype.init.apply(this,[e,t,i,n]),this.hTilewidth=i/2,this.hTileheight=n/2,this.originX=this.rows*this.hTilewidth},canRender(e){return"isometric"===e.orientation&&me.TMXRenderer.prototype.canRender.apply(this,[e])},pixelToTileCoords(e,t,i){return(i||new me.Vector2d).set(this.pixelToTileX(e,t),this.pixelToTileY(t,e))},pixelToTileX(e,t){return t/this.tileheight+(e-this.originX)/this.tilewidth},pixelToTileY(e,t){return e/this.tileheight-(t-this.originX)/this.tilewidth},tileToPixelCoords(e,t,i){return(i||new me.Vector2d).set((e-t)*this.hTilewidth+this.originX,(e+t)*this.hTileheight)},adjustPosition(e){const t=e.x/this.hTilewidth,i=e.y/this.tileheight,n=me.pool.pull("me.Vector2d");this.tileToPixelCoords(t,i,n),e.x=n.x,e.y=n.y,me.pool.push(n)},drawTile(e,t,i,n){const o=n.tileset;o.drawTile(e,(this.cols-1)*o.tilewidth+(t-i)*o.tilewidth>>1,-o.tilewidth+(t+i)*o.tileheight>>2,n)},drawTileLayer(e,t,i){let n=t.tileset,o=n.tileoffset;const r=this.pixelToTileCoords(i.pos.x-n.tilewidth,i.pos.y-n.tileheight,me.pool.pull("me.Vector2d")).floorSelf(),s=this.pixelToTileCoords(i.pos.x+i.width+n.tilewidth,i.pos.y+i.height+n.tileheight,me.pool.pull("me.Vector2d")).ceilSelf(),a=this.tileToPixelCoords(s.x,s.y,me.pool.pull("me.Vector2d")),h=this.tileToPixelCoords(r.x,r.y,me.pool.pull("me.Vector2d"));h.x-=this.hTilewidth,h.y+=this.tileheight;const l=h.y-i.pos.y>this.hTileheight,c=i.pos.x-h.x<this.hTilewidth;l&&(c?(r.x--,h.x-=this.hTilewidth):(r.y--,h.x+=this.hTilewidth),h.y-=this.hTileheight);let u=l^c;const d=r.clone();for(let i=2*h.y;i-2*this.tileheight<2*a.y;i+=this.tileheight){d.setV(r);for(let r=h.x;r<a.x;r+=this.tilewidth){if(d.x>=0&&d.y>=0&&d.x<this.cols&&d.y<this.rows){const s=t.layerData[d.x][d.y];s&&(o=(n=s.tileset).tileoffset,n.drawTile(e,o.x+r,o.y+i/2-n.tileheight,s))}d.x++,d.y--}u?(r.y++,h.x-=this.hTilewidth,u=!1):(r.x++,h.x+=this.hTilewidth,u=!0)}me.pool.push(r),me.pool.push(s),me.pool.push(a),me.pool.push(h)}}),me.TMXHexagonalRenderer=me.TMXRenderer.extend({init(e,t,i,n,o,r,s){me.TMXRenderer.prototype.init.apply(this,[e,t,i,n]),this.hexsidelength=o,this.staggeraxis=r,this.staggerindex=s,this.sidelengthx=0,this.sidelengthy=0,"x"===r?this.sidelengthx=o:this.sidelengthy=o,this.sideoffsetx=(this.tilewidth-this.sidelengthx)/2,this.sideoffsety=(this.tileheight-this.sidelengthy)/2,this.columnwidth=this.sideoffsetx+this.sidelengthx,this.rowheight=this.sideoffsety+this.sidelengthy,this.centers=[new me.Vector2d,new me.Vector2d,new me.Vector2d,new me.Vector2d]},canRender(e){return"hexagonal"===e.orientation&&me.TMXRenderer.prototype.canRender.apply(this,[e])},pixelToTileCoords(i,n,o){let r,s;const a=o||new me.Vector2d;"x"===this.staggeraxis?i-="odd"===this.staggerindex?this.sideoffsetx:this.tilewidth:n-="odd"===this.staggerindex?this.sideoffsety:this.tileheight;const h=me.pool.pull("me.Vector2d",Math.floor(i/(2*this.columnwidth)),Math.floor(n/(2*this.rowheight))),l=me.pool.pull("me.Vector2d",i-h.x*(2*this.columnwidth),n-h.y*(2*this.rowheight));let c,u,d,p;"x"===this.staggeraxis?(h.x*=2,"even"===this.staggerindex&&++h.x):(h.y*=2,"even"===this.staggerindex&&++h.y),"x"===this.staggeraxis?(d=(c=this.sidelengthx/2)+this.columnwidth,p=this.tileheight/2,this.centers[0].set(c,p),this.centers[1].set(d,p-this.rowheight),this.centers[2].set(d,p+this.rowheight),this.centers[3].set(d+this.columnwidth,p)):(u=this.sidelengthy/2,d=this.tilewidth/2,p=u+this.rowheight,this.centers[0].set(d,u),this.centers[1].set(d-this.columnwidth,p),this.centers[2].set(d+this.columnwidth,p),this.centers[3].set(d,p+this.rowheight));let m,f=0,g=Number.MAX_VALUE;for(let e=0;e<4;++e)(m=Math.pow(this.centers[e].x-l.x,2)+Math.pow(this.centers[e].y-l.y,2))<g&&(g=m,f=e);const y="x"===this.staggeraxis?e:t;return r=h.x+y[f].x,s=h.y+y[f].y,me.pool.push(h),me.pool.push(l),a.set(r,s)},pixelToTileX(e,t){const i=me.pool.pull("me.Vector2d");return this.pixelToTileCoords(e,t,i),me.pool.push(i),i.x},pixelToTileY(e,t){const i=me.pool.pull("me.Vector2d");return this.pixelToTileCoords(t,e,i),me.pool.push(i),i.y},tileToPixelCoords(e,t,i){let n,o;const r=i||new me.Vector2d;return"x"===this.staggeraxis?(n=e*this.columnwidth,"odd"===this.staggerindex?(o=t*(this.tileheight+this.sidelengthy),o+=this.rowheight*(1&e)):(o=t*(this.tileheight+this.sidelengthy),o+=this.rowheight*(1-(1&e)))):(o=t*this.rowheight,"odd"===this.staggerindex?(n=e*(this.tilewidth+this.sidelengthx),n+=this.columnwidth*(1&t)):(n=e*(this.tilewidth+this.sidelengthx),n+=this.columnwidth*(1-(1&t)))),r.set(n,o)},adjustPosition(e){"number"==typeof e.gid&&(e.y-=e.height)},drawTile(e,t,i,n){const o=n.tileset,r=this.tileToPixelCoords(t,i,me.pool.pull("me.Vector2d"));o.drawTile(e,o.tileoffset.x+r.x,o.tileoffset.y+r.y+(this.tileheight-o.tileheight),n),me.pool.push(r)},drawTileLayer(e,t,i){const n=this.pixelToTileCoords(i.pos.x,i.pos.y).floorSelf(),o=this.pixelToTileCoords(i.pos.x+i.width+this.tilewidth,i.pos.y+i.height+this.tileheight).ceilSelf();n.x=n.x<0?0:n.x,n.y=n.y<0?0:n.y,o.x=o.x>this.cols?this.cols:o.x,o.y=o.y>this.rows?this.rows:o.y;for(let i=n.y;i<o.y;i++)for(let r=n.x;r<o.x;r++){const n=t.layerData[r][i];n&&this.drawTile(e,r,i,n)}}})}(),function(){me.TMXLayer=me.Renderable.extend({init(e,t,i,n,o){me.Renderable.prototype.init.apply(this,[0,0,0,0]),this.tilewidth=e,this.tileheight=t,this.orientation=i,this.tilesets=n,this.tileset=this.tilesets?this.tilesets.getTilesetByIndex(0):null,this.maxTileSize={width:0,height:0};for(let e=0;e<this.tilesets.length;e++){const t=this.tilesets.getTilesetByIndex(e);this.maxTileSize.width=Math.max(this.maxTileSize.width,t.tilewidth),this.maxTileSize.height=Math.max(this.maxTileSize.height,t.tileheight)}this.animatedTilesets=[],this.isAnimated=!1,this.pos.z=o,this.anchorPoint.set(0,0)},initFromJSON(e){this.name=e.name,this.cols=+e.width,this.rows=+e.height,this.hexsidelength=+e.hexsidelength||void 0,this.staggeraxis=e.staggeraxis,this.staggerindex=e.staggerindex;const t=void 0!==e.visible?+e.visible:1;this.setOpacity(t?+e.opacity:0),"isometric"===this.orientation?(this.width=(this.cols+this.rows)*(this.tilewidth/2),this.height=(this.cols+this.rows)*(this.tileheight/2)):(this.width=this.cols*this.tilewidth,this.height=this.rows*this.tileheight),me.TMXUtils.applyTMXProperties(this,e),void 0===this.preRender&&(this.preRender=me.sys.preRender),!0===this.preRender&&(this.canvasRenderer=new me.CanvasRenderer(me.video.createCanvas(this.width,this.height),this.width,this.height,{transparent:!0})),this.initArray(this.cols,this.rows),function(e,t){let i=0;for(let n=0;n<e.rows;n++)for(let o=0;o<e.cols;o++){const r=t[i++];0!==r&&e.setTile(o,n,r)}}(this,me.TMXUtils.decode(e.data,e.encoding,e.compression))},onActivateEvent(){if(void 0===this.animatedTilesets&&(this.animatedTilesets=[]),this.tilesets){const e=this.tilesets.tilesets;for(let t=0;t<e.length;t++)e[t].isAnimated&&this.animatedTilesets.push(e[t])}this.isAnimated=this.animatedTilesets.length>0,this.isAnimated&&(this.preRender=!1),this.getBounds().resize(this.width,this.height)},onDeactivateEvent(){this.animatedTilesets=void 0},setRenderer(e){this.renderer=e},getRenderer(e){return this.renderer},initArray(e,t){this.layerData=[];for(let i=0;i<e;i++){this.layerData[i]=[];for(let e=0;e<t;e++)this.layerData[i][e]=null}},getTileId(e,t){const i=this.getTile(e,t);return i?i.tileId:null},getTile(e,t){if(this.containsPoint(e,t)){const i=this.renderer,n=~~i.pixelToTileX(e,t),o=~~i.pixelToTileY(t,e);if(n>=0&&n<i.cols&&o>=0&&o<i.rows)return this.layerData[n][o]}return null},setTile(e,t,i){this.tileset.contains(i)||(this.tileset=this.tilesets.getTilesetByGid(i));const n=this.layerData[e][t]=new me.Tile(e,t,i,this.tileset);return this.preRender&&this.renderer.drawTile(this.canvasRenderer,e,t,n),n},clearTile(e,t){this.layerData[e][t]=null,this.preRender&&this.canvasRenderer.clearRect(e*this.tilewidth,t*this.tileheight,this.tilewidth,this.tileheight)},update(e){if(this.isAnimated){let t=!1;for(let i=0;i<this.animatedTilesets.length;i++)t=this.animatedTilesets[i].update(e)||t;return t}return!1},draw(e,t){if(this.preRender){const i=Math.min(t.width,this.width),n=Math.min(t.height,this.height);e.drawImage(this.canvasRenderer.getCanvas(),t.pos.x,t.pos.y,i,n,t.pos.x,t.pos.y,i,n)}else this.renderer.drawTileLayer(e,this,t)}})}(),function(){function e(e){switch(e.orientation){case"orthogonal":return new me.TMXOrthogonalRenderer(e.cols,e.rows,e.tilewidth,e.tileheight);case"isometric":return new me.TMXIsometricRenderer(e.cols,e.rows,e.tilewidth,e.tileheight);case"hexagonal":return new me.TMXHexagonalRenderer(e.cols,e.rows,e.tilewidth,e.tileheight,e.hexsidelength,e.staggeraxis,e.staggerindex);default:throw new me.Error(`${e.orientation} type TMX Tile Map not supported!`)}}function t(e,t,i){return new me.TMXGroup(e,t,i)}me.TMXTileMap=me.Object.extend({init(e,t){this.name=e,this.data=t,this.cols=+t.width,this.rows=+t.height,this.tilewidth=+t.tilewidth,this.tileheight=+t.tileheight,this.tilesets=null,this.layers=[],this.objectGroups=[],this.version=t.version,this.orientation=t.orientation,"isometric"===this.orientation?(this.width=(this.cols+this.rows)*(this.tilewidth/2),this.height=(this.cols+this.rows)*(this.tileheight/2)):(this.width=this.cols*this.tilewidth,this.height=this.rows*this.tileheight),this.z=0,this.nextobjectid=+t.nextobjectid||void 0,this.hexsidelength=+t.hexsidelength||void 0,this.staggeraxis=t.staggeraxis,this.staggerindex=t.staggerindex,this.backgroundcolor=t.backgroundcolor,me.TMXUtils.applyTMXProperties(this,t),this.initialized=!1},getRenderer(t){return void 0!==this.renderer&&this.renderer.canRender(this)||(this.renderer=e(this)),void 0===t||this.renderer.canRender(t)?this.renderer:e(t)},readMapObjects(e){if(!0===this.initialized)return;let i=this.z;const n=this;if(this.tilesets||(this.tilesets=new me.TMXTilesetGroup),void 0!==e.tilesets){e.tilesets.forEach(e=>{n.tilesets.add(function(e){return new me.TMXTileset(e)}(e))})}this.backgroundcolor&&this.layers.push(new me.ColorLayer("background_color",this.backgroundcolor,i++)),this.background_image&&this.layers.push(new me.ImageLayer(0,0,{name:"background_image",image:this.background_image,z:i++})),e.layers.forEach(e=>{switch(e.type){case"imagelayer":n.layers.push(function(e,t,i){me.TMXUtils.applyTMXProperties(t.properties,t);const n=new me.ImageLayer(+t.x||0,+t.y||0,Object.assign({name:t.name,image:t.image,z:i},t.properties)),o=void 0===t.visible||t.visible;return n.setOpacity(o?+t.opacity:0),n}(0,e,i++));break;case"tilelayer":n.layers.push(function(e,t,i){const n=new me.TMXLayer(e.tilewidth,e.tileheight,e.orientation,e.tilesets,i);return n.initFromJSON(t),n.setRenderer(e.getRenderer(n)),n}(n,e,i++));break;case"objectgroup":case"group":n.objectGroups.push(t(n,e,i++))}}),this.initialized=!0},addTo(e,t){const i=e.autoSort,n=e.autoDepth;e.autoSort=!1,e.autoDepth=!1,this.getLayers().forEach(t=>{e.addChild(t)}),this.getObjects(t).forEach(t=>{e.addChild(t)}),e.autoSort=i,e.autoDepth=n,e.sort(!0)},getObjects(e){const t=[];let i,n=!1;this.readMapObjects(this.data);for(let r=0;r<this.objectGroups.length;r++){const s=this.objectGroups[r];n=s.name.toLowerCase().includes("collision"),!1===e&&((i=new me.Container(0,0,this.width,this.height)).anchorPoint.set(0,0),i.name=s.name,i.pos.z=s.z,i.setOpacity(s.opacity),i.autoSort=!1,i.autoDepth=!1);for(let r=0;r<s.objects.length;r++){const a=s.objects[r];var o;if(void 0===a.anchorPoint&&(a.anchorPoint={x:0,y:0}),a instanceof me.TMXLayer?o=a:(o=me.pool.pull(a.name||"me.Entity",a.x,a.y,a)).pos.z=a.z,"object"==typeof a.tile&&!o.renderable)switch(o.renderable=a.tile.getRenderable(a),a.rotation){case Math.PI:o.translate(-o.renderable.width,o.renderable.height);break;case Math.PI/2:o.translate(0,o.renderable.height);break;case-Math.PI/2:o.translate(-o.renderable.width,0)}n&&!a.name&&(o.body.collisionType=me.collision.types.WORLD_SHAPE),!0===e?(!0===o.isRenderable&&(o.setOpacity(o.getOpacity()*s.opacity),o.renderable instanceof me.Renderable&&o.renderable.setOpacity(o.renderable.getOpacity()*s.opacity)),t.push(o)):i.addChild(o)}!1===e&&i.children.length>0&&(i.autoSort=!0,i.autoDepth=!0,t.push(i))}return t},getLayers(){return this.readMapObjects(this.data),this.layers},destroy(){this.tilesets=void 0,this.layers=[],this.objectGroups=[],this.initialized=!1}})}(),me.levelDirector=function(){const e={},t={},i=[];let n=0,o=null;function r(r,s,a){s.container.destroy(),me.video.renderer.reset(),t[e.getCurrentLevelId()]&&t[e.getCurrentLevelId()].destroy(),n=i.indexOf(r),function(e,i,n,r){const s=t[e],a=i.autoSort;function h(){i.pos.set(Math.max(0,~~((me.game.viewport.width-s.width)/2)),Math.max(0,~~((me.game.viewport.height-s.height)/2)),0)}i.autoSort=!1,r&&me.game.viewport.setBounds(0,0,Math.max(s.width,me.game.viewport.width),Math.max(s.height,me.game.viewport.height)),me.utils.resetGUID(e,s.nextobjectid),i.anchorPoint.set(0,0),s.addTo(i,n),i.sort(!0),i.autoSort=a,i.resize(s.width,s.height),r&&(h(),o&&me.event.unsubscribe(o),o=me.event.subscribe(me.event.VIEWPORT_ONRESIZE,h))}(r,s.container,s.flatten,s.setViewportBounds),me.event.publish(me.event.LEVEL_LOADED,[r]),s.onLoaded(r),a&&me.state.restart()}return e.reset=function(){},e.addLevel=function(){throw new me.Error("no level loader defined")},e.addTMXLevel=function(e,n){return null==t[e]&&(t[e]=new me.TMXTileMap(e,me.loader.getTMX(e)),i.push(e),n&&n(),!0)},e.loadLevel=function(e,i){if(i=Object.assign({container:me.game.world,onLoaded:me.game.onLevelLoaded,flatten:me.game.mergeGroup,setViewportBounds:!0},i||{}),void 0===t[e])throw new me.Error(`level ${e} not found`);if(!(t[e]instanceof me.TMXTileMap))throw new me.Error("no level loader defined");return me.state.isRunning()?(me.state.stop(),r.defer(this,e,i,!0)):r(e,i),!0},e.getCurrentLevelId=function(){return i[n]},e.getCurrentLevel=function(){return t[e.getCurrentLevelId()]},e.reloadLevel=function(t){return e.loadLevel(e.getCurrentLevelId(),t)},e.nextLevel=function(t){return n+1<i.length&&e.loadLevel(i[n+1],t)},e.previousLevel=function(t){return n-1>=0&&e.loadLevel(i[n-1],t)},e.levelCount=function(){return i.length},e}(),me.Tween=function(e){let t=null,i=null,n=null,o=null,r=null,s=null,a=null,h=null,l=null,c=null,u=null,d=null,p=null,m=null,f=null,g=null,y=null,v=null;this.isRenderable=!1,this._resumeCallback=function(e){c&&(c+=e)},this.setProperties=function(e){t=e,i={},n={},o={},r=1e3,s=0,a=!1,h=!1,l=0,c=null,u=me.Tween.Easing.Linear.None,d=me.Tween.Interpolation.Linear,p=[],m=null,f=!1,g=null,y=null,v=me.timer.lastUpdate,this.isPersistent=!1,this.updateWhenPaused=!1;for(const t in e)"object"!=typeof e&&(i[t]=parseFloat(e[t],10))},this.setProperties(e),this.onResetEvent=function(e){this.setProperties(e)},this.onActivateEvent=function(){me.event.subscribe(me.event.STATE_RESUME,this._resumeCallback)},this.onDeactivateEvent=function(){me.event.unsubscribe(me.event.STATE_RESUME,this._resumeCallback)},this.to=function(e,t){return void 0!==t&&(r=t),n=e,this},this.start=function(e){f=!1,me.game.world.addChild(this),c=(void 0===e?me.timer.getTime():e)+l;for(const e in n){if(n[e]instanceof Array){if(0===n[e].length)continue;n[e]=[t[e]].concat(n[e])}i[e]=t[e],i[e]instanceof Array==0&&(i[e]*=1),o[e]=i[e]||0}return this},this.stop=function(){return me.game.world.removeChildNow(this),this},this.delay=function(e){return l=e,this},this.repeat=function(e){return s=e,this},this.yoyo=function(e){return a=e,this},this.easing=function(e){if("function"!=typeof e)throw new me.Tween.Error("invalid easing function for me.Tween.easing()");return u=e,this},this.interpolation=function(e){return d=e,this},this.chain=function(){return p=arguments,this},this.onStart=function(e){return m=e,this},this.onUpdate=function(e){return g=e,this},this.onComplete=function(e){return y=e,this},this.update=function(e){const w=v=me.timer.lastUpdate>v?me.timer.lastUpdate:v+e;let b;if(w<c)return!0;!1===f&&(null!==m&&m.call(t),f=!0);let x=(w-c)/r;const E=u(x=x>1?1:x);for(b in n){const e=i[b]||0;let o=n[b];o instanceof Array?t[b]=d(o,E):("string"==typeof o&&(o=e+parseFloat(o,10)),"number"==typeof o&&(t[b]=e+(o-e)*E))}if(null!==g&&g.call(t,E),1===x){if(s>0){for(b in isFinite(s)&&s--,o){if("string"==typeof n[b]&&(o[b]=o[b]+parseFloat(n[b],10)),a){const e=o[b];o[b]=n[b],n[b]=e}i[b]=o[b]}return a&&(h=!h),c=w+l,!0}me.game.world.removeChildNow(this),null!==y&&y.call(t);for(let e=0,t=p.length;e<t;e++)p[e].start(w);return!1}return!0}},me.Tween.Easing={Linear:{None:e=>e},Quadratic:{In:e=>e*e,Out:e=>e*(2-e),InOut:e=>(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},Cubic:{In:e=>e*e*e,Out:e=>--e*e*e+1,InOut:e=>(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},Quartic:{In:e=>e*e*e*e,Out:e=>1- --e*e*e*e,InOut:e=>(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},Quintic:{In:e=>e*e*e*e*e,Out:e=>--e*e*e*e*e+1,InOut:e=>(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},Sinusoidal:{In:e=>1-Math.cos(e*Math.PI/2),Out:e=>Math.sin(e*Math.PI/2),InOut:e=>.5*(1-Math.cos(Math.PI*e))},Exponential:{In:e=>0===e?0:Math.pow(1024,e-1),Out:e=>1===e?1:1-Math.pow(2,-10*e),InOut:e=>0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},Circular:{In:e=>1-Math.sqrt(1-e*e),Out:e=>Math.sqrt(1- --e*e),InOut:e=>(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},Elastic:{In(e){let t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},Out(e){let t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},InOut(e){let t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),(e*=2)<1?i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)}},Back:{In(e){const t=1.70158;return e*e*((t+1)*e-t)},Out(e){const t=1.70158;return--e*e*((t+1)*e+t)+1},InOut(e){const t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:e=>1-me.Tween.Easing.Bounce.Out(1-e),Out:e=>e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,InOut:e=>e<.5?.5*me.Tween.Easing.Bounce.In(2*e):.5*me.Tween.Easing.Bounce.Out(2*e-1)+.5}},me.Tween.Interpolation={Linear(e,t){let i=e.length-1,n=i*t,o=Math.floor(n),r=me.Tween.Interpolation.Utils.Linear;return t<0?r(e[0],e[1],n):t>1?r(e[i],e[i-1],i-n):r(e[o],e[o+1>i?i:o+1],n-o)},Bezier(e,t){let i,n=0,o=e.length-1,r=Math.pow,s=me.Tween.Interpolation.Utils.Bernstein;for(i=0;i<=o;i++)n+=r(1-t,o-i)*r(t,i)*e[i]*s(o,i);return n},CatmullRom(e,t){let i=e.length-1,n=i*t,o=Math.floor(n),r=me.Tween.Interpolation.Utils.CatmullRom;return e[0]===e[i]?(t<0&&(o=Math.floor(n=i*(1+t))),r(e[(o-1+i)%i],e[o],e[(o+1)%i],e[(o+2)%i],n-o)):t<0?e[0]-(r(e[0],e[0],e[1],e[1],-n)-e[0]):t>1?e[i]-(r(e[i],e[i],e[i-1],e[i-1],n-i)-e[i]):r(e[o?o-1:0],e[o],e[i<o+1?i:o+1],e[i<o+2?i:o+2],n-o)},Utils:{Linear:(e,t,i)=>(t-e)*i+e,Bernstein(e,t){const i=me.Tween.Interpolation.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:function(){const e=[1];return function(t){let i,n=1;if(e[t])return e[t];for(i=t;i>1;i--)n*=i;return e[t]=n}}(),CatmullRom(e,t,i,n,o){let r=.5*(i-e),s=.5*(n-t),a=o*o;return(2*t-2*i+r+s)*(o*a)+(-3*t+3*i-2*r-s)*a+r*o+t}}},me.Tween.Error=me.Error.extend({init(e){me.Error.prototype.init.apply(this,[e]),this.name="me.Tween.Error"}}),me.event=function(){const e={},t={};return e.STATE_PAUSE="me.state.onPause",e.STATE_RESUME="me.state.onResume",e.STATE_STOP="me.state.onStop",e.STATE_RESTART="me.state.onRestart",e.GAME_INIT="me.game.onInit",e.GAME_RESET="me.game.onReset",e.LEVEL_LOADED="me.game.onLevelLoaded",e.LOADER_COMPLETE="me.loader.onload",e.LOADER_PROGRESS="me.loader.onProgress",e.KEYDOWN="me.input.keydown",e.KEYUP="me.input.keyup",e.GAMEPAD_CONNECTED="gamepad.connected",e.GAMEPAD_DISCONNECTED="gamepad.disconnected",e.GAMEPAD_UPDATE="gamepad.update",e.POINTERMOVE="me.event.pointermove",e.DRAGSTART="me.game.dragstart",e.DRAGEND="me.game.dragend",e.WINDOW_ONRESIZE="window.onresize",e.VIEWPORT_ONRESIZE="viewport.onresize",e.WINDOW_ONORIENTATION_CHANGE="window.orientationchange",e.WINDOW_ONSCROLL="window.onscroll",e.VIEWPORT_ONCHANGE="viewport.onchange",e.publish=function(e,i){let n=t[e],o=n?n.length:0;for(;o--;)n[o].apply(window,i||[])},e.subscribe=function(e,i){return t[e]||(t[e]=[]),t[e].push(i),[e,i]},e.unsubscribe=function(e,i){let n=t[i?e:e[0]],o=n?n.length:0;for(i=i||e[1];o--;)n[o]===i&&n.splice(o,1)},e}(),function(){"use strict";const e=function(){this.init()};e.prototype={init(){const e=this||t;return e._counter=1e3,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.mobileAutoEnable=!0,e._setup(),e},volume(e){const i=this||t;if(e=parseFloat(e),i.ctx||l(),void 0!==e&&e>=0&&e<=1){if(i._volume=e,i._muted)return i;i.usingWebAudio&&i.masterGain.gain.setValueAtTime(e,t.ctx.currentTime);for(let t=0;t<i._howls.length;t++)if(!i._howls[t]._webAudio){const n=i._howls[t]._getSoundIds();for(let o=0;o<n.length;o++){const r=i._howls[t]._soundById(n[o]);r&&r._node&&(r._node.volume=r._volume*e)}}return i}return i._volume},mute(e){const i=this||t;i.ctx||l(),i._muted=e,i.usingWebAudio&&i.masterGain.gain.setValueAtTime(e?0:i._volume,t.ctx.currentTime);for(let t=0;t<i._howls.length;t++)if(!i._howls[t]._webAudio){const n=i._howls[t]._getSoundIds();for(let o=0;o<n.length;o++){const r=i._howls[t]._soundById(n[o]);r&&r._node&&(r._node.muted=!!e||r._muted)}}return i},unload(){const e=this||t;for(let t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,l()),e},codecs(e){return(this||t)._codecs[e.replace(/^x-/,"")]},_setup(){const e=this||t;if(e.state=e.ctx&&e.ctx.state||"running",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs(){const e=this||t;let i=null;try{i="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!i||"function"!=typeof i.canPlayType)return e;const n=i.canPlayType("audio/mpeg;").replace(/^no$/,""),o=e._navigator&&e._navigator.userAgent.match(/OPR\/([0-6].)/g),r=o&&parseInt(o[0].split("/")[1],10)<33;return e._codecs={mp3:!(r||!n&&!i.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!i.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_enableMobileAudio(){const e=this||t,i=/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(e._navigator&&e._navigator.userAgent),n=!!("ontouchend"in window||e._navigator&&e._navigator.maxTouchPoints>0||e._navigator&&e._navigator.msMaxTouchPoints>0);if(!e._mobileEnabled&&e.ctx&&(i||n)){e._mobileEnabled=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var o=function(){t._autoResume();const i=e.ctx.createBufferSource();i.buffer=e._scratchBuffer,i.connect(e.ctx.destination),void 0===i.start?i.noteOn(0):i.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),i.onended=function(){i.disconnect(0),e._mobileEnabled=!0,e.mobileAutoEnable=!1,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0)}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),e}},_autoSuspend(){const e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&t.usingWebAudio){for(let t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(let i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(()=>{e.autoSuspend&&(e._suspendTimer=null,e.state="suspending",e.ctx.suspend().then(()=>{e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())}))},3e4),e}},_autoResume(){const e=this;if(e.ctx&&void 0!==e.ctx.resume&&t.usingWebAudio)return"running"===e.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state?(e.ctx.resume().then(()=>{e.state="running";for(let t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var t=new e;const i=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};i.prototype={init(e){const i=this;return t.ctx||l(),i._autoplay=e.autoplay||!1,i._format="string"!=typeof e.format?e.format:[e.format],i._html5=e.html5||!1,i._muted=e.mute||!1,i._loop=e.loop||!1,i._pool=e.pool||5,i._preload="boolean"!=typeof e.preload||e.preload,i._rate=e.rate||1,i._sprite=e.sprite||{},i._src="string"!=typeof e.src?e.src:[e.src],i._volume=void 0!==e.volume?e.volume:1,i._xhrWithCredentials=e.xhrWithCredentials||!1,i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._playLock=!1,i._onend=e.onend?[{fn:e.onend}]:[],i._onfade=e.onfade?[{fn:e.onfade}]:[],i._onload=e.onload?[{fn:e.onload}]:[],i._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],i._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],i._onpause=e.onpause?[{fn:e.onpause}]:[],i._onplay=e.onplay?[{fn:e.onplay}]:[],i._onstop=e.onstop?[{fn:e.onstop}]:[],i._onmute=e.onmute?[{fn:e.onmute}]:[],i._onvolume=e.onvolume?[{fn:e.onvolume}]:[],i._onrate=e.onrate?[{fn:e.onrate}]:[],i._onseek=e.onseek?[{fn:e.onseek}]:[],i._onresume=[],i._webAudio=t.usingWebAudio&&!i._html5,void 0!==t.ctx&&t.ctx&&t.mobileAutoEnable&&t._enableMobileAudio(),t._howls.push(i),i._autoplay&&i._queue.push({event:"play",action(){i.play()}}),i._preload&&i.load(),i},load(){const e=this;let i=null;if(t.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(let n=0;n<e._src.length;n++){var o,s;if(e._format&&e._format[n])o=e._format[n];else{if("string"!=typeof(s=e._src[n])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(o=/^data:audio\/([^;,]+);/i.exec(s))||(o=/\.([^.]+)$/.exec(s.split("?",1)[0])),o&&(o=o[1].toLowerCase())}if(o||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),o&&t.codecs(o)){i=e._src[n];break}}if(i)return e._src=i,e._state="loading","https:"===window.location.protocol&&"http:"===i.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new n(e),e._webAudio&&r(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play(e,i){const n=this;let o=null;if("number"==typeof e)o=e,e=null;else{if("string"==typeof e&&"loaded"===n._state&&!n._sprite[e])return null;if(void 0===e){e="__default";let t=0;for(let e=0;e<n._sounds.length;e++)n._sounds[e]._paused&&!n._sounds[e]._ended&&(t++,o=n._sounds[e]._id);1===t?e=null:o=null}}const r=o?n._soundById(o):n._inactiveSound();if(!r)return null;if(o&&!e&&(e=r._sprite||"__default"),"loaded"!==n._state){r._sprite=e,r._ended=!1;const t=r._id;return n._queue.push({event:"play",action(){n.play(t)}}),t}if(o&&!r._paused)return i||setTimeout(()=>{n._emit("play",r._id)},0),r._id;n._webAudio&&t._autoResume();const s=Math.max(0,r._seek>0?r._seek:n._sprite[e][0]/1e3),a=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-s),h=1e3*a/Math.abs(r._rate);r._paused=!1,r._ended=!1,r._sprite=e,r._seek=s,r._start=n._sprite[e][0]/1e3,r._stop=(n._sprite[e][0]+n._sprite[e][1])/1e3,r._loop=!(!r._loop&&!n._sprite[e][2]);const l=r._node;if(n._webAudio){const e=function(){n._refreshBuffer(r);const e=r._muted||n._muted?0:r._volume;l.gain.setValueAtTime(e,t.ctx.currentTime),r._playStart=t.ctx.currentTime,void 0===l.bufferSource.start?r._loop?l.bufferSource.noteGrainOn(0,s,86400):l.bufferSource.noteGrainOn(0,s,a):r._loop?l.bufferSource.start(0,s,86400):l.bufferSource.start(0,s,a),h!==1/0&&(n._endTimers[r._id]=setTimeout(n._ended.bind(n,r),h)),i||setTimeout(()=>{n._emit("play",r._id)},0)};"running"===t.state?e():(n.once("resume",e),n._clearTimer(r._id))}else{const e=function(){l.currentTime=s,l.muted=r._muted||n._muted||t._muted||l.muted,l.volume=r._volume*t.volume(),l.playbackRate=r._rate;try{const e=l.play();if("undefined"!=typeof Promise&&e instanceof Promise&&(n._playLock=!0,e.then(()=>{n._playLock=!1,n._loadQueue()})),l.paused)return void n._emit("playerror",r._id,"Playback was unable to start. This is most commonly an issue on mobile devices where playback was not within a user interaction.");h!==1/0&&(n._endTimers[r._id]=setTimeout(n._ended.bind(n,r),h)),i||n._emit("play",r._id)}catch(e){n._emit("playerror",r._id,e)}},o=window&&window.ejecta||!l.readyState&&t._navigator.isCocoonJS;if(4===l.readyState||o)e();else{var c=function(){e(),l.removeEventListener(t._canPlayEvent,c,!1)};l.addEventListener(t._canPlayEvent,c,!1),n._clearTimer(r._id)}}return r._id},pause(e){const t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action(){t.pause(e)}}),t;const i=t._getSoundIds(e);for(let e=0;e<i.length;e++){t._clearTimer(i[e]);const n=t._soundById(i[e]);if(n&&!n._paused&&(n._seek=t.seek(i[e]),n._rateSeek=0,n._paused=!0,t._stopFade(i[e]),n._node))if(t._webAudio){if(!n._node.bufferSource)continue;void 0===n._node.bufferSource.stop?n._node.bufferSource.noteOff(0):n._node.bufferSource.stop(0),t._cleanBuffer(n._node)}else isNaN(n._node.duration)&&n._node.duration!==1/0||n._node.pause();arguments[1]||t._emit("pause",n?n._id:null)}return t},stop(e,t){const i=this;if("loaded"!==i._state)return i._queue.push({event:"stop",action(){i.stop(e)}}),i;const n=i._getSoundIds(e);for(let e=0;e<n.length;e++){i._clearTimer(n[e]);const o=i._soundById(n[e]);o&&(o._seek=o._start||0,o._rateSeek=0,o._paused=!0,o._ended=!0,i._stopFade(n[e]),o._node&&(i._webAudio?o._node.bufferSource&&(void 0===o._node.bufferSource.stop?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),i._cleanBuffer(o._node)):isNaN(o._node.duration)&&o._node.duration!==1/0||(o._node.currentTime=o._start||0,o._node.pause())),t||i._emit("stop",o._id))}return i},mute(e,i){const n=this;if("loaded"!==n._state)return n._queue.push({event:"mute",action(){n.mute(e,i)}}),n;if(void 0===i){if("boolean"!=typeof e)return n._muted;n._muted=e}const o=n._getSoundIds(i);for(let i=0;i<o.length;i++){const r=n._soundById(o[i]);r&&(r._muted=e,r._interval&&n._stopFade(r._id),n._webAudio&&r._node?r._node.gain.setValueAtTime(e?0:r._volume,t.ctx.currentTime):r._node&&(r._node.muted=!!t._muted||e),n._emit("mute",r._id))}return n},volume(){const e=this,i=arguments;let n,o,r;if(0===i.length)return e._volume;if(1===i.length||2===i.length&&void 0===i[1]){e._getSoundIds().indexOf(i[0])>=0?o=parseInt(i[0],10):n=parseFloat(i[0])}else i.length>=2&&(n=parseFloat(i[0]),o=parseInt(i[1],10));if(!(void 0!==n&&n>=0&&n<=1))return(r=o?e._soundById(o):e._sounds[0])?r._volume:0;if("loaded"!==e._state)return e._queue.push({event:"volume",action(){e.volume(...i)}}),e;void 0===o&&(e._volume=n),o=e._getSoundIds(o);for(let s=0;s<o.length;s++)(r=e._soundById(o[s]))&&(r._volume=n,i[2]||e._stopFade(o[s]),e._webAudio&&r._node&&!r._muted?r._node.gain.setValueAtTime(n,t.ctx.currentTime):r._node&&!r._muted&&(r._node.volume=n*t.volume()),e._emit("volume",r._id));return e},fade(e,i,n,o){const r=this;if("loaded"!==r._state)return r._queue.push({event:"fade",action(){r.fade(e,i,n,o)}}),r;r.volume(e,o);const s=r._getSoundIds(o);for(let a=0;a<s.length;a++){const h=r._soundById(s[a]);if(h){if(o||r._stopFade(s[a]),r._webAudio&&!h._muted){const o=t.ctx.currentTime,r=o+n/1e3;h._volume=e,h._node.gain.setValueAtTime(e,o),h._node.gain.linearRampToValueAtTime(i,r)}r._startFadeInterval(h,e,i,n,s[a],void 0===o)}}return r},_startFadeInterval(e,t,i,n,o,r){const s=this;let a=t;const h=i-t,l=Math.abs(h/.01),c=Math.max(4,l>0?n/l:n);let u=Date.now();e._fadeTo=i,e._interval=setInterval(()=>{const o=(Date.now()-u)/n;u=Date.now(),a+=h*o,a=Math.max(0,a),a=Math.min(1,a),a=Math.round(100*a)/100,s._webAudio?e._volume=a:s.volume(a,e._id,!0),r&&(s._volume=a),(i<t&&a<=i||i>t&&a>=i)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,s.volume(i,e._id),s._emit("fade",e._id))},c)},_stopFade(e){const i=this,n=i._soundById(e);return n&&n._interval&&(i._webAudio&&n._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(n._interval),n._interval=null,i.volume(n._fadeTo,e),n._fadeTo=null,i._emit("fade",e)),i},loop(){const e=this,t=arguments;let i,n,o;if(0===t.length)return e._loop;if(1===t.length){if("boolean"!=typeof t[0])return!!(o=e._soundById(parseInt(t[0],10)))&&o._loop;i=t[0],e._loop=i}else 2===t.length&&(i=t[0],n=parseInt(t[1],10));const r=e._getSoundIds(n);for(let t=0;t<r.length;t++)(o=e._soundById(r[t]))&&(o._loop=i,e._webAudio&&o._node&&o._node.bufferSource&&(o._node.bufferSource.loop=i,i&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop)));return e},rate(){const e=this,i=arguments;let n,o,r;if(0===i.length)o=e._sounds[0]._id;else if(1===i.length){e._getSoundIds().indexOf(i[0])>=0?o=parseInt(i[0],10):n=parseFloat(i[0])}else 2===i.length&&(n=parseFloat(i[0]),o=parseInt(i[1],10));if("number"!=typeof n)return(r=e._soundById(o))?r._rate:e._rate;if("loaded"!==e._state)return e._queue.push({event:"rate",action(){e.rate(...i)}}),e;void 0===o&&(e._rate=n),o=e._getSoundIds(o);for(let i=0;i<o.length;i++)if(r=e._soundById(o[i])){r._rateSeek=e.seek(o[i]),r._playStart=e._webAudio?t.ctx.currentTime:r._playStart,r._rate=n,e._webAudio&&r._node&&r._node.bufferSource?r._node.bufferSource.playbackRate.setValueAtTime(n,t.ctx.currentTime):r._node&&(r._node.playbackRate=n);const s=e.seek(o[i]),a=1e3*((e._sprite[r._sprite][0]+e._sprite[r._sprite][1])/1e3-s)/Math.abs(r._rate);!e._endTimers[o[i]]&&r._paused||(e._clearTimer(o[i]),e._endTimers[o[i]]=setTimeout(e._ended.bind(e,r),a)),e._emit("rate",r._id)}return e},seek(){const e=this,i=arguments;let n,o;if(0===i.length)o=e._sounds[0]._id;else if(1===i.length){e._getSoundIds().indexOf(i[0])>=0?o=parseInt(i[0],10):e._sounds.length&&(o=e._sounds[0]._id,n=parseFloat(i[0]))}else 2===i.length&&(n=parseFloat(i[0]),o=parseInt(i[1],10));if(void 0===o)return e;if("loaded"!==e._state)return e._queue.push({event:"seek",action(){e.seek(...i)}}),e;const r=e._soundById(o);if(r){if(!("number"==typeof n&&n>=0)){if(e._webAudio){const i=e.playing(o)?t.ctx.currentTime-r._playStart:0,n=r._rateSeek?r._rateSeek-r._seek:0;return r._seek+(n+i*Math.abs(r._rate))}return r._node.currentTime}{const t=e.playing(o);t&&e.pause(o,!0),r._seek=n,r._ended=!1,e._clearTimer(o),t&&e.play(o,!0),!e._webAudio&&r._node&&(r._node.currentTime=n),e._emit("seek",o)}}return e},playing(e){const t=this;if("number"==typeof e){const i=t._soundById(e);return!!i&&!i._paused}for(let e=0;e<t._sounds.length;e++)if(!t._sounds[e]._paused)return!0;return!1},duration(e){const t=this;let i=t._duration;const n=t._soundById(e);return n&&(i=t._sprite[n._sprite][1]/1e3),i},state(){return this._state},unload(){let e=this;const i=e._sounds;for(var n=0;n<i.length;n++){if(i[n]._paused||e.stop(i[n]._id),!e._webAudio){/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent)||(i[n]._node.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),i[n]._node.removeEventListener("error",i[n]._errorFn,!1),i[n]._node.removeEventListener(t._canPlayEvent,i[n]._loadFn,!1)}delete i[n]._node,e._clearTimer(i[n]._id);const o=t._howls.indexOf(e);o>=0&&t._howls.splice(o,1)}let r=!0;for(n=0;n<t._howls.length;n++)if(t._howls[n]._src===e._src){r=!1;break}return o&&r&&delete o[e._src],t.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on(e,t,i,n){const o=this[`_on${e}`];return"function"==typeof t&&o.push(n?{id:i,fn:t,once:n}:{id:i,fn:t}),this},off(e,t,i){const n=this,o=n[`_on${e}`];let r=0;if("number"==typeof t&&(i=t,t=null),t||i)for(r=0;r<o.length;r++){const e=i===o[r].id;if(t===o[r].fn&&e||!t&&e){o.splice(r,1);break}}else if(e)n[`_on${e}`]=[];else{const e=Object.keys(n);for(r=0;r<e.length;r++)0===e[r].indexOf("_on")&&Array.isArray(n[e[r]])&&(n[e[r]]=[])}return n},once(e,t,i){return this.on(e,t,i,1),this},_emit(e,t,i){const n=this,o=n[`_on${e}`];for(let r=o.length-1;r>=0;r--)o[r].id&&o[r].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,i)}.bind(n,o[r].fn),0),o[r].once&&n.off(e,o[r].fn,o[r].id));return n},_loadQueue(){const e=this;if(e._queue.length>0){const t=e._queue[0];e.once(t.event,()=>{e._queue.shift(),e._loadQueue()}),t.action()}return e},_ended(e){const i=this,n=e._sprite;if(!i._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(i._ended.bind(i,e),100),i;const o=!(!e._loop&&!i._sprite[n][2]);if(i._emit("end",e._id),!i._webAudio&&o&&i.stop(e._id,!0).play(e._id),i._webAudio&&o){i._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=t.ctx.currentTime;const n=1e3*(e._stop-e._start)/Math.abs(e._rate);i._endTimers[e._id]=setTimeout(i._ended.bind(i,e),n)}return i._webAudio&&!o&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,i._clearTimer(e._id),i._cleanBuffer(e._node),t._autoSuspend()),i._webAudio||o||i.stop(e._id),i},_clearTimer(e){const t=this;return t._endTimers[e]&&(clearTimeout(t._endTimers[e]),delete t._endTimers[e]),t},_soundById(e){const t=this;for(let i=0;i<t._sounds.length;i++)if(e===t._sounds[i]._id)return t._sounds[i];return null},_inactiveSound(){const e=this;e._drain();for(let t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new n(e)},_drain(){const e=this,t=e._pool;let i=0,n=0;if(!(e._sounds.length<t)){for(n=0;n<e._sounds.length;n++)e._sounds[n]._ended&&i++;for(n=e._sounds.length-1;n>=0;n--){if(i<=t)return;e._sounds[n]._ended&&(e._webAudio&&e._sounds[n]._node&&e._sounds[n]._node.disconnect(0),e._sounds.splice(n,1),i--)}}},_getSoundIds(e){const t=this;if(void 0===e){const e=[];for(let i=0;i<t._sounds.length;i++)e.push(t._sounds[i]._id);return e}return[e]},_refreshBuffer(e){return e._node.bufferSource=t.ctx.createBufferSource(),e._node.bufferSource.buffer=o[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,t.ctx.currentTime),this},_cleanBuffer(e){if(t._scratchBuffer){e.bufferSource.onended=null,e.bufferSource.disconnect(0);try{e.bufferSource.buffer=t._scratchBuffer}catch(e){}}return e.bufferSource=null,this}};var n=function(e){this._parent=e,this.init()};n.prototype={init(){const e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++t._counter,e._sounds.push(this),this.create(),this},create(){const e=this,i=e._parent,n=t._muted||e._muted||e._parent._muted?0:e._volume;return i._webAudio?(e._node=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),e._node.gain.setValueAtTime(n,t.ctx.currentTime),e._node.paused=!0,e._node.connect(t.masterGain)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(t._canPlayEvent,e._loadFn,!1),e._node.src=i._src,e._node.preload="auto",e._node.volume=n*t.volume(),e._node.load()),e},reset(){const e=this._parent;return this._muted=e._muted,this._loop=e._loop,this._volume=e._volume,this._rate=e._rate,this._seek=0,this._rateSeek=0,this._paused=!0,this._ended=!0,this._sprite="__default",this._id=++t._counter,this},_errorListener(){this._parent._emit("loaderror",this._id,this._node.error?this._node.error.code:0),this._node.removeEventListener("error",this._errorFn,!1)},_loadListener(){const e=this._parent;e._duration=Math.ceil(10*this._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),this._node.removeEventListener(t._canPlayEvent,this._loadFn,!1)}};var o={},r=function(e){const t=e._src;if(o[t])return e._duration=o[t].duration,void h(e);if(/^data:[^;]+;base64,/.test(t)){const i=atob(t.split(",")[1]),n=new Uint8Array(i.length);for(let e=0;e<i.length;++e)n[e]=i.charCodeAt(e);a(n.buffer,e)}else{const i=new XMLHttpRequest;i.open("GET",t,!0),i.withCredentials=e._xhrWithCredentials,i.responseType="arraybuffer",i.onload=function(){const t=`${i.status}`[0];"0"===t||"2"===t||"3"===t?a(i.response,e):e._emit("loaderror",null,`Failed loading audio file with status: ${i.status}.`)},i.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete o[t],e.load())},s(i)}},s=function(e){try{e.send()}catch(t){e.onerror()}},a=function(e,i){t.ctx.decodeAudioData(e,e=>{e&&i._sounds.length>0&&(o[i._src]=e,h(i,e))},()=>{i._emit("loaderror",null,"Decoding audio data failed.")})},h=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},l=function(){try{"undefined"!=typeof AudioContext?t.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch(e){t.usingWebAudio=!1}const e=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),i=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=i?parseInt(i[1],10):null;if(e&&n&&n<9){const e=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());(t._navigator&&t._navigator.standalone&&!e||t._navigator&&!t._navigator.standalone&&!e)&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=void 0===t.ctx.createGain?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:1,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()};"function"==typeof define&&define.amd&&define([],()=>({Howler:t,Howl:i})),"undefined"!=typeof exports&&(exports.Howler=t,exports.Howl=i),"undefined"!=typeof window?(window.HowlerGlobal=e,window.Howler=t,window.Howl=i,window.Sound=n):"undefined"!=typeof global&&(global.HowlerGlobal=e,global.Howler=t,global.Howl=i,global.Sound=n)}(),me.plugins={},me.plugin=function(){const e={};return e.Base=me.Object.extend({init(){this.version="5.1.0"}}),e.patch=function(e,t,i){if(void 0!==e.prototype&&(e=e.prototype),"function"==typeof e[t]){const n=e[t];Object.defineProperty(e,t,{configurable:!0,value:function(e,t){return function(){this._patched=n;const e=t.apply(this,arguments);return this._patched=null,e}}(0,i)})}else console.error(`${t} is not an existing function`)},e.register=function(e,t){me.plugin[t]&&console.error(`plugin ${t} already registered`);let i=[];arguments.length>2&&(i=Array.prototype.slice.call(arguments,1)),i[0]=e;const n=new(e.bind(...i));if(!(n&&n instanceof me.plugin.Base))throw new me.Error("Plugin should extend the me.plugin.Base Class !");if(me.sys.checkVersion(n.version)>0)throw new me.Error(`Plugin version mismatch, expected: ${n.version}, got: ${me.version}`);me.plugins[t]=n},e}(),me.DraggableEntity=function(e,t,i,n){"use strict";return e.extend({init(i,o,r){e.prototype.init.apply(this,[i,o,r]),this.dragging=!1,this.dragId=null,this.grabOffset=new n(0,0),this.onPointerEvent=t.registerPointerEvent,this.removePointerEvent=t.releasePointerEvent,this.initEvents()},initEvents(){const e=this;this.mouseDown=function(e){this.translatePointerEvent(e,i.DRAGSTART)},this.mouseUp=function(e){this.translatePointerEvent(e,i.DRAGEND)},this.onPointerEvent("pointerdown",this,this.mouseDown.bind(this)),this.onPointerEvent("pointerup",this,this.mouseUp.bind(this)),i.subscribe(i.POINTERMOVE,this.dragMove.bind(this)),i.subscribe(i.DRAGSTART,(t,i)=>{i===e&&e.dragStart(t)}),i.subscribe(i.DRAGEND,(t,i)=>{i===e&&e.dragEnd(t)})},translatePointerEvent(e,t){i.publish(t,[e,this])},dragStart(e){if(!1===this.dragging)return this.dragging=!0,this.grabOffset.set(e.gameX,e.gameY),this.grabOffset.sub(this.pos),!1},dragMove(e){!0===this.dragging&&(this.pos.set(e.gameX,e.gameY,this.pos.z),this.pos.sub(this.grabOffset))},dragEnd(){if(!0===this.dragging)return this.dragging=!1,!1},destroy(){i.unsubscribe(i.POINTERMOVE,this.dragMove),i.unsubscribe(i.DRAGSTART,this.dragStart),i.unsubscribe(i.DRAGEND,this.dragEnd),this.removePointerEvent("pointerdown",this),this.removePointerEvent("pointerup",this)}})}(me.Entity,me.input,me.event,me.Vector2d),me.DroptargetEntity=function(e,t){"use strict";return e.extend({init(i,n,o){this.CHECKMETHOD_OVERLAP="overlaps",this.CHECKMETHOD_CONTAINS="contains",this.checkMethod=null,e.prototype.init.apply(this,[i,n,o]),t.subscribe(t.DRAGEND,this.checkOnMe.bind(this)),this.checkMethod=this[this.CHECKMETHOD_OVERLAP]},setCheckMethod(e){void 0!==this[e]&&(this.checkMethod=this[e])},checkOnMe(e,t){t&&this.checkMethod(t.getBounds())&&this.drop(t)},drop(){},destroy(){t.unsubscribe(t.DRAGEND,this.checkOnMe)}})}(me.Entity,me.event),me.CollectableEntity=me.Entity.extend({init(e,t,i){me.Entity.prototype.init.apply(this,[e,t,i]),this.body.collisionType=me.collision.types.COLLECTABLE_OBJECT}}),me.LevelEntity=me.Entity.extend({init(e,t,i){me.Entity.prototype.init.apply(this,[e,t,i]),this.nextlevel=i.to,this.fade=i.fade,this.duration=i.duration,this.fading=!1,this.name="levelEntity",this.gotolevel=i.to,this.loadLevelSettings={},["container","onLoaded","flatten","setViewportBounds"].forEach(e=>{void 0!==i[e]&&(this.loadLevelSettings[e]=i[e])}),this.body.collisionType=me.collision.types.ACTION_OBJECT},getlevelSettings(){return"string"==typeof this.loadLevelSettings.container&&(this.loadLevelSettings.container=me.game.world.getChildByName(this.loadLevelSettings.container)[0]),this.loadLevelSettings},onFadeComplete(){me.levelDirector.loadLevel(this.gotolevel,this.getlevelSettings()),me.game.viewport.fadeOut(this.fade,this.duration)},goTo(e){this.gotolevel=e||this.nextlevel,this.fade&&this.duration?this.fading||(this.fading=!0,me.game.viewport.fadeIn(this.fade,this.duration,this.onFadeComplete.bind(this))):me.levelDirector.loadLevel(this.gotolevel,this.getlevelSettings())},onCollision(){return"levelEntity"===this.name&&this.goTo.apply(this),!1}}),function(){const e=function(){const e=me.video.createCanvas(1,1),t=e.getContext("2d");return t.fillStyle="#fff",t.fillRect(0,0,1,1),e}();me.ParticleEmitterSettings={width:0,height:0,image:e,totalParticles:50,angle:Math.PI/2,angleVariation:0,minLife:1e3,maxLife:3e3,speed:2,speedVariation:1,minRotation:0,maxRotation:0,minStartScale:1,maxStartScale:1,minEndScale:0,maxEndScale:0,gravity:0,wind:0,followTrajectory:!1,textureAdditive:!1,onlyInViewport:!0,floating:!1,maxParticles:10,frequency:100,duration:1/0,framesToSkip:0},me.ParticleEmitter=me.Rect.extend({init(e,t,i){this._stream=!1,this._frequencyTimer=0,this._durationTimer=0,this._enabled=!1,this.isRenderable=!1,me.Rect.prototype.init.apply(this,[e,t,1/0,1/0]),this.autoSort=!1,this.container=new me.ParticleContainer(this),Object.defineProperty(this.pos,"z",{get:function(){return this.container.pos.z}.bind(this),set:function(e){this.container.pos.z=e}.bind(this),enumerable:!0,configurable:!0}),Object.defineProperty(this,"floating",{get(){return this.container.floating},set(e){this.container.floating=e},enumerable:!0,configurable:!0}),this.reset(i)},onActivateEvent(){this.ancestor.addChild(this.container),this.container.pos.z=this.pos.z,this.ancestor.autoSort||this.ancestor.sort()},onDeactivateEvent(){this.ancestor.hasChild(this.container)&&this.ancestor.removeChildNow(this.container)},destroy(){this.reset()},getRandomPointX(){return this.pos.x+(0).randomFloat(this.width)},getRandomPointY(){return this.pos.y+(0).randomFloat(this.height)},reset(e){e=e||{};const t=me.ParticleEmitterSettings,i="number"==typeof e.width?e.width:t.width,n="number"==typeof e.height?e.height:t.height;this.resize(i,n),Object.assign(this,t,e),this.container.destroy()},addParticles(e){for(let t=0;t<~~e;t++){const e=me.pool.pull("me.Particle",this);this.container.addChild(e)}},isRunning(){return this._enabled&&this._stream},streamParticles(e){this._enabled=!0,this._stream=!0,this.frequency=Math.max(this.frequency,1),this._durationTimer="number"==typeof e?e:this.duration},stopStream(){this._enabled=!1},burstParticles(e){this._enabled=!0,this._stream=!1,this.addParticles("number"==typeof e?e:this.totalParticles),this._enabled=!1},update(e){if(this._enabled&&this._stream){if(this._durationTimer!==1/0&&(this._durationTimer-=e,this._durationTimer<=0))return this.stopStream(),!1;this._frequencyTimer+=e;const t=this.container.children.length;t<this.totalParticles&&this._frequencyTimer>=this.frequency&&(t+this.maxParticles<=this.totalParticles?this.addParticles(this.maxParticles):this.addParticles(this.totalParticles-t),this._frequencyTimer=0)}return!0}})}(),me.ParticleContainer=me.Container.extend({init(e){me.Container.prototype.init.apply(this,[me.game.viewport.pos.x,me.game.viewport.pos.y,me.game.viewport.width,me.game.viewport.height]),this.autoSort=!1,this._updateCount=0,this._dt=0,this._emitter=e,this.autoTransform=!1,this.anchorPoint.set(0,0),this.isKinematic=!0},update(e){if(++this._updateCount>this._emitter.framesToSkip&&(this._updateCount=0),this._updateCount>0)return this._dt+=e,!1;e+=this._dt,this._dt=0;const t=me.game.viewport;for(let i=this.children.length-1;i>=0;--i){const n=this.children[i];n.inViewport=this.floating||t.isVisible(n.getBounds()),n.update(e)||this.removeChildNow(n)}return!0},draw(e,t){if(this.children.length>0){let i,n=e.getContext();this._emitter.textureAdditive&&(i=n.globalCompositeOperation,n.globalCompositeOperation="lighter"),me.Container.prototype.draw.apply(this,[e,t]),this._emitter.textureAdditive&&(n.globalCompositeOperation=i)}}}),window,me.Particle=me.Renderable.extend({init(e){me.Renderable.prototype.init.apply(this,[e.getRandomPointX(),e.getRandomPointY(),e.image.width,e.image.height]),this.alwaysUpdate=!0,this.image=e.image;const t=e.angle+(e.angleVariation>0?((0).randomFloat(2)-1)*e.angleVariation:0),i=e.speed+(e.speedVariation>0?((0).randomFloat(2)-1)*e.speedVariation:0);this.vel=new me.Vector2d(i*Math.cos(t),-i*Math.sin(t)),this.life=e.minLife.randomFloat(e.maxLife),this.startLife=this.life,this.startScale=e.minStartScale.randomFloat(e.maxStartScale).clamp(e.minStartScale,e.maxStartScale),this.endScale=e.minEndScale.randomFloat(e.maxEndScale).clamp(e.minEndScale,e.maxEndScale),this.gravity=e.gravity,this.wind=e.wind,this.followTrajectory=e.followTrajectory,this.onlyInViewport=e.onlyInViewport,this.pos.z=e.z,this._deltaInv=me.sys.fps/1e3,e.followTrajectory||(this.angle=e.minRotation.randomFloat(e.maxRotation))},update(e){const t=e*this._deltaInv;this.life=this.life>e?this.life-e:0;const i=this.life/this.startLife;let n=this.startScale;this.startScale>this.endScale?n=(n*=i)<this.endScale?this.endScale:n:this.startScale<this.endScale&&(n=(n/=i)>this.endScale?this.endScale:n),this.alpha=i,this.vel.x+=this.wind*t,this.vel.y+=this.gravity*t;const o=this.followTrajectory?Math.atan2(this.vel.y,this.vel.x):this.angle;return this.pos.x+=this.vel.x*t,this.pos.y+=this.vel.y*t,this.currentTransform.setTransform(n,0,0,0,n,0,this.pos.x,this.pos.y,1).rotate(o),(this.inViewport||!this.onlyInViewport)&&this.life>0},preDraw(e){e.save(),e.setGlobalAlpha(e.globalAlpha()*this.alpha),e.transform(this.currentTransform)},draw(e){let t=this.width,i=this.height;e.drawImage(this.image,0,0,t,i,-t/2,-i/2,t,i)}}),function(){me.debug=me.debug||{};const e=me.Object.extend({init(e){this.stats={},this.reset(e)},reset(e){const t=this;(e||Object.keys(this.stats)).forEach(e=>{t.stats[e]=0})},inc(e,t){this.stats[e]+=t||1},get(e){return this.stats[e]}});let t='info face="PressStart2P" size=10 bold=0 italic=0 charset= unicode= stretchH=100 smooth=1 aa=1 padding=1,1,1,1 spacing=0,0 outline=0\ncommon lineHeight=10 base=10 scaleW=128 scaleH=128 pages=1 packed=0\npage id=0 file="PressStart2P.png"\nchars count=95\nchar id=32 x=1 y=1 width=0 height=0 xoffset=0 yoffset=10 xadvance=10 page=0 chnl=15\nchar id=33 x=1 y=2 width=5 height=10 xoffset=3 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=34 x=1 y=13 width=8 height=5 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=35 x=7 y=1 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=36 x=1 y=19 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=37 x=1 y=30 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=38 x=1 y=41 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=39 x=10 y=12 width=4 height=5 xoffset=3 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=40 x=1 y=52 width=6 height=10 xoffset=3 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=41 x=1 y=63 width=6 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=42 x=1 y=74 width=10 height=8 xoffset=0 yoffset=1 xadvance=10 page=0 chnl=15\nchar id=43 x=8 y=52 width=9 height=8 xoffset=1 yoffset=1 xadvance=10 page=0 chnl=15\nchar id=44 x=8 y=61 width=5 height=5 xoffset=1 yoffset=6 xadvance=10 page=0 chnl=15\nchar id=45 x=8 y=67 width=9 height=2 xoffset=1 yoffset=4 xadvance=10 page=0 chnl=15\nchar id=46 x=14 y=61 width=4 height=4 xoffset=3 yoffset=6 xadvance=10 page=0 chnl=15\nchar id=47 x=12 y=18 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=48 x=18 y=1 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=49 x=12 y=29 width=9 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=50 x=12 y=40 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=51 x=22 y=29 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=52 x=23 y=12 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=53 x=29 y=1 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=54 x=1 y=83 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=55 x=1 y=94 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=56 x=1 y=105 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=57 x=1 y=116 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=58 x=18 y=51 width=4 height=8 xoffset=3 yoffset=1 xadvance=10 page=0 chnl=15\nchar id=59 x=12 y=70 width=5 height=9 xoffset=1 yoffset=1 xadvance=10 page=0 chnl=15\nchar id=60 x=12 y=80 width=8 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=61 x=23 y=23 width=10 height=5 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=62 x=18 y=66 width=8 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=63 x=23 y=40 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=64 x=33 y=29 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=65 x=23 y=51 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=66 x=34 y=12 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=67 x=40 y=1 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=68 x=12 y=91 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=69 x=21 y=77 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=70 x=27 y=62 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=71 x=34 y=40 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=72 x=34 y=51 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=73 x=44 y=23 width=9 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=74 x=45 y=12 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=75 x=51 y=1 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=76 x=12 y=102 width=9 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=77 x=12 y=113 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=78 x=22 y=102 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=79 x=23 y=88 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=80 x=32 y=73 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=81 x=38 y=62 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=82 x=23 y=113 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=83 x=33 y=99 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=84 x=34 y=84 width=9 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=85 x=43 y=73 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=86 x=34 y=110 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=87 x=44 y=84 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=88 x=44 y=95 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=89 x=45 y=106 width=9 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=90 x=45 y=117 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=91 x=45 y=34 width=6 height=10 xoffset=3 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=92 x=45 y=45 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=93 x=52 y=34 width=6 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=94 x=34 y=23 width=8 height=4 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=95 x=34 y=121 width=10 height=2 xoffset=0 yoffset=9 xadvance=10 page=0 chnl=15\nchar id=96 x=15 y=12 width=4 height=4 xoffset=4 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=97 x=54 y=23 width=10 height=7 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=98 x=56 y=12 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=99 x=62 y=1 width=10 height=7 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=100 x=49 y=56 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=101 x=56 y=45 width=10 height=8 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=102 x=59 y=31 width=9 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=103 x=54 y=67 width=10 height=9 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=104 x=60 y=54 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=105 x=67 y=42 width=9 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=106 x=67 y=9 width=8 height=11 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=107 x=69 y=21 width=10 height=10 xoffset=0 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=108 x=76 y=1 width=9 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=109 x=76 y=12 width=10 height=8 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=110 x=69 y=32 width=10 height=8 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=111 x=86 y=1 width=10 height=8 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=112 x=97 y=1 width=10 height=9 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=113 x=108 y=1 width=10 height=9 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=114 x=87 y=10 width=9 height=8 xoffset=1 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=115 x=97 y=11 width=10 height=7 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=116 x=108 y=11 width=9 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=117 x=87 y=19 width=10 height=7 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=118 x=98 y=19 width=9 height=8 xoffset=1 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=119 x=80 y=27 width=10 height=7 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=120 x=108 y=22 width=10 height=8 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=121 x=91 y=28 width=10 height=9 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=122 x=80 y=35 width=10 height=7 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=123 x=118 y=11 width=6 height=10 xoffset=3 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=124 x=102 y=28 width=4 height=10 xoffset=4 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=125 x=119 y=22 width=6 height=10 xoffset=1 yoffset=0 xadvance=10 page=0 chnl=15\nchar id=126 x=91 y=38 width=10 height=5 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15\nchar id=32 x=0 y=0 width=0 height=0 xoffset=0 yoffset=3 xadvance=10 page=0 chnl=15',i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAdhklEQVR42u1deXMUR5bnG8xH8EfgI+g/h405zCFzI3QLBJYDhgVjQBJICF1ugcVlHCtzXwZx2d6IAYqN9eA/20ji8hh6ltmxHeuI6fEV6zGI3Pxl9at+nZ1ZVdlqYSzqRWSoVZ2dnZWZnfXeL3/vvWnTEkkkTLp37Rz+9JOPBQpe7x18L0v/v/nmmha9Pq7R+yjHjx0Va9asmc7r8DZMJU67prq2vun3YLpuKryubUxQ8L1x6sXpd5zxKLXfVtE7QA3s3Llj+MKF4ayQ8vTpU3Fh+Hz285s31WuI/Fxm25bNrdQOXuPa/fv3BMp3330nHj16JA7u35devbpxDtX7+OMrgoTqUvnyy/tizeqmVt4/ahffi/ZQD3/1PvB2qY2dnfIeZL9xDW0PDPR7+r3pfaB+UF1dcB3voz8oH1+5LPQ6tvYfPfpv9ZlB2e8thn4X1i2+R3u7j4I2BgbeFU4LgDpAN/TBB4fUjV++fCl/fXxcjI8/CcrTp+Pq+sGDB1Tdxsb6lj17BtQkNTXUD62qr6+4dOlCULepsc5rbKybo7crr2fwHi9UT28Xfdi7d08abeOv3gfebmNDXaqpoa61oA+yX42NNWo3unTpYq7uuKivrxmqr6+uQIkzXmgDfaCxwHfodWztD+7Znfb781QcOLDf7/elfL8b6utl3foKlL2D8h7Hc/d44EDsuv19vW4LAAOHD9IN0YDW1axsHUj1Z/zJfyxS/X2ZC8PnxJMnv6p6dbUrvdra6irUvXjxQrBQ8Dn6PD5DE7B//15Pr4t20R4V1K2tWTlUW1v7UlG77PvwF+2jWPqQvnN7VLWJv2izvjo/wcPD54N7XrliWWspj8fxJ37fMSb6e7b2B98b8PA5XJe7gBoP+YsO6tbIflbLfqLs3p1Ko66/8Adj1+3u7nJbAP7AjfsTIBuhiVIdlp3El+E9dP7cR2fEk8f/UvX4jbnc8Ntvb/LwevC93V5fb3ema2eHkFu1OHb0sGr39u0x0dXV4blOFK97e2xE/PB9Vtzwromuzg6vZtmyAj3ko4/OBnWXLFpU0gJ48vhX8fjxL+L8ubNFA25rX/6ggvEYGEipezx//lxQd0z2e3T0CzE68oV4+OAvatx7enZl3nxzbQp1N23a4J08eSJrq4vrnXIsnW4EA6cmWU4sJuStt95M0Xu7dw8ECwDPvrNnTql6+H/JkvyNnTv3Uf6G2XV8hjqGtsL6Yapra9ckvC7aweSMjqSxoMWyZQsLFsC2bVvF9WvX1C/m1KkT4tRJVk6dFKdlWb9unVWZWrp0cRXG4fGv/yfOnj1VNOC29q9d/ZPqH9p/q6VF3ePZs/nFckaO75nTp8Tp0yfV3zNnTotFi94ouO/169d7uM7rXr92VdDCam9vc1sAGDh88PGvvxQM8oYN64ePHTuapQE9evRw9vq1PwU7QGdnR2b16tWq/r59g+Lhw4e0AuV1Xwnr7+9VK35sdFS0tbV61G5K/hL6+/u8hQsXBM97qotBw/th7eIvPi8fMR714ezZM8FAjshfxff//Ifq64OvvhQ93V1p/l20E42MjMi6t8TIrS/8MvKF/7+8jvdtY/bGGwta1WNLto8JMNUJa3/27JnBOJ+Wk0j6wrx580rajXp7uz161GLxOX0Yg4wJQudwY6aOKf0g98yjlYbrfX29apDmzp1b0dW1M011d2xvz8yb93or/uJ/+XpI1pmutzt//use6vG6Lu3yuoUD+XoaA877i++S7c2ZiFks22jB96MtGg/8suke6B5N8uqrr1ZQmTFjxkt0/cSJE4FixxeGi+za1eWRdbZ589vC9aaGcUP6AKEz7W2tvgYuB1X+gjMnjh8TvrY5LubMmunNnv1aVb7+a1W4FiwY/BJvydU+a9bQrFmzKmztBpaFQ7umuif5QMrvxPfw/kK6d+3y4owJsAtgGDqWwb+DW0bUfikTOGPGK61UsDhKWQCvvPJKFbWB104fppvCjeg3sHz58lRnZ6eHgtdNTY0e/W/6Ilyj91E2btzgvfzyy9OLn6FLhzZu/DdBhX8mTrumuqa+8Wt0D3HGZO3aVRXXr19TeIAn/+J/3/qoyfB+64X3h+MrLWubh2hBhQFev4lETeqLJo2NjdNXNTbIxV7vUWlurn3JtR0O8OzZM5C9efPPBUDTagZ4xUUNTcioDYl0qeeEFlKHcM0E9UZtqeWAQ+PA1mHwcJjU1dW0Kr0hpzvcvXtXEEjk0s8ADMrhHQCBCBBCIawjCpVcrSGjajzltTAk0oSgHj1yWEROLt+q+ORekV9Cz72mpgbVoQ+H/l38+c+fCaBQjXV1VuUKMDDgYHSCOs3hWlc41GpGpt4tgkNN8HCUVFevqNo98G468/ArtQju3rktqquXV1B7P//8s8hDwePiu+/+1wjxFmAYVcu86hVLjbsrRw0b6moy9XW1Hi91ddUFyCgQTiCmHIlU12QhpBMCQI/0lH17BxWCarxhTG4AzcrHwb17d1Rn7t+/L1at8j/EsYIVOUBm8eLKip6e7jSu6bZqvsN1c9BZE5SMDnM0MuhDDkq2Qb426e/rCSBqaVIKA+zs0UCZBkzTfSpGpbnmI4ljAv/TZN27dw/wbposo4sXhoUJ4s2DQY9DwSYAXH29PRkyt3184RcGuC0fql2ypAAZ5VYZYSe4d0Jha2pqpu9Bn3J19ueQxBAEbVw1WCVX6tgY3fjt4MYBPFAH31iQNxVJ+zRpr9QJK5Sc66wO4xJsi7Jn90Bah5JtIm39YCB6enYJV9iZy+LFiytgFqPe7bFRwcfqjtwR8IumyQI6akI8YZbSdy+IsO+bm1elBlIpD0hhKleOHzuSVRiK/P4d7e0FKCoWDCGR/3njugCqikK7zKFDB8Vf/5pR/e/tKQT3igSTSyu1csECb+RWWvjgzYiorKxUE7tqVZPX1dWlymuvvRZLUaROYFAIYYwDJQPGRRkbvaUgTtTFDYfehBRAyjQJXTs7hd4u+oCJek+WUyePZ3XYmQvuGzgCTQCHeG+PjYnFixZ5hDYCjTNBvPKvICAozDxsb2vLnj51SqGDUaghCQC7MCSyo2O7uHHDUwsA6K20UOxHxNrkpjZt2qheb9q0yZs5c+b0UhVHDs2ePXtadQTQLEHJH8nFQB0z1UXxvGtFdW2yY0d78MvesWO7cIWoAeIAeEIB4KMWgHx/VP4QODg2OjoqFsyf69GOgsnqY0gcAVM24KcYAqeFEo0auiCRqVRfsEsBNZ1084lMDtLAFcIofz0YQP9mvhDffP0/wQ7A4WEO43I00gQP26DktrZtgurKdoVru3Ih5Pp6S9ySE/DDD9+Lq/JX+M47b3t8svBYmTVrpkeTBeXTh32jIeRyCVBHjkSa6mAh0mNb/jgyWNSxETBXm5FMDk6koF8TLydPHg+26VLhYVvdrVvfEXk8fItwbVfufOL48WOqHDvmF1wzwbkAt/gvnP9PwJcLQ8lmZttMWOwKpFgD7TTNCSGodJ8A/EInEEQQMtfA/MH/KJzNY9b061ukspbRSRcm4dAs39oKINYIyNcFSnaFncsp3ATltvwHHxwMcHsi35jqkumtf15HRmG5hUHEkfV01k2YuaYLNHVo9ibShQvq6AKxukLJrrBzKeBRDPs+GMMD0prRTUYOGlFdmJdUj3++7KKZYFlMJiYVDBxVqquNO0C1NBE//eSKMoNMpIvfq5QCHkURVGwkGVg3xXWXD2FsQTQhPYU+P9HHyjTbufWZUyeznEkDZc03x0aNTJwlSxa2kLa+Y7uZgBAFm0axdE16iAsU64qvm0Epf/cLELgAQKqLPFaOwwqSuogauw1/XO+dOC5NU2lZgOED5fJrOQcPpBnc29uTXrx4cZW+OIE64nGCIhdQVn+sAPr929989DUSSd2w4Y8eTC1MKiYf5prNBAMBA2QQaPVtbVutz5/Dhz9UaCKQs3v37gogjH65qwreI/Nk+/a24fPnzmWx2u/evSN+/PF78dln/6UUNA7U4KagaHJWLtjHdI3/Yom9G8XKjdgRh+gxxxG3KFAqDitIJ2/A1gcbibR7LIL39uwWlVJ5Nj1WCA3k5xb8sQIkFRAwPdYP5q4bJj9vVnV3d6XBoAHzBwwg3VyDKSFt7EyOdDEURoBwEZ8W5aORCxe+kR4BXiAHAd8NyDnALHIQsc7KpWvNbLHguanj6u/292b1gYriFqJw8zUOKBWXddTSslbo2v1IbgeAeVkEG1ctGwYKKUuGw8boo7yWVu+xHRsLlRYUUFWgs0WdjGL+8ImGtj4qO66TPMIRRoZb50AgbHX4PtoBOCmCkxv8YgZRwli50EfkAKZt+DqHbONwC4G4ffPN39UOGcVNnIjgXrl5qb+/f/8+hUQCX8n37RdFfwNyy2FjtavIhQoEFHUePvxKHHr/oDDYizNbgyInFiAIzDW6xicaWryN5FF8rFqX2bRpk/DLRq3415cvXz5U6mCFsXIxUJmMzyXc1dWZ0fF1DtkW70bxuYV0JI5TVK672LyRJir8fMH2WCFcA4JHNxYtFjAe6YSQWgUTiwkOsy2fB5koK1cfKNuOGMUthFIGPaO5uckjrAH2u8nWL1WDb1m7ZtgEG3McxYZEThocHIdp4uLD5qqxT5SVGwbZunALg+NhqV/w42GTrW8zL7FA6LoODOHza5pXCR2J1M8XTEgk6Wv0KANz2IlNY8L3daZJGCNF18KhrdOvQvfTkwOc1TV2ok5xE2YirNyJUORs3MI4x8Nk6xe4dTFwDQukyAWMeWs1NdaLUu4jv5AjEE8+Adw30ITvB0wT5kpm8o3zbWffh45IITY/PdwsJht1A1ub/AQb6oc5GaRcrNwoilpciXM8TLZ+HLcuuWVnyBSlX25dbbUo10K2Ah+YgMaGOmWHw14Mw/eVX17tSi9MCw9MsYaGP9TWrmzhfnrw2+PoIm4Wtj8IIpy0oerK7+F2tytkHEVRM2EILmATdA06y6e+41FjsvVd3Lo4A2tl1XIxqQpVkQOmXJ1R+D5szTAtnNcjdBF18VdHF4NtFG2qLf14Fj59OdvWCzPZXMTKp9O8ku38RDOI5GLrx3Xr8r21Hqsxkwrv5C4A7qwJHDoOvh/FSOH1oggeuFkwc5Yu9bdR7/pVhUSS3a37FZp+oaSIhr0Xl0/n4trtvi03tML66O1F6VblyOEPs0Q8Wb9+XcBjoB1g4cLKyV0ANnyfbEgTGydKC3fx/8PNAsCQ9TwijlABMZMjkbqGTL9OojwTVIxrgZIq67vw6Vw8nV3PO3ZJ64HMRdJhSAGcJS0O0uyVvT/uI6Pz58+d/AWg4/sbNqwbPnBgXxYTwCcrrhbuSvDAApA3WsUoWZ5Nsw8Oa0BRlxoywcAmqBh1UN9l93Jx7T7Cziaw6H766cccM9mfVF2Blmba8IwZr4p8MbuFQdmlPsyZPWtyF4AJ3wdzB88y+X+WT1ZcLbycpA1dsw+2cjkZYRoygTewy112Lxub18T7yzt61LaAKg4fAn44g0dIY03NdPdHRV6Dx6KZ1AVgwvdtTqAuWvhkkTaIxo5JDNOQFfYv6wyfL7RSovh0rmgbOPvQnYoOZ3Ln+mHg2ITctcolJnz/efYX9A9rxilIxZANKsYW7yucZ4ULn84FbYPg8IUfzkCrl9q81H0Kg1LIXVbFWwBySDsdPKugJzU2NrYcOnTQ27x5c+u0511cYNuJOD3alCn/sMZfAJzpW7TN504eYXaVwqeLI+D005kDxwFMkUbI3K2qWpbmuwUwAXktUy5ztyyTatuaosKU2UKakUbOfQNtYeZ4ODiCg7kyRc9oOpjJKaUtupJKJh4mYrLGLYrTzx8X8KhSZf78qsrK+UPqkIkdj8MpB+8988nXJ/Wnn35SrGBovc3NzS/Z6VK+Dx/gWmklZMPCtrmEmePh4HghNJJj3DrlOey9ch50TVTgcEMOOK4eV2WXwvh69WnAsr5b9B2he5RSaDZZUvgbRpfSEUY/pNvK4b6+nmxUXcDNYK+QjyAKUcP0gxm+lYe9F1cACdPuc+TIh2LaVJew+Ho2mjdBvGF0KY4wEsjy/sH9Rn8/E/iCukRMtfnwlVvUwZXc2fhh1JRfACZWsC2+HrFMgA7GpUtxhJFDvFFh5oBGEnTM4WCXwBSuiuj+3Dl+nIOuKSM7d3Zkb9y4EThmEisY8fVgZnEoWA8dB5oUFJ7Lly8GnsQmjZzDu6a6UWHmOBoJuPfzz28WxSB2U1rNBzs+hy4PFYcddE0Z4Rw44PGYICwCTO6O7e1ZjsXrBNK2tm1ZijAmte9UDrotmBT8T3Xydee9pNWJHQ4uoDvngj6EcfRt0TfC2MFxD7qmjOgcOEyQ5sSpJqMICjbAtqZQbAp40ULHmRjFYeHg9HYDToI0n6x0Z023iMsOjkM3m1IShcXzwY+CglEA69qAl7DQcea69nahWA6k+tI40YPCaGqPH+xwdvD29jahyvZ2sbqpacjloGtKio7FR03q8yII5bJf6g9QMEuJCcx95icjCOQLI2GOiK5ZROJk+9BlcHCP8mZyjQnMJ7UcdLPftYQhYFHoWJ6kMV7gy67Du3GyiNgo02GZMKBE7tzZmY4TEzhu6JYXSqKCCq4OAhP6jg8mbZsYLOTLboJ3Y2URYZRpEFT10G92XcZXIl1iAifCJ8oQVBBEB3KyhMZNBAtcQyGyA3Na9KpXrJhjg3fjZBGxhYmj0G9hQkqkLSZwuYI/TEko2GfY5NOyFJlROXCETCgeuAC+eDjWxLOVaFQu3LqoMHE89NtEpFzBH6aUFDBstGAQCFwA/htMKLKhr1+/qk4KEdiQAhcQiRFtEI0qKvSbLTOIrW6kY2MIBEwKZKmRQ6e0aAwb468CkxpNo/K1bNKsdS9bKkAYSwnnRnXjikmBLDVy6JQWH4d/oAaB4/A6WBQWuMCkWWsI4xAxfklbt4VzI9QRUpgKZYuw6zE4xSv8NZNnE1cgS40cOqWFcPiwoIJRgQtMctKSCqVbpTfxwZV3culNXOrqosck1n/VXIEsR3KrKQoHOwQVjCk2YinPQkIIo0tdXfSYxPqvmiuQLpFDXzixkSXLlYhhcnWY8F81KZBxHjW2wBEvrICuTIOD10qbvnQpODhqCAkkabPByxk0wkWBjPOoeeFApLBf84oVy1p6FUHiXwoHILsdUb3IedGWLCLMBjcFgoiT3NnEPo7jhkYKZJxHTdzEUlNGwgIK+pG+xtXkc9pyKanObFlBIusy/z9TBpE4x9nvuObSe5FEDygI8wnwsHqvhEQRUYijDvdSQTAJU13u/4fUJ6ZgjVHH2Yg9mMx0iBDDxuZQOZHHiAlW5nCvKSRtYcKlvP+fCUZOpEyCCdAdKuOGS6HHSFiGLxvcq16HsoQXp4n0YYKR40DBUQpnItN8MqTuUInIkvBnu3171I9EOXorF5FyRCWVogxieaJm8WMkSls3iY2oaso2YpIoJZKHZEtkGgWI2KG0fUSo3rt30Flp4o8Rxam/cL7AscRmg5vEhahqVCJ5SLb6+qF6uUBRkONQD8n2woseUBBY/VwWoTpsa9W3USJqPnjwpfj226/Ff3z6qSAf+ZMOWbJtmj0YxXNmz8xE2esuIdleeIkdUDAn2DrJy1ffRpUXkHxWK+cS+bg4sH+fAHEzzAa3CbfNOaNYmp2pKHvdJSTbCy+uE4Otk36RfBsteIx89SWUwd90gOOGZEvEUeSW2lpdvdJDqcmFVuOPEQxw1GMkLjxsSzDNAyjbHklxQ7IlYhjEMLu+o2OHh+0UFgFe6893l0xcLkmjC+hcLICyKWk0JG5ItkSm5QM7Y3CQfwa57hHyzJS+HMelFNkilUp5pTxGouBhE+Srw8PUhilpNCRuSLYXXhTzt752GM6TPA8NQp4h9BlCnVEK83Xr1g0fOeKnkgE7aOvWLRMypbTYBK1hkK8NHjYljU7EQVwcKE/QVi8nAduoKbewy7FvqcxhDg+bkkYn4iB55m9XhuehgSaPlGVg/yK9OerG2UZdjn3jJI1GRjO9Lg+gbEoanYirybTurWEKeY5Q59jev/n670UOlBN5rkdBvqY4wRwyLoSH8wGUTUmjE3EU7kCJ19Csw9KXQ3jSBe7w6XLsa2MOU+GBJAqJH3NFWNLoRBxFj4IZ5UCpJ124fv2aWLtqVYX+rI469i0HPPwsEkEnwoRSwNAEXL50UTF26Jftcuzraj66JoJOxEFsYVo5EEQcfLIY4OjJzTf9WR117JvIcyJhYVq5E2XAwVdx/rqNKVRtJM1yQMITDSSRiHFLDw/TyvPxdnRsFzdueGoBYFvXM4noz/W4gaTiJoWeaCCJRCLQOKm1Z3TNnWvtvtnV6sFEA1CEBNOIHcjfLyWQVNyk0IVhbetSvkdvfYtLIIlEQpDAKK0dgmhZMNkIMkbwJWzxlZWVfyhHf8KidJrC2qKeayCJRJjEQeP0rR5x/ijRNAYdGUdMsf9c8wVAwqJ06osVYW1BPil3IIkXSkp1mKRE07bYf3G8e9rbt7UULwB7lE5bavd83P0EDnYWlwxfJUPCzLvHdnwbLICQKJ18sVKsYs4WTuDgEsQFYbOZa6bYf6Ue34ZFItFjFYN5xNnCCRxcosRF2EwnfbbYf6Ue34YldDIxj7CA29QCTvwAJ11M27ot9p/mtx+YfVHROMIyfUwkkEQiJaJwHF0zbeu22H9JNI7fiUQRM7kblYvT5mQolwkUPNnbekQmMJdtfTKOb/liJcbwzk5pbg6fzyY+fyUKywTWSvAvzwTGo4eatnUkmgYkbHLaLPfxrZ6KDk6oXAfhizWREgR+fJ9+ciVA1wZS76Yp45dtW9ecNocmM7ECFulAqj9jCwmnh7pNxEEouxdPGkV+fSYzTHfa5MmnXcUEGdsygwWJnYjB/PgX42JNxFHi5MrhZtjWrVuCU7/m5tWiVE8bE2RswxYg4WnrFiYRwEsVlVY95xiCbf23VEILsAUWhs6Uto5DwZ2dHRk4qSazWYLw7F4mFE43w7iD5kTMNROLWKWapVJdPcekg9ig4CTQY4kSJ626zUEzjrmG6ybmjp65NC6L2AYFJ9lCntV2zRw045hrYcwdeP/guR7FR0gCPU6SxNXCg+wiyuSqti4AU1x+G3MHz3VAwv39fR7P+JVAxs9IbMSNz2/ejH3Cp4vJ4dTG3HGFjE36RZILqGzbel0GZEvuo8+1cMougl81d9DURaeZYfJtzB1XyNjEDP74yuUkF1Cpom/X2KZ5xi7u+GFz0NQlKs6fztxxgYxNKeZgNpJu0RQzenkiOeFaOH6d2KahhSMnrxUKHi900NTz62pOnyk4epaLucP1EDIboV9Qu7qnUiKROkBHFpFBSQun7ZrQNa6Fx82va3L6DGPuuOAGutk4NnZLfCv7mnn4IIGDSxFs12PS3q6srKxAwXatZ/ciLTxufl1X5k4cjx9+zEtmIzGIEQfQdHaRSAzBdo0FgJM8bNfQxFHa2rZlnxW6Fid1rH7MG+fsIpGYEHAprOCordolBqAOByN3n/JEZrgBzw8AUWcXIQziRBykFFawjZFDEK9LDEDd46ers8N7/+D+AtxAzw+gzi7Gw88uEpnErdrGyCGI1yUGoO91fCMAjrzrVxUngXADHiyKJM7ZRSITgIKjtuqoJI2mGIBh27ryOh4dCZBDlO//+Y+iYFGJPCMoOGqr5owcHlOQIF5TDMCwbT3wOs5xEtA+opUhShkPFuWafi4RJw08fKs2QbzYqk1Zvk1ex6jL8QV9W+dex3iu4zmvM414MAnOIMJ3JczgCULBPDiEaas2QbyDg3uEKUmjHgMQ2zmFku/p7krzkz8u5HVse67zYBIUsCphBpcJCuaEDNNWbYJ4UUxZvvW0L9jOKSsZ6gJrkJ+dU2q/EbmktnZlC4JEJMzgCUoYIYM7e5ScEVxu66iPbd0UK6iU5zr0CgoSkTCDy74gzM4eE80Izq9x9k4+O9mYSvHCM5SBFobrwAbo+3RmsI3GnkhMwVbMT/WepbOH++IsZgZDD0lmcUI4QD67RrmcPSZLdGYwziw4kyh3LD0nmVUHsWXo0uP+PA9SShzCRKaQlBKHMJFEEjHI/wOfNIUgGtbuFQAAAC10RVh0U29mdHdhcmUAYnkuYmxvb2RkeS5jcnlwdG8uaW1hZ2UuUE5HMjRFbmNvZGVyqAZ/7gAAAABJRU5ErkJggg==";const n=me.Renderable.extend({init(n){this._super(me.Renderable,"init",[0,0,me.game.viewport.width,50]),this.isKinematic=!1,this.version="6.0.0",this.area={},this.counters=new e(["shapes","sprites","velocity","bounds","children"]),this.pos.z=1/0,this.visible=!1,this.frameUpdateTime=0,this.frameDrawTime=0,this.GUID=`debug-${me.utils.createGUID()}`,this.name="me.debugPanel",this.isPersistent=!0,this.floating=!0,this.isRenderable=!0,this.alwaysUpdate=!0,this.canvas=me.video.createCanvas(this.width,this.height,!0),this.font_size=10,this.mod=2,this.width<500&&(this.font_size=7,this.mod=this.mod*(this.font_size/10));const o=new Image;o.src=i,this.font=new me.BitmapFont(t,o),i=null,t=null;const r=10*this.mod;this.area.renderHitBox=new me.Rect(250,2,r,r),this.area.renderVelocity=new me.Rect(250,17,r,r),this.area.renderQuadTree=new me.Rect(410,2,r,r),me.debug.displayFPS=!0;const s=this;this.debugToggle=n||me.input.KEY.S,this.keyHandler=me.event.subscribe(me.event.KEYDOWN,(e,t)=>{t===s.debugToggle&&me.plugins.debugPanel.toggle()}),this.help_str=`[${String.fromCharCode(32+this.debugToggle)}]show/hide`,this.help_str_len=this.font.measureText(me.video.renderer,this.help_str).width,this.fps_str_len=this.font.measureText(me.video.renderer,"00/00 fps").width,this.memoryPositionX=325*this.mod,me.event.subscribe(me.event.VIEWPORT_ONRESIZE,e=>{s.resize(e,50)}),this.patchSystemFn(),this.anchorPoint.set(0,0)},patchSystemFn(){me.debug.renderHitBox=me.debug.renderHitBox||me.game.HASH.hitbox||!1,me.debug.renderVelocity=me.debug.renderVelocity||me.game.HASH.velocity||!1,me.debug.renderQuadTree=me.debug.renderQuadTree||me.game.HASH.quadtree||!1;const e=this,t=new me.Rect(0,0,0,0);me.plugin.patch(me.timer,"update",function(e){this._patched(e),me.timer.countFPS()}),me.plugin.patch(me.game,"update",function(t){const i=window.performance.now();this._patched(t),e.frameUpdateTime=window.performance.now()-i}),me.plugin.patch(me.game,"draw",function(){const t=window.performance.now();e.counters.reset(),this._patched(),e.frameDrawTime=window.performance.now()-t}),me.plugin.patch(me.Sprite,"draw",function(t){if(this._patched(t),e.visible&&(e.counters.inc("sprites"),me.debug.renderHitBox)){const o=this.getBounds();let r=this.anchorPoint.x*o.width,s=this.anchorPoint.y*o.height;if(t.translate(r,s),t.setColor("green"),t.drawShape(o),t.translate(-r,-s),this.body){t.translate(this.pos.x,this.pos.y),t.setColor("red");for(var i,n=this.body.shapes.length;n--,i=this.body.shapes[n];)t.drawShape(i),e.counters.inc("shapes")}}}),me.plugin.patch(me.Entity,"postDraw",function(i){if(e.visible){if(e.counters.inc("bounds"),me.debug.renderHitBox){i.save(),i.translate(-this.pos.x-this.body.pos.x-this.ancestor._absPos.x,-this.pos.y-this.body.pos.y-this.ancestor._absPos.y),this.renderable instanceof me.Renderable&&i.translate(-this.anchorPoint.x*this.body.width,-this.anchorPoint.y*this.body.height),i.setColor("orange"),i.drawShape(this.getBounds()),i.translate(this.pos.x+this.ancestor._absPos.x,this.pos.y+this.ancestor._absPos.y),i.setColor("red");for(var n,o=this.body.shapes.length;o--,n=this.body.shapes[o];)i.drawShape(n),e.counters.inc("shapes");i.restore()}if(me.debug.renderVelocity&&(this.body.vel.x||this.body.vel.y)){t.copy(this.getBounds()),t.pos.sub(this.ancestor._absPos);const n=t.width/2,o=t.height/2;i.save(),i.setLineWidth(1),i.setColor("blue"),i.translate(-n,-o),i.strokeLine(0,0,~~(this.body.vel.x*(t.width/2)),~~(this.body.vel.y*(t.height/2))),e.counters.inc("velocity"),i.restore()}}this._patched(i)}),me.plugin.patch(me.Container,"draw",function(i,n){this._patched(i,n),e.visible&&(e.counters.inc("bounds"),e.counters.inc("children"),me.debug.renderHitBox&&(i.save(),i.setLineWidth(1),i.setColor("orange"),t.copy(this.getBounds()),this.ancestor&&t.pos.sub(this.ancestor._absPos),i.drawShape(t),i.setColor("purple"),t.copy(this.childBounds),this.ancestor&&t.pos.sub(this.ancestor._absPos),i.drawShape(t),i.restore()))})},show(){this.visible||(me.game.world.addChild(this,1/0),me.input.registerPointerEvent("pointerdown",this,this.onClick.bind(this)),this.visible=!0,me.game.repaint())},hide(){this.visible&&(me.input.releasePointerEvent("pointerdown",this),me.game.world.removeChild(this,!0),this.visible=!1,me.game.repaint())},update(){return this.visible},onClick(e){this.area.renderHitBox.containsPoint(e.gameX,e.gameY)?me.debug.renderHitBox=!me.debug.renderHitBox:this.area.renderVelocity.containsPoint(e.gameX,e.gameY)?me.debug.renderVelocity=!me.debug.renderVelocity:this.area.renderQuadTree.containsPoint(e.gameX,e.gameY)&&(me.debug.renderQuadTree=!me.debug.renderQuadTree),me.game.repaint()},drawQuadTreeNode(e,t){const i=t.bounds;if(0===t.nodes.length){const n=.4*t.objects.length/me.collision.maxChildren;n>0&&(e.save(),e.setColor(`rgba(255,0,0,${n})`),e.fillRect(i.pos.x,i.pos.y,i.width,i.height),e.restore())}else for(let i=0;i<t.nodes.length;i++)this.drawQuadTreeNode(e,t.nodes[i])},drawQuadTree(e){const t=e.globalAlpha(),i=me.game.viewport.pos.x,n=me.game.viewport.pos.y;e.translate(-i,-n),this.drawQuadTreeNode(e,me.collision.quadTree),e.translate(i,n),e.setGlobalAlpha(t)},drawMemoryGraph(e,t){if(window.performance&&window.performance.memory){const i=Number.prototype.round(window.performance.memory.usedJSHeapSize/1048576,2),n=Number.prototype.round(window.performance.memory.totalJSHeapSize/1048576,2),o=~~(t-this.memoryPositionX-5),r=o*(i/n);e.setColor("#0065AD"),e.fillRect(this.memoryPositionX,0,o,20),e.setColor("#3AA4F0"),e.fillRect(this.memoryPositionX+1,1,r-1,17),this.font.draw(e,`Heap : ${i}/${n} MB`,this.memoryPositionX+5,2*this.mod)}else this.font.draw(e,"Heap : ??/?? MB",this.memoryPositionX,2*this.mod)},draw(e){e.save(),!0===me.debug.renderQuadTree&&this.drawQuadTree(e),e.setGlobalAlpha(.5),e.setColor("black"),e.fillRect(this.left,this.top,this.width,this.height),e.setGlobalAlpha(1),e.setColor("white"),this.font.textAlign="left",this.font.draw(e,`#objects : ${me.game.world.children.length}`,5*this.mod,2*this.mod),this.font.draw(e,`#draws   : ${me.game.world.drawCount}`,5*this.mod,10*this.mod),this.font.draw(e,`?hitbox   [${me.debug.renderHitBox?"x":" "}]`,75*this.mod,2*this.mod),this.font.draw(e,`?velocity [${me.debug.renderVelocity?"x":" "}]`,75*this.mod,10*this.mod),this.font.draw(e,`?QuadTree [${me.debug.renderQuadTree?"x":" "}]`,150*this.mod,2*this.mod),this.font.draw(e,`Update : ${this.frameUpdateTime.toFixed(2)} ms`,225*this.mod,2*this.mod),this.font.draw(e,`Draw   : ${this.frameDrawTime.toFixed(2)} ms`,225*this.mod,10*this.mod),this.font.draw(e,`Shapes   : ${this.counters.get("shapes")}`,5*this.mod,17*this.mod),this.font.draw(e,`Sprites   : ${this.counters.get("sprites")}`,75*this.mod,17*this.mod),this.font.draw(e,`Velocity  : ${this.counters.get("velocity")}`,150*this.mod,17*this.mod),this.font.draw(e,`Bounds : ${this.counters.get("bounds")}`,225*this.mod,17*this.mod),this.font.draw(e,`Children : ${this.counters.get("children")}`,325*this.mod,17*this.mod);const t=this.width-5;this.drawMemoryGraph(e,t-this.help_str_len),this.font.textAlign="right",this.font.draw(e,this.help_str,t,17*this.mod);const i=`${me.timer.fps}/${me.sys.fps} fps`;this.font.draw(e,i,t,2*this.mod),e.restore()},onDestroyEvent(){this.hide(),me.input.unbindKey(this.toggleKey),me.event.unsubscribe(this.keyHandler)}});me.debug.Panel=me.plugin.Base.extend({init(e){this._super(me.plugin.Base,"init"),this.panel=new n(e),!0===me.game.HASH.debug&&this.show()},show(){this.panel.show()},hide(){this.panel.hide()},toggle(){this.panel.visible?this.panel.hide():this.panel.show()}})}(),function(e,t){"function"==typeof define&&define.amd?define([],t(e)):"object"==typeof exports?module.exports=t(e):e.iziToast=t(e)}("undefined"!=typeof global?global:window||this.window||this.global,function(e){"use strict";var t={},i="iziToast",n=(document.querySelector("body"),!!/Mobi/.test(navigator.userAgent)),o=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),r="undefined"!=typeof InstallTrigger,s="ontouchstart"in document.documentElement,a=["bottomRight","bottomLeft","bottomCenter","topRight","topLeft","topCenter","center"],h=568,l={},c={id:null,class:"",title:"",titleColor:"",titleSize:"",titleLineHeight:"",message:"",messageColor:"",messageSize:"",messageLineHeight:"",backgroundColor:"",theme:"light",color:"",icon:"",iconText:"",iconColor:"",image:"",imageWidth:50,maxWidth:null,zindex:null,layout:1,balloon:!1,close:!0,closeOnEscape:!1,rtl:!1,position:"bottomRight",target:"",targetFirst:!0,toastOnce:!1,timeout:5e3,animateInside:!0,drag:!0,pauseOnHover:!0,resetOnHover:!1,progressBar:!0,progressBarColor:"",progressBarEasing:"linear",overlay:!1,overlayClose:!1,overlayColor:"rgba(0, 0, 0, 0.6)",transitionIn:"fadeInUp",transitionOut:"fadeOut",transitionInMobile:"fadeInUp",transitionOutMobile:"fadeOutDown",buttons:{},inputs:{},onOpening:function(){},onOpened:function(){},onClosing:function(){},onClosed:function(){}};if("remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),"function"!=typeof window.CustomEvent){var u=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i};u.prototype=window.Event.prototype,window.CustomEvent=u}var d=function(e,t,i){if("[object Object]"===Object.prototype.toString.call(e))for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(i,e[n],n,e);else if(e)for(var o=0,r=e.length;r>o;o++)t.call(i,e[o],o,e)},p=function(e,t){var i={};return d(e,function(t,n){i[n]=e[n]}),d(t,function(e,n){i[n]=t[n]}),i},m=function(e){var t=document.createDocumentFragment(),i=document.createElement("div");for(i.innerHTML=e;i.firstChild;)t.appendChild(i.firstChild);return t},f={move:function(e,t,n,s){var a,h=180;0!==s&&(e.classList.add(i+"-dragged"),e.style.transform="translateX("+s+"px)",s>0?.3>(a=(h-s)/h)&&t.hide(p(n,{transitionOut:"fadeOutRight",transitionOutMobile:"fadeOutRight"}),e,"drag"):.3>(a=(h+s)/h)&&t.hide(p(n,{transitionOut:"fadeOutLeft",transitionOutMobile:"fadeOutLeft"}),e,"drag"),e.style.opacity=a,.3>a&&((o||r)&&(e.style.left=s+"px"),e.parentNode.style.opacity=.3,this.stopMoving(e,null)))},startMoving:function(e,t,i,n){n=n||window.event;var o=s?n.touches[0].clientX:n.clientX,r=e.style.transform.replace("px)",""),a=o-(r=r.replace("translateX(",""));e.classList.remove(i.transitionIn),e.classList.remove(i.transitionInMobile),e.style.transition="",s?document.ontouchmove=function(n){n.preventDefault();var o=(n=n||window.event).touches[0].clientX-a;f.move(e,t,i,o)}:document.onmousemove=function(n){n.preventDefault();var o=(n=n||window.event).clientX-a;f.move(e,t,i,o)}},stopMoving:function(e,t){s?document.ontouchmove=function(){}:document.onmousemove=function(){},e.style.opacity="",e.style.transform="",e.classList.contains(i+"-dragged")&&(e.classList.remove(i+"-dragged"),e.style.transition="transform 0.4s ease, opacity 0.4s ease",setTimeout(function(){e.style.transition=""},400))}};return t.destroy=function(){d(document.querySelectorAll("."+i+"-wrapper"),function(e,t){e.remove()}),d(document.querySelectorAll("."+i),function(e,t){e.remove()}),document.removeEventListener(i+"-opened",{},!1),document.removeEventListener(i+"-opening",{},!1),document.removeEventListener(i+"-closing",{},!1),document.removeEventListener(i+"-closed",{},!1),document.removeEventListener("keyup",{},!1),l={}},t.settings=function(e){t.destroy(),l=e,c=p(c,e||{})},d({info:{color:"blue",icon:"ico-info"},success:{color:"green",icon:"ico-success"},warning:{color:"orange",icon:"ico-warning"},error:{color:"red",icon:"ico-error"},question:{color:"yellow",icon:"ico-question"}},function(e,i){t[i]=function(t){var i=p(l,t||{});i=p(e,i||{}),this.show(i)}}),t.progress=function(e,t,n){var o=this,r=p(o.settings,e||{}),s=t.querySelector("."+i+"-progressbar div");return{start:function(){null!==s&&(s.style.transition="width "+r.timeout+"ms "+r.progressBarEasing,s.style.width="0%"),r.TIME.START=(new Date).getTime(),r.TIME.END=r.TIME.START+r.timeout,r.TIME.TIMER=setTimeout(function(){clearTimeout(r.TIME.TIMER),t.classList.contains(i+"-closing")||(o.hide(r,t,"timeout"),"function"==typeof n&&n.apply(o))},r.timeout)},pause:function(){if(r.TIME.REMAINING=r.TIME.END-(new Date).getTime(),clearTimeout(r.TIME.TIMER),null!==s){var e=window.getComputedStyle(s).getPropertyValue("width");s.style.transition="none",s.style.width=e}"function"==typeof n&&setTimeout(function(){n.apply(o)},10)},resume:function(){null!==s&&(s.style.transition="width "+r.TIME.REMAINING+"ms "+r.progressBarEasing,s.style.width="0%"),r.TIME.END=(new Date).getTime()+r.TIME.REMAINING,r.TIME.TIMER=setTimeout(function(){clearTimeout(r.TIME.TIMER),t.classList.contains(i+"-closing")||(o.hide(r,t,"timeout"),"function"==typeof n&&n.apply(o))},r.TIME.REMAINING)},reset:function(){clearTimeout(r.TIME.TIMER),null!==s&&(s.style.transition="none",s.style.width="100%"),"function"==typeof n&&setTimeout(function(){n.apply(o)},10)}}},t.hide=function(e,t,o){var r=p(this.settings,e||{});o=o||null,"object"!=typeof t&&(t=document.querySelector(t)),t.classList.add(i+"-closing"),r.closedBy=o,r.REF=t.getAttribute("data-iziToast-ref"),function(){var e=document.querySelector("."+i+"-overlay");if(null!==e){var t=e.getAttribute("data-iziToast-ref"),n=(t=t.split(",")).indexOf(r.REF);-1!==n&&t.splice(n,1),e.setAttribute("data-iziToast-ref",t.join()),0===t.length&&(e.classList.remove("fadeIn"),e.classList.add("fadeOut"),setTimeout(function(){e.remove()},700))}}(),(r.transitionIn||r.transitionInMobile)&&(t.classList.remove(r.transitionIn),t.classList.remove(r.transitionInMobile)),n||window.innerWidth<=h?r.transitionOutMobile&&t.classList.add(r.transitionOutMobile):r.transitionOut&&t.classList.add(r.transitionOut);var s=t.parentNode.offsetHeight;t.parentNode.style.height=s+"px",t.style.pointerEvents="none",(!n||window.innerWidth>h)&&(t.parentNode.style.transitionDelay="0.2s");try{r.closedBy=o;var a=new CustomEvent(i+"-closing",{detail:r,bubbles:!0,cancelable:!0});document.dispatchEvent(a)}catch(e){console.warn(e)}setTimeout(function(){t.parentNode.style.height="0px",t.parentNode.style.overflow="",setTimeout(function(){t.parentNode.remove();try{r.closedBy=o;var e=new CustomEvent(i+"-closed",{detail:r,bubbles:!0,cancelable:!0});document.dispatchEvent(e)}catch(e){console.warn(e)}void 0!==r.onClosed&&r.onClosed.apply(null,[r,t,o])},1e3)},200),void 0!==r.onClosing&&r.onClosing.apply(null,[r,t,o])},t.show=function(e){var t=this,o=p(l,e||{});if((o=p(c,o)).TIME={},o.toastOnce&&o.id&&document.querySelectorAll("."+i+"#"+o.id).length>0)return!1;o.REF=(new Date).getTime()+Math.floor(1e7*Math.random()+1);var r,u={body:document.querySelector("body"),overlay:document.createElement("div"),toast:document.createElement("div"),toastBody:document.createElement("div"),toastTexts:document.createElement("div"),toastCapsule:document.createElement("div"),icon:document.createElement("i"),cover:document.createElement("div"),buttons:document.createElement("div"),inputs:document.createElement("div"),wrapper:null};u.toast.setAttribute("data-iziToast-ref",o.REF),u.toast.appendChild(u.toastBody),u.toastCapsule.appendChild(u.toast),function(){if(u.toast.classList.add(i),u.toast.classList.add(i+"-opening"),u.toastCapsule.classList.add(i+"-capsule"),u.toastBody.classList.add(i+"-body"),u.toastTexts.classList.add(i+"-texts"),n||window.innerWidth<=h?o.transitionInMobile&&u.toast.classList.add(o.transitionInMobile):o.transitionIn&&u.toast.classList.add(o.transitionIn),o.class){var e=o.class.split(" ");d(e,function(e,t){u.toast.classList.add(e)})}o.id&&(u.toast.id=o.id),o.rtl&&u.toast.classList.add(i+"-rtl"),o.layout>1&&u.toast.classList.add(i+"-layout"+o.layout),o.balloon&&u.toast.classList.add(i+"-balloon"),o.maxWidth&&(isNaN(o.maxWidth)?u.toast.style.maxWidth=o.maxWidth:u.toast.style.maxWidth=o.maxWidth+"px"),""===o.theme&&"light"===o.theme||u.toast.classList.add(i+"-theme-"+o.theme),o.color&&(function(e){return"#"==e.substring(0,1)||"rgb"==e.substring(0,3)||"hsl"==e.substring(0,3)}(o.color)?u.toast.style.background=o.color:u.toast.classList.add(i+"-color-"+o.color)),o.backgroundColor&&(u.toast.style.background=o.backgroundColor,o.balloon&&(u.toast.style.borderColor=o.backgroundColor))}(),o.image&&(u.cover.classList.add(i+"-cover"),u.cover.style.width=o.imageWidth+"px",function(e){try{return btoa(atob(e))==e}catch(e){return!1}}(o.image.replace(/ /g,""))?u.cover.style.backgroundImage="url(data:image/png;base64,"+o.image.replace(/ /g,"")+")":u.cover.style.backgroundImage="url("+o.image+")",o.rtl?u.toastBody.style.marginRight=o.imageWidth+10+"px":u.toastBody.style.marginLeft=o.imageWidth+10+"px",u.toast.appendChild(u.cover)),o.close?(u.buttonClose=document.createElement("button"),u.buttonClose.classList.add(i+"-close"),u.buttonClose.addEventListener("click",function(e){e.target,t.hide(o,u.toast,"button")}),u.toast.appendChild(u.buttonClose)):o.rtl?u.toast.style.paddingLeft="18px":u.toast.style.paddingRight="18px",o.timeout&&(o.progressBar&&(u.progressBar=document.createElement("div"),u.progressBarDiv=document.createElement("div"),u.progressBar.classList.add(i+"-progressbar"),u.progressBarDiv.style.background=o.progressBarColor,u.progressBar.appendChild(u.progressBarDiv),u.toast.appendChild(u.progressBar)),o.pauseOnHover&&!o.resetOnHover&&(u.toast.addEventListener("mouseenter",function(e){this.classList.add(i+"-paused"),t.progress(o,u.toast).pause()}),u.toast.addEventListener("mouseleave",function(e){this.classList.remove(i+"-paused"),t.progress(o,u.toast).resume()})),o.resetOnHover&&(u.toast.addEventListener("mouseenter",function(e){this.classList.add(i+"-reseted"),t.progress(o,u.toast).reset()}),u.toast.addEventListener("mouseleave",function(e){this.classList.remove(i+"-reseted"),t.progress(o,u.toast).start()}))),o.icon&&(u.icon.setAttribute("class",i+"-icon "+o.icon),o.iconText&&u.icon.appendChild(document.createTextNode(o.iconText)),o.rtl?u.toastBody.style.paddingRight="33px":u.toastBody.style.paddingLeft="33px",o.iconColor&&(u.icon.style.color=o.iconColor),u.toastBody.appendChild(u.icon)),o.title.length>0&&(u.strong=document.createElement("strong"),u.strong.classList.add(i+"-title"),u.strong.appendChild(m(o.title)),u.toastTexts.appendChild(u.strong),o.titleColor&&(u.strong.style.color=o.titleColor),o.titleSize&&(isNaN(o.titleSize)?u.strong.style.fontSize=o.titleSize:u.strong.style.fontSize=o.titleSize+"px"),o.titleLineHeight&&(isNaN(o.titleSize)?u.strong.style.lineHeight=o.titleLineHeight:u.strong.style.lineHeight=o.titleLineHeight+"px")),o.message.length>0&&(u.p=document.createElement("p"),u.p.classList.add(i+"-message"),u.p.appendChild(m(o.message)),u.toastTexts.appendChild(u.p),o.messageColor&&(u.p.style.color=o.messageColor),o.messageSize&&(isNaN(o.titleSize)?u.p.style.fontSize=o.messageSize:u.p.style.fontSize=o.messageSize+"px"),o.messageLineHeight&&(isNaN(o.titleSize)?u.p.style.lineHeight=o.messageLineHeight:u.p.style.lineHeight=o.messageLineHeight+"px")),o.title.length>0&&o.message.length>0&&(o.rtl?u.strong.style.marginLeft="10px":2===o.layout||o.rtl||(u.strong.style.marginRight="10px")),u.toastBody.appendChild(u.toastTexts),o.inputs.length>0&&(u.inputs.classList.add(i+"-inputs"),d(o.inputs,function(e,n){u.inputs.appendChild(m(e[0])),(r=u.inputs.childNodes)[n].classList.add(i+"-inputs-child"),e[3]&&setTimeout(function(){r[n].focus()},300),r[n].addEventListener(e[1],function(i){return(0,e[2])(t,u.toast,this,i)})})),u.toastBody.appendChild(u.inputs),o.buttons.length>0&&(u.buttons.classList.add(i+"-buttons"),d(o.buttons,function(e,n){u.buttons.appendChild(m(e[0]));var o=u.buttons.childNodes;o[n].classList.add(i+"-buttons-child"),e[2]&&setTimeout(function(){o[n].focus()},300),o[n].addEventListener("click",function(i){return i.preventDefault(),(0,e[1])(t,u.toast,this,i,r)})})),u.toastBody.appendChild(u.buttons),o.message.length>0&&(o.inputs.length>0||o.buttons.length>0)&&(u.p.style.marginBottom="0"),(o.inputs.length>0||o.buttons.length>0)&&(o.rtl?u.toastTexts.style.marginLeft="10px":u.toastTexts.style.marginRight="10px",o.inputs.length>0&&o.buttons.length>0&&(o.rtl?u.inputs.style.marginLeft="8px":u.inputs.style.marginRight="8px")),u.toastCapsule.style.visibility="hidden",setTimeout(function(){var e=u.toast.offsetHeight,i=u.toast.currentStyle||window.getComputedStyle(u.toast),n=i.marginTop;n=n.split("px"),n=parseInt(n[0]);var r=i.marginBottom;r=r.split("px"),r=parseInt(r[0]),u.toastCapsule.style.visibility="",u.toastCapsule.style.height=e+r+n+"px",setTimeout(function(){u.toastCapsule.style.height="auto",o.target&&(u.toastCapsule.style.overflow="visible")},500),o.timeout&&t.progress(o,u.toast).start()},100),function(){var e=o.position;if(o.target)u.wrapper=document.querySelector(o.target),u.wrapper.classList.add(i+"-target"),o.targetFirst?u.wrapper.insertBefore(u.toastCapsule,u.wrapper.firstChild):u.wrapper.appendChild(u.toastCapsule);else{if(-1==a.indexOf(o.position))return void console.warn("["+i+"] Incorrect position.\nIt can be  "+a);e=n||window.innerWidth<=h?"bottomLeft"==o.position||"bottomRight"==o.position||"bottomCenter"==o.position?i+"-wrapper-bottomCenter":"topLeft"==o.position||"topRight"==o.position||"topCenter"==o.position?i+"-wrapper-topCenter":i+"-wrapper-center":i+"-wrapper-"+e,u.wrapper=document.querySelector("."+i+"-wrapper."+e),u.wrapper||(u.wrapper=document.createElement("div"),u.wrapper.classList.add(i+"-wrapper"),u.wrapper.classList.add(e),document.body.appendChild(u.wrapper)),"topLeft"==o.position||"topCenter"==o.position||"topRight"==o.position?u.wrapper.insertBefore(u.toastCapsule,u.wrapper.firstChild):u.wrapper.appendChild(u.toastCapsule)}isNaN(o.zindex)?console.warn("["+i+"] Invalid zIndex."):u.wrapper.style.zIndex=o.zindex}(),o.overlay&&(null!==document.querySelector("."+i+"-overlay.fadeIn")?(u.overlay=document.querySelector("."+i+"-overlay"),u.overlay.setAttribute("data-iziToast-ref",u.overlay.getAttribute("data-iziToast-ref")+","+o.REF),isNaN(o.zindex)||null===o.zindex||(u.overlay.style.zIndex=o.zindex-1)):(u.overlay.classList.add(i+"-overlay"),u.overlay.classList.add("fadeIn"),u.overlay.style.background=o.overlayColor,u.overlay.setAttribute("data-iziToast-ref",o.REF),isNaN(o.zindex)||null===o.zindex||(u.overlay.style.zIndex=o.zindex-1),document.querySelector("body").appendChild(u.overlay)),o.overlayClose?(u.overlay.removeEventListener("click",{}),u.overlay.addEventListener("click",function(e){t.hide(o,u.toast,"overlay")})):u.overlay.removeEventListener("click",{})),function(){if(o.animateInside){u.toast.classList.add(i+"-animateInside");var e=[200,100,300];"bounceInLeft"!=o.transitionIn&&"bounceInRight"!=o.transitionIn||(e=[400,200,400]),o.title.length>0&&setTimeout(function(){u.strong.classList.add("slideIn")},e[0]),o.message.length>0&&setTimeout(function(){u.p.classList.add("slideIn")},e[1]),o.icon&&setTimeout(function(){u.icon.classList.add("revealIn")},e[2]);var t=150;o.buttons.length>0&&u.buttons&&setTimeout(function(){d(u.buttons.childNodes,function(e,i){setTimeout(function(){e.classList.add("revealIn")},t),t+=150})},o.inputs.length>0?150:0),o.inputs.length>0&&u.inputs&&(t=150,d(u.inputs.childNodes,function(e,i){setTimeout(function(){e.classList.add("revealIn")},t),t+=150}))}}(),o.onOpening.apply(null,[o,u.toast]);try{var g=new CustomEvent(i+"-opening",{detail:o,bubbles:!0,cancelable:!0});document.dispatchEvent(g)}catch(e){console.warn(e)}setTimeout(function(){u.toast.classList.remove(i+"-opening"),u.toast.classList.add(i+"-opened");try{var e=new CustomEvent(i+"-opened",{detail:o,bubbles:!0,cancelable:!0});document.dispatchEvent(e)}catch(e){console.warn(e)}o.onOpened.apply(null,[o,u.toast])},1e3),o.drag&&(s?(u.toast.addEventListener("touchstart",function(e){f.startMoving(this,t,o,e)},!1),u.toast.addEventListener("touchend",function(e){f.stopMoving(this,e)},!1)):(u.toast.addEventListener("mousedown",function(e){e.preventDefault(),f.startMoving(this,t,o,e)},!1),u.toast.addEventListener("mouseup",function(e){e.preventDefault(),f.stopMoving(this,e)},!1))),o.closeOnEscape&&document.addEventListener("keyup",function(e){27==(e=e||window.event).keyCode&&t.hide(o,u.toast,"esc")}),t.toast=u.toast},t}),function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var i=[],n=e.document,o=Object.getPrototypeOf,r=i.slice,s=i.concat,a=i.push,h=i.indexOf,l={},c=l.toString,u=l.hasOwnProperty,d=u.toString,p=d.call(Object),m={},f=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},g=function(e){return null!=e&&e===e.window},y={type:!0,src:!0,noModule:!0};function v(e,t,i){var o,r=(t=t||n).createElement("script");if(r.text=e,i)for(o in y)i[o]&&(r[o]=i[o]);t.head.appendChild(r).parentNode.removeChild(r)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e}var b=function(e,t){return new b.fn.init(e,t)},x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function E(e){var t=!!e&&"length"in e&&e.length,i=w(e);return!f(e)&&!g(e)&&("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e)}b.fn=b.prototype={jquery:"3.3.1",constructor:b,length:0,toArray:function(){return r.call(this)},get:function(e){return null==e?r.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=b.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return b.each(this,e)},map:function(e){return this.pushStack(b.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:i.sort,splice:i.splice},b.extend=b.fn.extend=function(){var e,t,i,n,o,r,s=arguments[0]||{},a=1,h=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||f(s)||(s={}),a===h&&(s=this,a--);a<h;a++)if(null!=(e=arguments[a]))for(t in e)i=s[t],s!==(n=e[t])&&(l&&n&&(b.isPlainObject(n)||(o=Array.isArray(n)))?(o?(o=!1,r=i&&Array.isArray(i)?i:[]):r=i&&b.isPlainObject(i)?i:{},s[t]=b.extend(l,r,n)):void 0!==n&&(s[t]=n));return s},b.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,i;return!(!e||"[object Object]"!==c.call(e)||(t=o(e))&&("function"!=typeof(i=u.call(t,"constructor")&&t.constructor)||d.call(i)!==p))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){v(e)},each:function(e,t){var i,n=0;if(E(e))for(i=e.length;n<i&&!1!==t.call(e[n],n,e[n]);n++);else for(n in e)if(!1===t.call(e[n],n,e[n]))break;return e},trim:function(e){return null==e?"":(e+"").replace(x,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(E(Object(e))?b.merge(i,"string"==typeof e?[e]:e):a.call(i,e)),i},inArray:function(e,t,i){return null==t?-1:h.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,o=e.length;n<i;n++)e[o++]=t[n];return e.length=o,e},grep:function(e,t,i){for(var n=[],o=0,r=e.length,s=!i;o<r;o++)!t(e[o],o)!==s&&n.push(e[o]);return n},map:function(e,t,i){var n,o,r=0,a=[];if(E(e))for(n=e.length;r<n;r++)null!=(o=t(e[r],r,i))&&a.push(o);else for(r in e)null!=(o=t(e[r],r,i))&&a.push(o);return s.apply([],a)},guid:1,support:m}),"function"==typeof Symbol&&(b.fn[Symbol.iterator]=i[Symbol.iterator]),b.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});var _=function(e){var t,i,n,o,r,s,a,h,l,c,u,d,p,m,f,g,y,v,w,b="sizzle"+1*new Date,x=e.document,E=0,_=0,T=se(),C=se(),A=se(),S=function(e,t){return e===t&&(u=!0),0},k={}.hasOwnProperty,P=[],O=P.pop,R=P.push,M=P.push,B=P.slice,I=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},L="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",D="[\\x20\\t\\r\\n\\f]",N="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",F="\\["+D+"*("+N+")(?:"+D+"*([*^$|!~]?=)"+D+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+D+"*\\]",j=":("+N+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+F+")*)|.*)\\)|)",U=new RegExp(D+"+","g"),z=new RegExp("^"+D+"+|((?:^|[^\\\\])(?:\\\\.)*)"+D+"+$","g"),V=new RegExp("^"+D+"*,"+D+"*"),H=new RegExp("^"+D+"*([>+~]|"+D+")"+D+"*"),q=new RegExp("="+D+"*([^\\]'\"]*?)"+D+"*\\]","g"),K=new RegExp(j),W=new RegExp("^"+N+"$"),Y={ID:new RegExp("^#("+N+")"),CLASS:new RegExp("^\\.("+N+")"),TAG:new RegExp("^("+N+"|[*])"),ATTR:new RegExp("^"+F),PSEUDO:new RegExp("^"+j),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+D+"*(even|odd|(([+-]|)(\\d*)n|)"+D+"*(?:([+-]|)"+D+"*(\\d+)|))"+D+"*\\)|)","i"),bool:new RegExp("^(?:"+L+")$","i"),needsContext:new RegExp("^"+D+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+D+"*((?:-\\d)?\\d*)"+D+"*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,G=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/[+~]/,Z=new RegExp("\\\\([\\da-f]{1,6}"+D+"?|("+D+")|.)","ig"),ee=function(e,t,i){var n="0x"+t-65536;return n!=n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},te=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ne=function(){d()},oe=ve(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{M.apply(P=B.call(x.childNodes),x.childNodes),P[x.childNodes.length].nodeType}catch(e){M={apply:P.length?function(e,t){R.apply(e,B.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}function re(e,t,n,o){var r,a,l,c,u,m,y,v=t&&t.ownerDocument,E=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==E&&9!==E&&11!==E)return n;if(!o&&((t?t.ownerDocument||t:x)!==p&&d(t),t=t||p,f)){if(11!==E&&(u=J.exec(e)))if(r=u[1]){if(9===E){if(!(l=t.getElementById(r)))return n;if(l.id===r)return n.push(l),n}else if(v&&(l=v.getElementById(r))&&w(t,l)&&l.id===r)return n.push(l),n}else{if(u[2])return M.apply(n,t.getElementsByTagName(e)),n;if((r=u[3])&&i.getElementsByClassName&&t.getElementsByClassName)return M.apply(n,t.getElementsByClassName(r)),n}if(i.qsa&&!A[e+" "]&&(!g||!g.test(e))){if(1!==E)v=t,y=e;else if("object"!==t.nodeName.toLowerCase()){for((c=t.getAttribute("id"))?c=c.replace(te,ie):t.setAttribute("id",c=b),a=(m=s(e)).length;a--;)m[a]="#"+c+" "+ye(m[a]);y=m.join(","),v=Q.test(e)&&fe(t.parentNode)||t}if(y)try{return M.apply(n,v.querySelectorAll(y)),n}catch(e){}finally{c===b&&t.removeAttribute("id")}}}return h(e.replace(z,"$1"),t,n,o)}function se(){var e=[];return function t(i,o){return e.push(i+" ")>n.cacheLength&&delete t[e.shift()],t[i+" "]=o}}function ae(e){return e[b]=!0,e}function he(e){var t=p.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){for(var i=e.split("|"),o=i.length;o--;)n.attrHandle[i[o]]=t}function ce(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function ue(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function de(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function pe(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&oe(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return ae(function(t){return t=+t,ae(function(i,n){for(var o,r=e([],i.length,t),s=r.length;s--;)i[o=r[s]]&&(i[o]=!(n[o]=i[o]))})})}function fe(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in i=re.support={},r=re.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},d=re.setDocument=function(e){var t,o,s=e?e.ownerDocument||e:x;return s!==p&&9===s.nodeType&&s.documentElement?(m=(p=s).documentElement,f=!r(p),x!==p&&(o=p.defaultView)&&o.top!==o&&(o.addEventListener?o.addEventListener("unload",ne,!1):o.attachEvent&&o.attachEvent("onunload",ne)),i.attributes=he(function(e){return e.className="i",!e.getAttribute("className")}),i.getElementsByTagName=he(function(e){return e.appendChild(p.createComment("")),!e.getElementsByTagName("*").length}),i.getElementsByClassName=$.test(p.getElementsByClassName),i.getById=he(function(e){return m.appendChild(e).id=b,!p.getElementsByName||!p.getElementsByName(b).length}),i.getById?(n.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){return e.getAttribute("id")===t}},n.find.ID=function(e,t){if(void 0!==t.getElementById&&f){var i=t.getElementById(e);return i?[i]:[]}}):(n.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){var i=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}},n.find.ID=function(e,t){if(void 0!==t.getElementById&&f){var i,n,o,r=t.getElementById(e);if(r){if((i=r.getAttributeNode("id"))&&i.value===e)return[r];for(o=t.getElementsByName(e),n=0;r=o[n++];)if((i=r.getAttributeNode("id"))&&i.value===e)return[r]}return[]}}),n.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],o=0,r=t.getElementsByTagName(e);if("*"===e){for(;i=r[o++];)1===i.nodeType&&n.push(i);return n}return r},n.find.CLASS=i.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&f)return t.getElementsByClassName(e)},y=[],g=[],(i.qsa=$.test(p.querySelectorAll))&&(he(function(e){m.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+D+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||g.push("\\["+D+"*(?:value|"+L+")"),e.querySelectorAll("[id~="+b+"-]").length||g.push("~="),e.querySelectorAll(":checked").length||g.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||g.push(".#.+[+~]")}),he(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=p.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&g.push("name"+D+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),m.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")})),(i.matchesSelector=$.test(v=m.matches||m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&he(function(e){i.disconnectedMatch=v.call(e,"*"),v.call(e,"[s!='']:x"),y.push("!=",j)}),g=g.length&&new RegExp(g.join("|")),y=y.length&&new RegExp(y.join("|")),t=$.test(m.compareDocumentPosition),w=t||$.test(m.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},S=t?function(e,t){if(e===t)return u=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!i.sortDetached&&t.compareDocumentPosition(e)===n?e===p||e.ownerDocument===x&&w(x,e)?-1:t===p||t.ownerDocument===x&&w(x,t)?1:c?I(c,e)-I(c,t):0:4&n?-1:1)}:function(e,t){if(e===t)return u=!0,0;var i,n=0,o=e.parentNode,r=t.parentNode,s=[e],a=[t];if(!o||!r)return e===p?-1:t===p?1:o?-1:r?1:c?I(c,e)-I(c,t):0;if(o===r)return ce(e,t);for(i=e;i=i.parentNode;)s.unshift(i);for(i=t;i=i.parentNode;)a.unshift(i);for(;s[n]===a[n];)n++;return n?ce(s[n],a[n]):s[n]===x?-1:a[n]===x?1:0},p):p},re.matches=function(e,t){return re(e,null,null,t)},re.matchesSelector=function(e,t){if((e.ownerDocument||e)!==p&&d(e),t=t.replace(q,"='$1']"),i.matchesSelector&&f&&!A[t+" "]&&(!y||!y.test(t))&&(!g||!g.test(t)))try{var n=v.call(e,t);if(n||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return re(t,p,null,[e]).length>0},re.contains=function(e,t){return(e.ownerDocument||e)!==p&&d(e),w(e,t)},re.attr=function(e,t){(e.ownerDocument||e)!==p&&d(e);var o=n.attrHandle[t.toLowerCase()],r=o&&k.call(n.attrHandle,t.toLowerCase())?o(e,t,!f):void 0;return void 0!==r?r:i.attributes||!f?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},re.escape=function(e){return(e+"").replace(te,ie)},re.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},re.uniqueSort=function(e){var t,n=[],o=0,r=0;if(u=!i.detectDuplicates,c=!i.sortStable&&e.slice(0),e.sort(S),u){for(;t=e[r++];)t===e[r]&&(o=n.push(r));for(;o--;)e.splice(n[o],1)}return c=null,e},o=re.getText=function(e){var t,i="",n=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=o(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[n++];)i+=o(t);return i},(n=re.selectors={cacheLength:50,createPseudo:ae,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Z,ee),e[3]=(e[3]||e[4]||e[5]||"").replace(Z,ee),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||re.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&re.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return Y.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&K.test(i)&&(t=s(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Z,ee).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=new RegExp("(^|"+D+")"+e+"("+D+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,i){return function(n){var o=re.attr(n,e);return null==o?"!="===t:!t||(o+="","="===t?o===i:"!="===t?o!==i:"^="===t?i&&0===o.indexOf(i):"*="===t?i&&o.indexOf(i)>-1:"$="===t?i&&o.slice(-i.length)===i:"~="===t?(" "+o.replace(U," ")+" ").indexOf(i)>-1:"|="===t&&(o===i||o.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,i,n,o){var r="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===n&&0===o?function(e){return!!e.parentNode}:function(t,i,h){var l,c,u,d,p,m,f=r!==s?"nextSibling":"previousSibling",g=t.parentNode,y=a&&t.nodeName.toLowerCase(),v=!h&&!a,w=!1;if(g){if(r){for(;f;){for(d=t;d=d[f];)if(a?d.nodeName.toLowerCase()===y:1===d.nodeType)return!1;m=f="only"===e&&!m&&"nextSibling"}return!0}if(m=[s?g.firstChild:g.lastChild],s&&v){for(w=(p=(l=(c=(u=(d=g)[b]||(d[b]={}))[d.uniqueID]||(u[d.uniqueID]={}))[e]||[])[0]===E&&l[1])&&l[2],d=p&&g.childNodes[p];d=++p&&d&&d[f]||(w=p=0)||m.pop();)if(1===d.nodeType&&++w&&d===t){c[e]=[E,p,w];break}}else if(v&&(w=p=(l=(c=(u=(d=t)[b]||(d[b]={}))[d.uniqueID]||(u[d.uniqueID]={}))[e]||[])[0]===E&&l[1]),!1===w)for(;(d=++p&&d&&d[f]||(w=p=0)||m.pop())&&((a?d.nodeName.toLowerCase()!==y:1!==d.nodeType)||!++w||(v&&((c=(u=d[b]||(d[b]={}))[d.uniqueID]||(u[d.uniqueID]={}))[e]=[E,w]),d!==t)););return(w-=o)===n||w%n==0&&w/n>=0}}},PSEUDO:function(e,t){var i,o=n.pseudos[e]||n.setFilters[e.toLowerCase()]||re.error("unsupported pseudo: "+e);return o[b]?o(t):o.length>1?(i=[e,e,"",t],n.setFilters.hasOwnProperty(e.toLowerCase())?ae(function(e,i){for(var n,r=o(e,t),s=r.length;s--;)e[n=I(e,r[s])]=!(i[n]=r[s])}):function(e){return o(e,0,i)}):o}},pseudos:{not:ae(function(e){var t=[],i=[],n=a(e.replace(z,"$1"));return n[b]?ae(function(e,t,i,o){for(var r,s=n(e,null,o,[]),a=e.length;a--;)(r=s[a])&&(e[a]=!(t[a]=r))}):function(e,o,r){return t[0]=e,n(t,null,r,i),t[0]=null,!i.pop()}}),has:ae(function(e){return function(t){return re(e,t).length>0}}),contains:ae(function(e){return e=e.replace(Z,ee),function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:ae(function(e){return W.test(e||"")||re.error("unsupported lang: "+e),e=e.replace(Z,ee).toLowerCase(),function(t){var i;do{if(i=f?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===m},focus:function(e){return e===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:pe(!1),disabled:pe(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!n.pseudos.empty(e)},header:function(e){return G.test(e.nodeName)},input:function(e){return X.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me(function(){return[0]}),last:me(function(e,t){return[t-1]}),eq:me(function(e,t,i){return[i<0?i+t:i]}),even:me(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:me(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:me(function(e,t,i){for(var n=i<0?i+t:i;--n>=0;)e.push(n);return e}),gt:me(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}}).pseudos.nth=n.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})n.pseudos[t]=ue(t);for(t in{submit:!0,reset:!0})n.pseudos[t]=de(t);function ge(){}function ye(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function ve(e,t,i){var n=t.dir,o=t.next,r=o||n,s=i&&"parentNode"===r,a=_++;return t.first?function(t,i,o){for(;t=t[n];)if(1===t.nodeType||s)return e(t,i,o);return!1}:function(t,i,h){var l,c,u,d=[E,a];if(h){for(;t=t[n];)if((1===t.nodeType||s)&&e(t,i,h))return!0}else for(;t=t[n];)if(1===t.nodeType||s)if(c=(u=t[b]||(t[b]={}))[t.uniqueID]||(u[t.uniqueID]={}),o&&o===t.nodeName.toLowerCase())t=t[n]||t;else{if((l=c[r])&&l[0]===E&&l[1]===a)return d[2]=l[2];if(c[r]=d,d[2]=e(t,i,h))return!0}return!1}}function we(e){return e.length>1?function(t,i,n){for(var o=e.length;o--;)if(!e[o](t,i,n))return!1;return!0}:e[0]}function be(e,t,i,n,o){for(var r,s=[],a=0,h=e.length,l=null!=t;a<h;a++)(r=e[a])&&(i&&!i(r,n,o)||(s.push(r),l&&t.push(a)));return s}function xe(e,t,i,n,o,r){return n&&!n[b]&&(n=xe(n)),o&&!o[b]&&(o=xe(o,r)),ae(function(r,s,a,h){var l,c,u,d=[],p=[],m=s.length,f=r||function(e,t,i){for(var n=0,o=t.length;n<o;n++)re(e,t[n],i);return i}(t||"*",a.nodeType?[a]:a,[]),g=!e||!r&&t?f:be(f,d,e,a,h),y=i?o||(r?e:m||n)?[]:s:g;if(i&&i(g,y,a,h),n)for(l=be(y,p),n(l,[],a,h),c=l.length;c--;)(u=l[c])&&(y[p[c]]=!(g[p[c]]=u));if(r){if(o||e){if(o){for(l=[],c=y.length;c--;)(u=y[c])&&l.push(g[c]=u);o(null,y=[],l,h)}for(c=y.length;c--;)(u=y[c])&&(l=o?I(r,u):d[c])>-1&&(r[l]=!(s[l]=u))}}else y=be(y===s?y.splice(m,y.length):y),o?o(null,s,y,h):M.apply(s,y)})}function Ee(e){for(var t,i,o,r=e.length,s=n.relative[e[0].type],a=s||n.relative[" "],h=s?1:0,c=ve(function(e){return e===t},a,!0),u=ve(function(e){return I(t,e)>-1},a,!0),d=[function(e,i,n){var o=!s&&(n||i!==l)||((t=i).nodeType?c(e,i,n):u(e,i,n));return t=null,o}];h<r;h++)if(i=n.relative[e[h].type])d=[ve(we(d),i)];else{if((i=n.filter[e[h].type].apply(null,e[h].matches))[b]){for(o=++h;o<r&&!n.relative[e[o].type];o++);return xe(h>1&&we(d),h>1&&ye(e.slice(0,h-1).concat({value:" "===e[h-2].type?"*":""})).replace(z,"$1"),i,h<o&&Ee(e.slice(h,o)),o<r&&Ee(e=e.slice(o)),o<r&&ye(e))}d.push(i)}return we(d)}function _e(e,t){var i=t.length>0,o=e.length>0,r=function(r,s,a,h,c){var u,m,g,y=0,v="0",w=r&&[],b=[],x=l,_=r||o&&n.find.TAG("*",c),T=E+=null==x?1:Math.random()||.1,C=_.length;for(c&&(l=s===p||s||c);v!==C&&null!=(u=_[v]);v++){if(o&&u){for(m=0,s||u.ownerDocument===p||(d(u),a=!f);g=e[m++];)if(g(u,s||p,a)){h.push(u);break}c&&(E=T)}i&&((u=!g&&u)&&y--,r&&w.push(u))}if(y+=v,i&&v!==y){for(m=0;g=t[m++];)g(w,b,s,a);if(r){if(y>0)for(;v--;)w[v]||b[v]||(b[v]=O.call(h));b=be(b)}M.apply(h,b),c&&!r&&b.length>0&&y+t.length>1&&re.uniqueSort(h)}return c&&(E=T,l=x),w};return i?ae(r):r}return ge.prototype=n.filters=n.pseudos,n.setFilters=new ge,s=re.tokenize=function(e,t){var i,o,r,s,a,h,l,c=C[e+" "];if(c)return t?0:c.slice(0);for(a=e,h=[],l=n.preFilter;a;){for(s in i&&!(o=V.exec(a))||(o&&(a=a.slice(o[0].length)||a),h.push(r=[])),i=!1,(o=H.exec(a))&&(i=o.shift(),r.push({value:i,type:o[0].replace(z," ")}),a=a.slice(i.length)),n.filter)!(o=Y[s].exec(a))||l[s]&&!(o=l[s](o))||(i=o.shift(),r.push({value:i,type:s,matches:o}),a=a.slice(i.length));if(!i)break}return t?a.length:a?re.error(e):C(e,h).slice(0)},a=re.compile=function(e,t){var i,n=[],o=[],r=A[e+" "];if(!r){for(t||(t=s(e)),i=t.length;i--;)(r=Ee(t[i]))[b]?n.push(r):o.push(r);(r=A(e,_e(o,n))).selector=e}return r},h=re.select=function(e,t,i,o){var r,h,l,c,u,d="function"==typeof e&&e,p=!o&&s(e=d.selector||e);if(i=i||[],1===p.length){if((h=p[0]=p[0].slice(0)).length>2&&"ID"===(l=h[0]).type&&9===t.nodeType&&f&&n.relative[h[1].type]){if(!(t=(n.find.ID(l.matches[0].replace(Z,ee),t)||[])[0]))return i;d&&(t=t.parentNode),e=e.slice(h.shift().value.length)}for(r=Y.needsContext.test(e)?0:h.length;r--&&(l=h[r],!n.relative[c=l.type]);)if((u=n.find[c])&&(o=u(l.matches[0].replace(Z,ee),Q.test(h[0].type)&&fe(t.parentNode)||t))){if(h.splice(r,1),!(e=o.length&&ye(h)))return M.apply(i,o),i;break}}return(d||a(e,p))(o,t,!f,i,!t||Q.test(e)&&fe(t.parentNode)||t),i},i.sortStable=b.split("").sort(S).join("")===b,i.detectDuplicates=!!u,d(),i.sortDetached=he(function(e){return 1&e.compareDocumentPosition(p.createElement("fieldset"))}),he(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||le("type|href|height|width",function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),i.attributes&&he(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||le("value",function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),he(function(e){return null==e.getAttribute("disabled")})||le(L,function(e,t,i){var n;if(!i)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),re}(e);b.find=_,b.expr=_.selectors,b.expr[":"]=b.expr.pseudos,b.uniqueSort=b.unique=_.uniqueSort,b.text=_.getText,b.isXMLDoc=_.isXML,b.contains=_.contains,b.escapeSelector=_.escape;var T=function(e,t,i){for(var n=[],o=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&b(e).is(i))break;n.push(e)}return n},C=function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i},A=b.expr.match.needsContext;function S(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var k=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function P(e,t,i){return f(t)?b.grep(e,function(e,n){return!!t.call(e,n,e)!==i}):t.nodeType?b.grep(e,function(e){return e===t!==i}):"string"!=typeof t?b.grep(e,function(e){return h.call(t,e)>-1!==i}):b.filter(t,e,i)}b.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?b.find.matchesSelector(n,e)?[n]:[]:b.find.matches(e,b.grep(t,function(e){return 1===e.nodeType}))},b.fn.extend({find:function(e){var t,i,n=this.length,o=this;if("string"!=typeof e)return this.pushStack(b(e).filter(function(){for(t=0;t<n;t++)if(b.contains(o[t],this))return!0}));for(i=this.pushStack([]),t=0;t<n;t++)b.find(e,o[t],i);return n>1?b.uniqueSort(i):i},filter:function(e){return this.pushStack(P(this,e||[],!1))},not:function(e){return this.pushStack(P(this,e||[],!0))},is:function(e){return!!P(this,"string"==typeof e&&A.test(e)?b(e):e||[],!1).length}});var O,R=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(b.fn.init=function(e,t,i){var o,r;if(!e)return this;if(i=i||O,"string"==typeof e){if(!(o="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:R.exec(e))||!o[1]&&t)return!t||t.jquery?(t||i).find(e):this.constructor(t).find(e);if(o[1]){if(t=t instanceof b?t[0]:t,b.merge(this,b.parseHTML(o[1],t&&t.nodeType?t.ownerDocument||t:n,!0)),k.test(o[1])&&b.isPlainObject(t))for(o in t)f(this[o])?this[o](t[o]):this.attr(o,t[o]);return this}return(r=n.getElementById(o[2]))&&(this[0]=r,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):f(e)?void 0!==i.ready?i.ready(e):e(b):b.makeArray(e,this)}).prototype=b.fn,O=b(n);var M=/^(?:parents|prev(?:Until|All))/,B={children:!0,contents:!0,next:!0,prev:!0};function I(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}b.fn.extend({has:function(e){var t=b(e,this),i=t.length;return this.filter(function(){for(var e=0;e<i;e++)if(b.contains(this,t[e]))return!0})},closest:function(e,t){var i,n=0,o=this.length,r=[],s="string"!=typeof e&&b(e);if(!A.test(e))for(;n<o;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(s?s.index(i)>-1:1===i.nodeType&&b.find.matchesSelector(i,e))){r.push(i);break}return this.pushStack(r.length>1?b.uniqueSort(r):r)},index:function(e){return e?"string"==typeof e?h.call(b(e),this[0]):h.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(b.uniqueSort(b.merge(this.get(),b(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),b.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return T(e,"parentNode")},parentsUntil:function(e,t,i){return T(e,"parentNode",i)},next:function(e){return I(e,"nextSibling")},prev:function(e){return I(e,"previousSibling")},nextAll:function(e){return T(e,"nextSibling")},prevAll:function(e){return T(e,"previousSibling")},nextUntil:function(e,t,i){return T(e,"nextSibling",i)},prevUntil:function(e,t,i){return T(e,"previousSibling",i)},siblings:function(e){return C((e.parentNode||{}).firstChild,e)},children:function(e){return C(e.firstChild)},contents:function(e){return S(e,"iframe")?e.contentDocument:(S(e,"template")&&(e=e.content||e),b.merge([],e.childNodes))}},function(e,t){b.fn[e]=function(i,n){var o=b.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=b.filter(n,o)),this.length>1&&(B[e]||b.uniqueSort(o),M.test(e)&&o.reverse()),this.pushStack(o)}});var L=/[^\x20\t\r\n\f]+/g;function D(e){return e}function N(e){throw e}function F(e,t,i,n){var o;try{e&&f(o=e.promise)?o.call(e).done(t).fail(i):e&&f(o=e.then)?o.call(e,t,i):t.apply(void 0,[e].slice(n))}catch(e){i.apply(void 0,[e])}}b.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return b.each(e.match(L)||[],function(e,i){t[i]=!0}),t}(e):b.extend({},e);var t,i,n,o,r=[],s=[],a=-1,h=function(){for(o=o||e.once,n=t=!0;s.length;a=-1)for(i=s.shift();++a<r.length;)!1===r[a].apply(i[0],i[1])&&e.stopOnFalse&&(a=r.length,i=!1);e.memory||(i=!1),t=!1,o&&(r=i?[]:"")},l={add:function(){return r&&(i&&!t&&(a=r.length-1,s.push(i)),function t(i){b.each(i,function(i,n){f(n)?e.unique&&l.has(n)||r.push(n):n&&n.length&&"string"!==w(n)&&t(n)})}(arguments),i&&!t&&h()),this},remove:function(){return b.each(arguments,function(e,t){for(var i;(i=b.inArray(t,r,i))>-1;)r.splice(i,1),i<=a&&a--}),this},has:function(e){return e?b.inArray(e,r)>-1:r.length>0},empty:function(){return r&&(r=[]),this},disable:function(){return o=s=[],r=i="",this},disabled:function(){return!r},lock:function(){return o=s=[],i||t||(r=i=""),this},locked:function(){return!!o},fireWith:function(e,i){return o||(i=[e,(i=i||[]).slice?i.slice():i],s.push(i),t||h()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},b.extend({Deferred:function(t){var i=[["notify","progress",b.Callbacks("memory"),b.Callbacks("memory"),2],["resolve","done",b.Callbacks("once memory"),b.Callbacks("once memory"),0,"resolved"],["reject","fail",b.Callbacks("once memory"),b.Callbacks("once memory"),1,"rejected"]],n="pending",o={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},catch:function(e){return o.then(null,e)},pipe:function(){var e=arguments;return b.Deferred(function(t){b.each(i,function(i,n){var o=f(e[n[4]])&&e[n[4]];r[n[1]](function(){var e=o&&o.apply(this,arguments);e&&f(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[n[0]+"With"](this,o?[e]:arguments)})}),e=null}).promise()},then:function(t,n,o){var r=0;function s(t,i,n,o){return function(){var a=this,h=arguments,l=function(){var e,l;if(!(t<r)){if((e=n.apply(a,h))===i.promise())throw new TypeError("Thenable self-resolution");l=e&&("object"==typeof e||"function"==typeof e)&&e.then,f(l)?o?l.call(e,s(r,i,D,o),s(r,i,N,o)):(r++,l.call(e,s(r,i,D,o),s(r,i,N,o),s(r,i,D,i.notifyWith))):(n!==D&&(a=void 0,h=[e]),(o||i.resolveWith)(a,h))}},c=o?l:function(){try{l()}catch(e){b.Deferred.exceptionHook&&b.Deferred.exceptionHook(e,c.stackTrace),t+1>=r&&(n!==N&&(a=void 0,h=[e]),i.rejectWith(a,h))}};t?c():(b.Deferred.getStackHook&&(c.stackTrace=b.Deferred.getStackHook()),e.setTimeout(c))}}return b.Deferred(function(e){i[0][3].add(s(0,e,f(o)?o:D,e.notifyWith)),i[1][3].add(s(0,e,f(t)?t:D)),i[2][3].add(s(0,e,f(n)?n:N))}).promise()},promise:function(e){return null!=e?b.extend(e,o):o}},r={};return b.each(i,function(e,t){var s=t[2],a=t[5];o[t[1]]=s.add,a&&s.add(function(){n=a},i[3-e][2].disable,i[3-e][3].disable,i[0][2].lock,i[0][3].lock),s.add(t[3].fire),r[t[0]]=function(){return r[t[0]+"With"](this===r?void 0:this,arguments),this},r[t[0]+"With"]=s.fireWith}),o.promise(r),t&&t.call(r,r),r},when:function(e){var t=arguments.length,i=t,n=Array(i),o=r.call(arguments),s=b.Deferred(),a=function(e){return function(i){n[e]=this,o[e]=arguments.length>1?r.call(arguments):i,--t||s.resolveWith(n,o)}};if(t<=1&&(F(e,s.done(a(i)).resolve,s.reject,!t),"pending"===s.state()||f(o[i]&&o[i].then)))return s.then();for(;i--;)F(o[i],a(i),s.reject);return s.promise()}});var j=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;b.Deferred.exceptionHook=function(t,i){e.console&&e.console.warn&&t&&j.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,i)},b.readyException=function(t){e.setTimeout(function(){throw t})};var U=b.Deferred();function z(){n.removeEventListener("DOMContentLoaded",z),e.removeEventListener("load",z),b.ready()}b.fn.ready=function(e){return U.then(e).catch(function(e){b.readyException(e)}),this},b.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--b.readyWait:b.isReady)||(b.isReady=!0,!0!==e&&--b.readyWait>0||U.resolveWith(n,[b]))}}),b.ready.then=U.then,"complete"===n.readyState||"loading"!==n.readyState&&!n.documentElement.doScroll?e.setTimeout(b.ready):(n.addEventListener("DOMContentLoaded",z),e.addEventListener("load",z));var V=function(e,t,i,n,o,r,s){var a=0,h=e.length,l=null==i;if("object"===w(i))for(a in o=!0,i)V(e,t,a,i[a],!0,r,s);else if(void 0!==n&&(o=!0,f(n)||(s=!0),l&&(s?(t.call(e,n),t=null):(l=t,t=function(e,t,i){return l.call(b(e),i)})),t))for(;a<h;a++)t(e[a],i,s?n:n.call(e[a],a,t(e[a],i)));return o?e:l?t.call(e):h?t(e[0],i):r},H=/^-ms-/,q=/-([a-z])/g;function K(e,t){return t.toUpperCase()}function W(e){return e.replace(H,"ms-").replace(q,K)}var Y=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function X(){this.expando=b.expando+X.uid++}X.uid=1,X.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Y(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,i){var n,o=this.cache(e);if("string"==typeof t)o[W(t)]=i;else for(n in t)o[W(n)]=t[n];return o},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][W(t)]},access:function(e,t,i){return void 0===t||t&&"string"==typeof t&&void 0===i?this.get(e,t):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n=e[this.expando];if(void 0!==n){if(void 0!==t){i=(t=Array.isArray(t)?t.map(W):(t=W(t))in n?[t]:t.match(L)||[]).length;for(;i--;)delete n[t[i]]}(void 0===t||b.isEmptyObject(n))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!b.isEmptyObject(t)}};var G=new X,$=new X,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Q=/[A-Z]/g;function Z(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(Q,"-$&").toLowerCase(),"string"==typeof(i=e.getAttribute(n))){try{i=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:J.test(e)?JSON.parse(e):e)}(i)}catch(e){}$.set(e,t,i)}else i=void 0;return i}b.extend({hasData:function(e){return $.hasData(e)||G.hasData(e)},data:function(e,t,i){return $.access(e,t,i)},removeData:function(e,t){$.remove(e,t)},_data:function(e,t,i){return G.access(e,t,i)},_removeData:function(e,t){G.remove(e,t)}}),b.fn.extend({data:function(e,t){var i,n,o,r=this[0],s=r&&r.attributes;if(void 0===e){if(this.length&&(o=$.get(r),1===r.nodeType&&!G.get(r,"hasDataAttrs"))){for(i=s.length;i--;)s[i]&&0===(n=s[i].name).indexOf("data-")&&(n=W(n.slice(5)),Z(r,n,o[n]));G.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){$.set(this,e)}):V(this,function(t){var i;if(r&&void 0===t){if(void 0!==(i=$.get(r,e)))return i;if(void 0!==(i=Z(r,e)))return i}else this.each(function(){$.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){$.remove(this,e)})}}),b.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=G.get(e,t),i&&(!n||Array.isArray(i)?n=G.access(e,t,b.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=b.queue(e,t),n=i.length,o=i.shift(),r=b._queueHooks(e,t);"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===t&&i.unshift("inprogress"),delete r.stop,o.call(e,function(){b.dequeue(e,t)},r)),!n&&r&&r.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return G.get(e,i)||G.access(e,i,{empty:b.Callbacks("once memory").add(function(){G.remove(e,[t+"queue",i])})})}}),b.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?b.queue(this[0],e):void 0===t?this:this.each(function(){var i=b.queue(this,e,t);b._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&b.dequeue(this,e)})},dequeue:function(e){return this.each(function(){b.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,o=b.Deferred(),r=this,s=this.length,a=function(){--n||o.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)(i=G.get(r[s],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(a));return a(),o.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ie=["Top","Right","Bottom","Left"],ne=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&b.contains(e.ownerDocument,e)&&"none"===b.css(e,"display")},oe=function(e,t,i,n){var o,r,s={};for(r in t)s[r]=e.style[r],e.style[r]=t[r];for(r in o=i.apply(e,n||[]),t)e.style[r]=s[r];return o};function re(e,t,i,n){var o,r,s=20,a=n?function(){return n.cur()}:function(){return b.css(e,t,"")},h=a(),l=i&&i[3]||(b.cssNumber[t]?"":"px"),c=(b.cssNumber[t]||"px"!==l&&+h)&&te.exec(b.css(e,t));if(c&&c[3]!==l){for(h/=2,l=l||c[3],c=+h||1;s--;)b.style(e,t,c+l),(1-r)*(1-(r=a()/h||.5))<=0&&(s=0),c/=r;c*=2,b.style(e,t,c+l),i=i||[]}return i&&(c=+c||+h||0,o=i[1]?c+(i[1]+1)*i[2]:+i[2],n&&(n.unit=l,n.start=c,n.end=o)),o}var se={};function ae(e){var t,i=e.ownerDocument,n=e.nodeName,o=se[n];return o||(t=i.body.appendChild(i.createElement(n)),o=b.css(t,"display"),t.parentNode.removeChild(t),"none"===o&&(o="block"),se[n]=o,o)}function he(e,t){for(var i,n,o=[],r=0,s=e.length;r<s;r++)(n=e[r]).style&&(i=n.style.display,t?("none"===i&&(o[r]=G.get(n,"display")||null,o[r]||(n.style.display="")),""===n.style.display&&ne(n)&&(o[r]=ae(n))):"none"!==i&&(o[r]="none",G.set(n,"display",i)));for(r=0;r<s;r++)null!=o[r]&&(e[r].style.display=o[r]);return e}b.fn.extend({show:function(){return he(this,!0)},hide:function(){return he(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ne(this)?b(this).show():b(this).hide()})}});var le=/^(?:checkbox|radio)$/i,ce=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,ue=/^$|^module$|\/(?:java|ecma)script/i,de={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function pe(e,t){var i;return i=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&S(e,t)?b.merge([e],i):i}function me(e,t){for(var i=0,n=e.length;i<n;i++)G.set(e[i],"globalEval",!t||G.get(t[i],"globalEval"))}de.optgroup=de.option,de.tbody=de.tfoot=de.colgroup=de.caption=de.thead,de.th=de.td;var fe=/<|&#?\w+;/;function ge(e,t,i,n,o){for(var r,s,a,h,l,c,u=t.createDocumentFragment(),d=[],p=0,m=e.length;p<m;p++)if((r=e[p])||0===r)if("object"===w(r))b.merge(d,r.nodeType?[r]:r);else if(fe.test(r)){for(s=s||u.appendChild(t.createElement("div")),a=(ce.exec(r)||["",""])[1].toLowerCase(),h=de[a]||de._default,s.innerHTML=h[1]+b.htmlPrefilter(r)+h[2],c=h[0];c--;)s=s.lastChild;b.merge(d,s.childNodes),(s=u.firstChild).textContent=""}else d.push(t.createTextNode(r));for(u.textContent="",p=0;r=d[p++];)if(n&&b.inArray(r,n)>-1)o&&o.push(r);else if(l=b.contains(r.ownerDocument,r),s=pe(u.appendChild(r),"script"),l&&me(s),i)for(c=0;r=s[c++];)ue.test(r.type||"")&&i.push(r);return u}!function(){var e=n.createDocumentFragment().appendChild(n.createElement("div")),t=n.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),m.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",m.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var ye=n.documentElement,ve=/^key/,we=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,be=/^([^.]*)(?:\.(.+)|)/;function xe(){return!0}function Ee(){return!1}function _e(){try{return n.activeElement}catch(e){}}function Te(e,t,i,n,o,r){var s,a;if("object"==typeof t){for(a in"string"!=typeof i&&(n=n||i,i=void 0),t)Te(e,a,i,n,t[a],r);return e}if(null==n&&null==o?(o=i,n=i=void 0):null==o&&("string"==typeof i?(o=n,n=void 0):(o=n,n=i,i=void 0)),!1===o)o=Ee;else if(!o)return e;return 1===r&&(s=o,(o=function(e){return b().off(e),s.apply(this,arguments)}).guid=s.guid||(s.guid=b.guid++)),e.each(function(){b.event.add(this,t,o,n,i)})}b.event={global:{},add:function(e,t,i,n,o){var r,s,a,h,l,c,u,d,p,m,f,g=G.get(e);if(g)for(i.handler&&(i=(r=i).handler,o=r.selector),o&&b.find.matchesSelector(ye,o),i.guid||(i.guid=b.guid++),(h=g.events)||(h=g.events={}),(s=g.handle)||(s=g.handle=function(t){return void 0!==b&&b.event.triggered!==t.type?b.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(L)||[""]).length;l--;)p=f=(a=be.exec(t[l])||[])[1],m=(a[2]||"").split(".").sort(),p&&(u=b.event.special[p]||{},p=(o?u.delegateType:u.bindType)||p,u=b.event.special[p]||{},c=b.extend({type:p,origType:f,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&b.expr.match.needsContext.test(o),namespace:m.join(".")},r),(d=h[p])||((d=h[p]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,n,m,s)||e.addEventListener&&e.addEventListener(p,s)),u.add&&(u.add.call(e,c),c.handler.guid||(c.handler.guid=i.guid)),o?d.splice(d.delegateCount++,0,c):d.push(c),b.event.global[p]=!0)},remove:function(e,t,i,n,o){var r,s,a,h,l,c,u,d,p,m,f,g=G.hasData(e)&&G.get(e);if(g&&(h=g.events)){for(l=(t=(t||"").match(L)||[""]).length;l--;)if(p=f=(a=be.exec(t[l])||[])[1],m=(a[2]||"").split(".").sort(),p){for(u=b.event.special[p]||{},d=h[p=(n?u.delegateType:u.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=r=d.length;r--;)c=d[r],!o&&f!==c.origType||i&&i.guid!==c.guid||a&&!a.test(c.namespace)||n&&n!==c.selector&&("**"!==n||!c.selector)||(d.splice(r,1),c.selector&&d.delegateCount--,u.remove&&u.remove.call(e,c));s&&!d.length&&(u.teardown&&!1!==u.teardown.call(e,m,g.handle)||b.removeEvent(e,p,g.handle),delete h[p])}else for(p in h)b.event.remove(e,p+t[l],i,n,!0);b.isEmptyObject(h)&&G.remove(e,"handle events")}},dispatch:function(e){var t,i,n,o,r,s,a=b.event.fix(e),h=new Array(arguments.length),l=(G.get(this,"events")||{})[a.type]||[],c=b.event.special[a.type]||{};for(h[0]=a,t=1;t<arguments.length;t++)h[t]=arguments[t];if(a.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,a)){for(s=b.event.handlers.call(this,a,l),t=0;(o=s[t++])&&!a.isPropagationStopped();)for(a.currentTarget=o.elem,i=0;(r=o.handlers[i++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!a.rnamespace.test(r.namespace)||(a.handleObj=r,a.data=r.data,void 0!==(n=((b.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,h))&&!1===(a.result=n)&&(a.preventDefault(),a.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,a),a.result}},handlers:function(e,t){var i,n,o,r,s,a=[],h=t.delegateCount,l=e.target;if(h&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(r=[],s={},i=0;i<h;i++)void 0===s[o=(n=t[i]).selector+" "]&&(s[o]=n.needsContext?b(o,this).index(l)>-1:b.find(o,this,null,[l]).length),s[o]&&r.push(n);r.length&&a.push({elem:l,handlers:r})}return l=this,h<t.length&&a.push({elem:l,handlers:t.slice(h)}),a},addProp:function(e,t){Object.defineProperty(b.Event.prototype,e,{enumerable:!0,configurable:!0,get:f(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[b.expando]?e:new b.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==_e()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===_e()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&S(this,"input"))return this.click(),!1},_default:function(e){return S(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},b.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i)},b.Event=function(e,t){if(!(this instanceof b.Event))return new b.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?xe:Ee,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&b.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[b.expando]=!0},b.Event.prototype={constructor:b.Event,isDefaultPrevented:Ee,isPropagationStopped:Ee,isImmediatePropagationStopped:Ee,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=xe,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=xe,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=xe,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},b.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&ve.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&we.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},b.event.addProp),b.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){b.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=e.relatedTarget,o=e.handleObj;return n&&(n===this||b.contains(this,n))||(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),b.fn.extend({on:function(e,t,i,n){return Te(this,e,t,i,n)},one:function(e,t,i,n){return Te(this,e,t,i,n,1)},off:function(e,t,i){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,b(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=Ee),this.each(function(){b.event.remove(this,e,i,t)})}});var Ce=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Ae=/<script|<style|<link/i,Se=/checked\s*(?:[^=]|=\s*.checked.)/i,ke=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Pe(e,t){return S(e,"table")&&S(11!==t.nodeType?t:t.firstChild,"tr")&&b(e).children("tbody")[0]||e}function Oe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Re(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Me(e,t){var i,n,o,r,s,a,h,l;if(1===t.nodeType){if(G.hasData(e)&&(r=G.access(e),s=G.set(t,r),l=r.events))for(o in delete s.handle,s.events={},l)for(i=0,n=l[o].length;i<n;i++)b.event.add(t,o,l[o][i]);$.hasData(e)&&(a=$.access(e),h=b.extend({},a),$.set(t,h))}}function Be(e,t){var i=t.nodeName.toLowerCase();"input"===i&&le.test(e.type)?t.checked=e.checked:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}function Ie(e,t,i,n){t=s.apply([],t);var o,r,a,h,l,c,u=0,d=e.length,p=d-1,g=t[0],y=f(g);if(y||d>1&&"string"==typeof g&&!m.checkClone&&Se.test(g))return e.each(function(o){var r=e.eq(o);y&&(t[0]=g.call(this,o,r.html())),Ie(r,t,i,n)});if(d&&(r=(o=ge(t,e[0].ownerDocument,!1,e,n)).firstChild,1===o.childNodes.length&&(o=r),r||n)){for(h=(a=b.map(pe(o,"script"),Oe)).length;u<d;u++)l=o,u!==p&&(l=b.clone(l,!0,!0),h&&b.merge(a,pe(l,"script"))),i.call(e[u],l,u);if(h)for(c=a[a.length-1].ownerDocument,b.map(a,Re),u=0;u<h;u++)l=a[u],ue.test(l.type||"")&&!G.access(l,"globalEval")&&b.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?b._evalUrl&&b._evalUrl(l.src):v(l.textContent.replace(ke,""),c,l))}return e}function Le(e,t,i){for(var n,o=t?b.filter(t,e):e,r=0;null!=(n=o[r]);r++)i||1!==n.nodeType||b.cleanData(pe(n)),n.parentNode&&(i&&b.contains(n.ownerDocument,n)&&me(pe(n,"script")),n.parentNode.removeChild(n));return e}b.extend({htmlPrefilter:function(e){return e.replace(Ce,"<$1></$2>")},clone:function(e,t,i){var n,o,r,s,a=e.cloneNode(!0),h=b.contains(e.ownerDocument,e);if(!(m.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||b.isXMLDoc(e)))for(s=pe(a),n=0,o=(r=pe(e)).length;n<o;n++)Be(r[n],s[n]);if(t)if(i)for(r=r||pe(e),s=s||pe(a),n=0,o=r.length;n<o;n++)Me(r[n],s[n]);else Me(e,a);return(s=pe(a,"script")).length>0&&me(s,!h&&pe(e,"script")),a},cleanData:function(e){for(var t,i,n,o=b.event.special,r=0;void 0!==(i=e[r]);r++)if(Y(i)){if(t=i[G.expando]){if(t.events)for(n in t.events)o[n]?b.event.remove(i,n):b.removeEvent(i,n,t.handle);i[G.expando]=void 0}i[$.expando]&&(i[$.expando]=void 0)}}}),b.fn.extend({detach:function(e){return Le(this,e,!0)},remove:function(e){return Le(this,e)},text:function(e){return V(this,function(e){return void 0===e?b.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Ie(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Pe(this,e).appendChild(e)})},prepend:function(){return Ie(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Pe(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Ie(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Ie(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(b.cleanData(pe(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return b.clone(this,e,t)})},html:function(e){return V(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ae.test(e)&&!de[(ce.exec(e)||["",""])[1].toLowerCase()]){e=b.htmlPrefilter(e);try{for(;i<n;i++)1===(t=this[i]||{}).nodeType&&(b.cleanData(pe(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Ie(this,arguments,function(t){var i=this.parentNode;b.inArray(this,e)<0&&(b.cleanData(pe(this)),i&&i.replaceChild(t,this))},e)}}),b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){b.fn[e]=function(e){for(var i,n=[],o=b(e),r=o.length-1,s=0;s<=r;s++)i=s===r?this:this.clone(!0),b(o[s])[t](i),a.apply(n,i.get());return this.pushStack(n)}});var De=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Ne=function(t){var i=t.ownerDocument.defaultView;return i&&i.opener||(i=e),i.getComputedStyle(t)},Fe=new RegExp(ie.join("|"),"i");function je(e,t,i){var n,o,r,s,a=e.style;return(i=i||Ne(e))&&(""!==(s=i.getPropertyValue(t)||i[t])||b.contains(e.ownerDocument,e)||(s=b.style(e,t)),!m.pixelBoxStyles()&&De.test(s)&&Fe.test(t)&&(n=a.width,o=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=i.width,a.width=n,a.minWidth=o,a.maxWidth=r)),void 0!==s?s+"":s}function Ue(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function t(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ye.appendChild(l).appendChild(c);var t=e.getComputedStyle(c);o="1%"!==t.top,h=12===i(t.marginLeft),c.style.right="60%",a=36===i(t.right),r=36===i(t.width),c.style.position="absolute",s=36===c.offsetWidth||"absolute",ye.removeChild(l),c=null}}function i(e){return Math.round(parseFloat(e))}var o,r,s,a,h,l=n.createElement("div"),c=n.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",m.clearCloneStyle="content-box"===c.style.backgroundClip,b.extend(m,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),a},pixelPosition:function(){return t(),o},reliableMarginLeft:function(){return t(),h},scrollboxSize:function(){return t(),s}}))}();var ze=/^(none|table(?!-c[ea]).+)/,Ve=/^--/,He={position:"absolute",visibility:"hidden",display:"block"},qe={letterSpacing:"0",fontWeight:"400"},Ke=["Webkit","Moz","ms"],We=n.createElement("div").style;function Ye(e){var t=b.cssProps[e];return t||(t=b.cssProps[e]=function(e){if(e in We)return e;for(var t=e[0].toUpperCase()+e.slice(1),i=Ke.length;i--;)if((e=Ke[i]+t)in We)return e}(e)||e),t}function Xe(e,t,i){var n=te.exec(t);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):t}function Ge(e,t,i,n,o,r){var s="width"===t?1:0,a=0,h=0;if(i===(n?"border":"content"))return 0;for(;s<4;s+=2)"margin"===i&&(h+=b.css(e,i+ie[s],!0,o)),n?("content"===i&&(h-=b.css(e,"padding"+ie[s],!0,o)),"margin"!==i&&(h-=b.css(e,"border"+ie[s]+"Width",!0,o))):(h+=b.css(e,"padding"+ie[s],!0,o),"padding"!==i?h+=b.css(e,"border"+ie[s]+"Width",!0,o):a+=b.css(e,"border"+ie[s]+"Width",!0,o));return!n&&r>=0&&(h+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-r-h-a-.5))),h}function $e(e,t,i){var n=Ne(e),o=je(e,t,n),r="border-box"===b.css(e,"boxSizing",!1,n),s=r;if(De.test(o)){if(!i)return o;o="auto"}return s=s&&(m.boxSizingReliable()||o===e.style[t]),("auto"===o||!parseFloat(o)&&"inline"===b.css(e,"display",!1,n))&&(o=e["offset"+t[0].toUpperCase()+t.slice(1)],s=!0),(o=parseFloat(o)||0)+Ge(e,t,i||(r?"border":"content"),s,n,o)+"px"}function Je(e,t,i,n,o){return new Je.prototype.init(e,t,i,n,o)}b.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=je(e,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,s,a=W(t),h=Ve.test(t),l=e.style;if(h||(t=Ye(a)),s=b.cssHooks[t]||b.cssHooks[a],void 0===i)return s&&"get"in s&&void 0!==(o=s.get(e,!1,n))?o:l[t];"string"==(r=typeof i)&&(o=te.exec(i))&&o[1]&&(i=re(e,t,o),r="number"),null!=i&&i==i&&("number"===r&&(i+=o&&o[3]||(b.cssNumber[a]?"":"px")),m.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),s&&"set"in s&&void 0===(i=s.set(e,i,n))||(h?l.setProperty(t,i):l[t]=i))}},css:function(e,t,i,n){var o,r,s,a=W(t);return Ve.test(t)||(t=Ye(a)),(s=b.cssHooks[t]||b.cssHooks[a])&&"get"in s&&(o=s.get(e,!0,i)),void 0===o&&(o=je(e,t,n)),"normal"===o&&t in qe&&(o=qe[t]),""===i||i?(r=parseFloat(o),!0===i||isFinite(r)?r||0:o):o}}),b.each(["height","width"],function(e,t){b.cssHooks[t]={get:function(e,i,n){if(i)return!ze.test(b.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?$e(e,t,n):oe(e,He,function(){return $e(e,t,n)})},set:function(e,i,n){var o,r=Ne(e),s="border-box"===b.css(e,"boxSizing",!1,r),a=n&&Ge(e,t,n,s,r);return s&&m.scrollboxSize()===r.position&&(a-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(r[t])-Ge(e,t,"border",!1,r)-.5)),a&&(o=te.exec(i))&&"px"!==(o[3]||"px")&&(e.style[t]=i,i=b.css(e,t)),Xe(0,i,a)}}}),b.cssHooks.marginLeft=Ue(m.reliableMarginLeft,function(e,t){if(t)return(parseFloat(je(e,"marginLeft"))||e.getBoundingClientRect().left-oe(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),b.each({margin:"",padding:"",border:"Width"},function(e,t){b.cssHooks[e+t]={expand:function(i){for(var n=0,o={},r="string"==typeof i?i.split(" "):[i];n<4;n++)o[e+ie[n]+t]=r[n]||r[n-2]||r[0];return o}},"margin"!==e&&(b.cssHooks[e+t].set=Xe)}),b.fn.extend({css:function(e,t){return V(this,function(e,t,i){var n,o,r={},s=0;if(Array.isArray(t)){for(n=Ne(e),o=t.length;s<o;s++)r[t[s]]=b.css(e,t[s],!1,n);return r}return void 0!==i?b.style(e,t,i):b.css(e,t)},e,t,arguments.length>1)}}),b.Tween=Je,Je.prototype={constructor:Je,init:function(e,t,i,n,o,r){this.elem=e,this.prop=i,this.easing=o||b.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=r||(b.cssNumber[i]?"":"px")},cur:function(){var e=Je.propHooks[this.prop];return e&&e.get?e.get(this):Je.propHooks._default.get(this)},run:function(e){var t,i=Je.propHooks[this.prop];return this.options.duration?this.pos=t=b.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):Je.propHooks._default.set(this),this}},Je.prototype.init.prototype=Je.prototype,Je.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=b.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){b.fx.step[e.prop]?b.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[b.cssProps[e.prop]]&&!b.cssHooks[e.prop]?e.elem[e.prop]=e.now:b.style(e.elem,e.prop,e.now+e.unit)}}},Je.propHooks.scrollTop=Je.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},b.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},b.fx=Je.prototype.init,b.fx.step={};var Qe,Ze,et=/^(?:toggle|show|hide)$/,tt=/queueHooks$/;function it(){Ze&&(!1===n.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(it):e.setTimeout(it,b.fx.interval),b.fx.tick())}function nt(){return e.setTimeout(function(){Qe=void 0}),Qe=Date.now()}function ot(e,t){var i,n=0,o={height:e};for(t=t?1:0;n<4;n+=2-t)o["margin"+(i=ie[n])]=o["padding"+i]=e;return t&&(o.opacity=o.width=e),o}function rt(e,t,i){for(var n,o=(st.tweeners[t]||[]).concat(st.tweeners["*"]),r=0,s=o.length;r<s;r++)if(n=o[r].call(i,t,e))return n}function st(e,t,i){var n,o,r=0,s=st.prefilters.length,a=b.Deferred().always(function(){delete h.elem}),h=function(){if(o)return!1;for(var t=Qe||nt(),i=Math.max(0,l.startTime+l.duration-t),n=1-(i/l.duration||0),r=0,s=l.tweens.length;r<s;r++)l.tweens[r].run(n);return a.notifyWith(e,[l,n,i]),n<1&&s?i:(s||a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l]),!1)},l=a.promise({elem:e,props:b.extend({},t),opts:b.extend(!0,{specialEasing:{},easing:b.easing._default},i),originalProperties:t,originalOptions:i,startTime:Qe||nt(),duration:i.duration,tweens:[],createTween:function(t,i){var n=b.Tween(e,l.opts,t,i,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(n),n},stop:function(t){var i=0,n=t?l.tweens.length:0;if(o)return this;for(o=!0;i<n;i++)l.tweens[i].run(1);return t?(a.notifyWith(e,[l,1,0]),a.resolveWith(e,[l,t])):a.rejectWith(e,[l,t]),this}}),c=l.props;for(function(e,t){var i,n,o,r,s;for(i in e)if(o=t[n=W(i)],r=e[i],Array.isArray(r)&&(o=r[1],r=e[i]=r[0]),i!==n&&(e[n]=r,delete e[i]),(s=b.cssHooks[n])&&"expand"in s)for(i in r=s.expand(r),delete e[n],r)i in e||(e[i]=r[i],t[i]=o);else t[n]=o}(c,l.opts.specialEasing);r<s;r++)if(n=st.prefilters[r].call(l,e,c,l.opts))return f(n.stop)&&(b._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return b.map(c,rt,l),f(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),b.fx.timer(b.extend(h,{elem:e,anim:l,queue:l.opts.queue})),l}b.Animation=b.extend(st,{tweeners:{"*":[function(e,t){var i=this.createTween(e,t);return re(i.elem,e,te.exec(t),i),i}]},tweener:function(e,t){f(e)?(t=e,e=["*"]):e=e.match(L);for(var i,n=0,o=e.length;n<o;n++)i=e[n],st.tweeners[i]=st.tweeners[i]||[],st.tweeners[i].unshift(t)},prefilters:[function(e,t,i){var n,o,r,s,a,h,l,c,u="width"in t||"height"in t,d=this,p={},m=e.style,f=e.nodeType&&ne(e),g=G.get(e,"fxshow");for(n in i.queue||(null==(s=b._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,d.always(function(){d.always(function(){s.unqueued--,b.queue(e,"fx").length||s.empty.fire()})})),t)if(o=t[n],et.test(o)){if(delete t[n],r=r||"toggle"===o,o===(f?"hide":"show")){if("show"!==o||!g||void 0===g[n])continue;f=!0}p[n]=g&&g[n]||b.style(e,n)}if((h=!b.isEmptyObject(t))||!b.isEmptyObject(p))for(n in u&&1===e.nodeType&&(i.overflow=[m.overflow,m.overflowX,m.overflowY],null==(l=g&&g.display)&&(l=G.get(e,"display")),"none"===(c=b.css(e,"display"))&&(l?c=l:(he([e],!0),l=e.style.display||l,c=b.css(e,"display"),he([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===b.css(e,"float")&&(h||(d.done(function(){m.display=l}),null==l&&(c=m.display,l="none"===c?"":c)),m.display="inline-block")),i.overflow&&(m.overflow="hidden",d.always(function(){m.overflow=i.overflow[0],m.overflowX=i.overflow[1],m.overflowY=i.overflow[2]})),h=!1,p)h||(g?"hidden"in g&&(f=g.hidden):g=G.access(e,"fxshow",{display:l}),r&&(g.hidden=!f),f&&he([e],!0),d.done(function(){for(n in f||he([e]),G.remove(e,"fxshow"),p)b.style(e,n,p[n])})),h=rt(f?g[n]:0,n,d),n in g||(g[n]=h.start,f&&(h.end=h.start,h.start=0))}],prefilter:function(e,t){t?st.prefilters.unshift(e):st.prefilters.push(e)}}),b.speed=function(e,t,i){var n=e&&"object"==typeof e?b.extend({},e):{complete:i||!i&&t||f(e)&&e,duration:e,easing:i&&t||t&&!f(t)&&t};return b.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in b.fx.speeds?n.duration=b.fx.speeds[n.duration]:n.duration=b.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){f(n.old)&&n.old.call(this),n.queue&&b.dequeue(this,n.queue)},n},b.fn.extend({fadeTo:function(e,t,i,n){return this.filter(ne).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var o=b.isEmptyObject(e),r=b.speed(t,i,n),s=function(){var t=st(this,b.extend({},e),r);(o||G.get(this,"finish"))&&t.stop(!0)};return s.finish=s,o||!1===r.queue?this.each(s):this.queue(r.queue,s)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",r=b.timers,s=G.get(this);if(o)s[o]&&s[o].stop&&n(s[o]);else for(o in s)s[o]&&s[o].stop&&tt.test(o)&&n(s[o]);for(o=r.length;o--;)r[o].elem!==this||null!=e&&r[o].queue!==e||(r[o].anim.stop(i),t=!1,r.splice(o,1));!t&&i||b.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,i=G.get(this),n=i[e+"queue"],o=i[e+"queueHooks"],r=b.timers,s=n?n.length:0;for(i.finish=!0,b.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<s;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),b.each(["toggle","show","hide"],function(e,t){var i=b.fn[t];b.fn[t]=function(e,n,o){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(ot(t,!0),e,n,o)}}),b.each({slideDown:ot("show"),slideUp:ot("hide"),slideToggle:ot("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){b.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),b.timers=[],b.fx.tick=function(){var e,t=0,i=b.timers;for(Qe=Date.now();t<i.length;t++)(e=i[t])()||i[t]!==e||i.splice(t--,1);i.length||b.fx.stop(),Qe=void 0},b.fx.timer=function(e){b.timers.push(e),b.fx.start()},b.fx.interval=13,b.fx.start=function(){Ze||(Ze=!0,it())},b.fx.stop=function(){Ze=null},b.fx.speeds={slow:600,fast:200,_default:400},b.fn.delay=function(t,i){return t=b.fx&&b.fx.speeds[t]||t,i=i||"fx",this.queue(i,function(i,n){var o=e.setTimeout(i,t);n.stop=function(){e.clearTimeout(o)}})},function(){var e=n.createElement("input"),t=n.createElement("select").appendChild(n.createElement("option"));e.type="checkbox",m.checkOn=""!==e.value,m.optSelected=t.selected,(e=n.createElement("input")).value="t",e.type="radio",m.radioValue="t"===e.value}();var at,ht=b.expr.attrHandle;b.fn.extend({attr:function(e,t){return V(this,b.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){b.removeAttr(this,e)})}}),b.extend({attr:function(e,t,i){var n,o,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===e.getAttribute?b.prop(e,t,i):(1===r&&b.isXMLDoc(e)||(o=b.attrHooks[t.toLowerCase()]||(b.expr.match.bool.test(t)?at:void 0)),void 0!==i?null===i?void b.removeAttr(e,t):o&&"set"in o&&void 0!==(n=o.set(e,i,t))?n:(e.setAttribute(t,i+""),i):o&&"get"in o&&null!==(n=o.get(e,t))?n:null==(n=b.find.attr(e,t))?void 0:n)},attrHooks:{type:{set:function(e,t){if(!m.radioValue&&"radio"===t&&S(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}},removeAttr:function(e,t){var i,n=0,o=t&&t.match(L);if(o&&1===e.nodeType)for(;i=o[n++];)e.removeAttribute(i)}}),at={set:function(e,t,i){return!1===t?b.removeAttr(e,i):e.setAttribute(i,i),i}},b.each(b.expr.match.bool.source.match(/\w+/g),function(e,t){var i=ht[t]||b.find.attr;ht[t]=function(e,t,n){var o,r,s=t.toLowerCase();return n||(r=ht[s],ht[s]=o,o=null!=i(e,t,n)?s:null,ht[s]=r),o}});var lt=/^(?:input|select|textarea|button)$/i,ct=/^(?:a|area)$/i;function ut(e){return(e.match(L)||[]).join(" ")}function dt(e){return e.getAttribute&&e.getAttribute("class")||""}function pt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(L)||[]}b.fn.extend({prop:function(e,t){return V(this,b.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[b.propFix[e]||e]})}}),b.extend({prop:function(e,t,i){var n,o,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&b.isXMLDoc(e)||(t=b.propFix[t]||t,o=b.propHooks[t]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(e,i,t))?n:e[t]=i:o&&"get"in o&&null!==(n=o.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=b.find.attr(e,"tabindex");return t?parseInt(t,10):lt.test(e.nodeName)||ct.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),m.optSelected||(b.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),b.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){b.propFix[this.toLowerCase()]=this}),b.fn.extend({addClass:function(e){var t,i,n,o,r,s,a,h=0;if(f(e))return this.each(function(t){b(this).addClass(e.call(this,t,dt(this)))});if((t=pt(e)).length)for(;i=this[h++];)if(o=dt(i),n=1===i.nodeType&&" "+ut(o)+" "){for(s=0;r=t[s++];)n.indexOf(" "+r+" ")<0&&(n+=r+" ");o!==(a=ut(n))&&i.setAttribute("class",a)}return this},removeClass:function(e){var t,i,n,o,r,s,a,h=0;if(f(e))return this.each(function(t){b(this).removeClass(e.call(this,t,dt(this)))});if(!arguments.length)return this.attr("class","");if((t=pt(e)).length)for(;i=this[h++];)if(o=dt(i),n=1===i.nodeType&&" "+ut(o)+" "){for(s=0;r=t[s++];)for(;n.indexOf(" "+r+" ")>-1;)n=n.replace(" "+r+" "," ");o!==(a=ut(n))&&i.setAttribute("class",a)}return this},toggleClass:function(e,t){var i=typeof e,n="string"===i||Array.isArray(e);return"boolean"==typeof t&&n?t?this.addClass(e):this.removeClass(e):f(e)?this.each(function(i){b(this).toggleClass(e.call(this,i,dt(this),t),t)}):this.each(function(){var t,o,r,s;if(n)for(o=0,r=b(this),s=pt(e);t=s[o++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else void 0!==e&&"boolean"!==i||((t=dt(this))&&G.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":G.get(this,"__className__")||""))})},hasClass:function(e){var t,i,n=0;for(t=" "+e+" ";i=this[n++];)if(1===i.nodeType&&(" "+ut(dt(i))+" ").indexOf(t)>-1)return!0;return!1}});var mt=/\r/g;b.fn.extend({val:function(e){var t,i,n,o=this[0];return arguments.length?(n=f(e),this.each(function(i){var o;1===this.nodeType&&(null==(o=n?e.call(this,i,b(this).val()):e)?o="":"number"==typeof o?o+="":Array.isArray(o)&&(o=b.map(o,function(e){return null==e?"":e+""})),(t=b.valHooks[this.type]||b.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))})):o?(t=b.valHooks[o.type]||b.valHooks[o.nodeName.toLowerCase()])&&"get"in t&&void 0!==(i=t.get(o,"value"))?i:"string"==typeof(i=o.value)?i.replace(mt,""):null==i?"":i:void 0}}),b.extend({valHooks:{option:{get:function(e){var t=b.find.attr(e,"value");return null!=t?t:ut(b.text(e))}},select:{get:function(e){var t,i,n,o=e.options,r=e.selectedIndex,s="select-one"===e.type,a=s?null:[],h=s?r+1:o.length;for(n=r<0?h:s?r:0;n<h;n++)if(((i=o[n]).selected||n===r)&&!i.disabled&&(!i.parentNode.disabled||!S(i.parentNode,"optgroup"))){if(t=b(i).val(),s)return t;a.push(t)}return a},set:function(e,t){for(var i,n,o=e.options,r=b.makeArray(t),s=o.length;s--;)((n=o[s]).selected=b.inArray(b.valHooks.option.get(n),r)>-1)&&(i=!0);return i||(e.selectedIndex=-1),r}}}}),b.each(["radio","checkbox"],function(){b.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=b.inArray(b(e).val(),t)>-1}},m.checkOn||(b.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),m.focusin="onfocusin"in e;var ft=/^(?:focusinfocus|focusoutblur)$/,gt=function(e){e.stopPropagation()};b.extend(b.event,{trigger:function(t,i,o,r){var s,a,h,l,c,d,p,m,y=[o||n],v=u.call(t,"type")?t.type:t,w=u.call(t,"namespace")?t.namespace.split("."):[];if(a=m=h=o=o||n,3!==o.nodeType&&8!==o.nodeType&&!ft.test(v+b.event.triggered)&&(v.indexOf(".")>-1&&(v=(w=v.split(".")).shift(),w.sort()),c=v.indexOf(":")<0&&"on"+v,(t=t[b.expando]?t:new b.Event(v,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=w.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+w.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=o),i=null==i?[t]:b.makeArray(i,[t]),p=b.event.special[v]||{},r||!p.trigger||!1!==p.trigger.apply(o,i))){if(!r&&!p.noBubble&&!g(o)){for(l=p.delegateType||v,ft.test(l+v)||(a=a.parentNode);a;a=a.parentNode)y.push(a),h=a;h===(o.ownerDocument||n)&&y.push(h.defaultView||h.parentWindow||e)}for(s=0;(a=y[s++])&&!t.isPropagationStopped();)m=a,t.type=s>1?l:p.bindType||v,(d=(G.get(a,"events")||{})[t.type]&&G.get(a,"handle"))&&d.apply(a,i),(d=c&&a[c])&&d.apply&&Y(a)&&(t.result=d.apply(a,i),!1===t.result&&t.preventDefault());return t.type=v,r||t.isDefaultPrevented()||p._default&&!1!==p._default.apply(y.pop(),i)||!Y(o)||c&&f(o[v])&&!g(o)&&((h=o[c])&&(o[c]=null),b.event.triggered=v,t.isPropagationStopped()&&m.addEventListener(v,gt),o[v](),t.isPropagationStopped()&&m.removeEventListener(v,gt),b.event.triggered=void 0,h&&(o[c]=h)),t.result}},simulate:function(e,t,i){var n=b.extend(new b.Event,i,{type:e,isSimulated:!0});b.event.trigger(n,null,t)}}),b.fn.extend({trigger:function(e,t){return this.each(function(){b.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return b.event.trigger(e,t,i,!0)}}),m.focusin||b.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){b.event.simulate(t,e.target,b.event.fix(e))};b.event.special[t]={setup:function(){var n=this.ownerDocument||this,o=G.access(n,t);o||n.addEventListener(e,i,!0),G.access(n,t,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this,o=G.access(n,t)-1;o?G.access(n,t,o):(n.removeEventListener(e,i,!0),G.remove(n,t))}}});var yt=e.location,vt=Date.now(),wt=/\?/;b.parseXML=function(t){var i;if(!t||"string"!=typeof t)return null;try{i=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){i=void 0}return i&&!i.getElementsByTagName("parsererror").length||b.error("Invalid XML: "+t),i};var bt=/\[\]$/,xt=/\r?\n/g,Et=/^(?:submit|button|image|reset|file)$/i,_t=/^(?:input|select|textarea|keygen)/i;function Tt(e,t,i,n){var o;if(Array.isArray(t))b.each(t,function(t,o){i||bt.test(e)?n(e,o):Tt(e+"["+("object"==typeof o&&null!=o?t:"")+"]",o,i,n)});else if(i||"object"!==w(t))n(e,t);else for(o in t)Tt(e+"["+o+"]",t[o],i,n)}b.param=function(e,t){var i,n=[],o=function(e,t){var i=f(t)?t():t;n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==i?"":i)};if(Array.isArray(e)||e.jquery&&!b.isPlainObject(e))b.each(e,function(){o(this.name,this.value)});else for(i in e)Tt(i,e[i],t,o);return n.join("&")},b.fn.extend({serialize:function(){return b.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=b.prop(this,"elements");return e?b.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!b(this).is(":disabled")&&_t.test(this.nodeName)&&!Et.test(e)&&(this.checked||!le.test(e))}).map(function(e,t){var i=b(this).val();return null==i?null:Array.isArray(i)?b.map(i,function(e){return{name:t.name,value:e.replace(xt,"\r\n")}}):{name:t.name,value:i.replace(xt,"\r\n")}}).get()}});var Ct=/%20/g,At=/#.*$/,St=/([?&])_=[^&]*/,kt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Pt=/^(?:GET|HEAD)$/,Ot=/^\/\//,Rt={},Mt={},Bt="*/".concat("*"),It=n.createElement("a");function Lt(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,o=0,r=t.toLowerCase().match(L)||[];if(f(i))for(;n=r[o++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function Dt(e,t,i,n){var o={},r=e===Mt;function s(a){var h;return o[a]=!0,b.each(e[a]||[],function(e,a){var l=a(t,i,n);return"string"!=typeof l||r||o[l]?r?!(h=l):void 0:(t.dataTypes.unshift(l),s(l),!1)}),h}return s(t.dataTypes[0])||!o["*"]&&s("*")}function Nt(e,t){var i,n,o=b.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((o[i]?e:n||(n={}))[i]=t[i]);return n&&b.extend(!0,e,n),e}It.href=yt.href,b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(yt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Bt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Nt(Nt(e,b.ajaxSettings),t):Nt(b.ajaxSettings,e)},ajaxPrefilter:Lt(Rt),ajaxTransport:Lt(Mt),ajax:function(t,i){"object"==typeof t&&(i=t,t=void 0),i=i||{};var o,r,s,a,h,l,c,u,d,p,m=b.ajaxSetup({},i),f=m.context||m,g=m.context&&(f.nodeType||f.jquery)?b(f):b.event,y=b.Deferred(),v=b.Callbacks("once memory"),w=m.statusCode||{},x={},E={},_="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(c){if(!a)for(a={};t=kt.exec(s);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return c?s:null},setRequestHeader:function(e,t){return null==c&&(e=E[e.toLowerCase()]=E[e.toLowerCase()]||e,x[e]=t),this},overrideMimeType:function(e){return null==c&&(m.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||_;return o&&o.abort(t),C(0,t),this}};if(y.promise(T),m.url=((t||m.url||yt.href)+"").replace(Ot,yt.protocol+"//"),m.type=i.method||i.type||m.method||m.type,m.dataTypes=(m.dataType||"*").toLowerCase().match(L)||[""],null==m.crossDomain){l=n.createElement("a");try{l.href=m.url,l.href=l.href,m.crossDomain=It.protocol+"//"+It.host!=l.protocol+"//"+l.host}catch(e){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=b.param(m.data,m.traditional)),Dt(Rt,m,i,T),c)return T;for(d in(u=b.event&&m.global)&&0==b.active++&&b.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Pt.test(m.type),r=m.url.replace(At,""),m.hasContent?m.data&&m.processData&&0===(m.contentType||"").indexOf("application/x-www-form-urlencoded")&&(m.data=m.data.replace(Ct,"+")):(p=m.url.slice(r.length),m.data&&(m.processData||"string"==typeof m.data)&&(r+=(wt.test(r)?"&":"?")+m.data,delete m.data),!1===m.cache&&(r=r.replace(St,"$1"),p=(wt.test(r)?"&":"?")+"_="+vt+++p),m.url=r+p),m.ifModified&&(b.lastModified[r]&&T.setRequestHeader("If-Modified-Since",b.lastModified[r]),b.etag[r]&&T.setRequestHeader("If-None-Match",b.etag[r])),(m.data&&m.hasContent&&!1!==m.contentType||i.contentType)&&T.setRequestHeader("Content-Type",m.contentType),T.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+Bt+"; q=0.01":""):m.accepts["*"]),m.headers)T.setRequestHeader(d,m.headers[d]);if(m.beforeSend&&(!1===m.beforeSend.call(f,T,m)||c))return T.abort();if(_="abort",v.add(m.complete),T.done(m.success),T.fail(m.error),o=Dt(Mt,m,i,T)){if(T.readyState=1,u&&g.trigger("ajaxSend",[T,m]),c)return T;m.async&&m.timeout>0&&(h=e.setTimeout(function(){T.abort("timeout")},m.timeout));try{c=!1,o.send(x,C)}catch(e){if(c)throw e;C(-1,e)}}else C(-1,"No Transport");function C(t,i,n,a){var l,d,p,x,E,_=i;c||(c=!0,h&&e.clearTimeout(h),o=void 0,s=a||"",T.readyState=t>0?4:0,l=t>=200&&t<300||304===t,n&&(x=function(e,t,i){for(var n,o,r,s,a=e.contents,h=e.dataTypes;"*"===h[0];)h.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(o in a)if(a[o]&&a[o].test(n)){h.unshift(o);break}if(h[0]in i)r=h[0];else{for(o in i){if(!h[0]||e.converters[o+" "+h[0]]){r=o;break}s||(s=o)}r=r||s}if(r)return r!==h[0]&&h.unshift(r),i[r]}(m,T,n)),x=function(e,t,i,n){var o,r,s,a,h,l={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)l[s.toLowerCase()]=e.converters[s];for(r=c.shift();r;)if(e.responseFields[r]&&(i[e.responseFields[r]]=t),!h&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),h=r,r=c.shift())if("*"===r)r=h;else if("*"!==h&&h!==r){if(!(s=l[h+" "+r]||l["* "+r]))for(o in l)if((a=o.split(" "))[1]===r&&(s=l[h+" "+a[0]]||l["* "+a[0]])){!0===s?s=l[o]:!0!==l[o]&&(r=a[0],c.unshift(a[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+h+" to "+r}}}return{state:"success",data:t}}(m,x,T,l),l?(m.ifModified&&((E=T.getResponseHeader("Last-Modified"))&&(b.lastModified[r]=E),(E=T.getResponseHeader("etag"))&&(b.etag[r]=E)),204===t||"HEAD"===m.type?_="nocontent":304===t?_="notmodified":(_=x.state,d=x.data,l=!(p=x.error))):(p=_,!t&&_||(_="error",t<0&&(t=0))),T.status=t,T.statusText=(i||_)+"",l?y.resolveWith(f,[d,_,T]):y.rejectWith(f,[T,_,p]),T.statusCode(w),w=void 0,u&&g.trigger(l?"ajaxSuccess":"ajaxError",[T,m,l?d:p]),v.fireWith(f,[T,_]),u&&(g.trigger("ajaxComplete",[T,m]),--b.active||b.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,i){return b.get(e,t,i,"json")},getScript:function(e,t){return b.get(e,void 0,t,"script")}}),b.each(["get","post"],function(e,t){b[t]=function(e,i,n,o){return f(i)&&(o=o||n,n=i,i=void 0),b.ajax(b.extend({url:e,type:t,dataType:o,data:i,success:n},b.isPlainObject(e)&&e))}}),b._evalUrl=function(e){return b.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},b.fn.extend({wrapAll:function(e){var t;return this[0]&&(f(e)&&(e=e.call(this[0])),t=b(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return f(e)?this.each(function(t){b(this).wrapInner(e.call(this,t))}):this.each(function(){var t=b(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=f(e);return this.each(function(i){b(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){b(this).replaceWith(this.childNodes)}),this}}),b.expr.pseudos.hidden=function(e){return!b.expr.pseudos.visible(e)},b.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},b.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Ft={0:200,1223:204},jt=b.ajaxSettings.xhr();m.cors=!!jt&&"withCredentials"in jt,m.ajax=jt=!!jt,b.ajaxTransport(function(t){var i,n;if(m.cors||jt&&!t.crossDomain)return{send:function(o,r){var s,a=t.xhr();if(a.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)a[s]=t.xhrFields[s];for(s in t.mimeType&&a.overrideMimeType&&a.overrideMimeType(t.mimeType),t.crossDomain||o["X-Requested-With"]||(o["X-Requested-With"]="XMLHttpRequest"),o)a.setRequestHeader(s,o[s]);i=function(e){return function(){i&&(i=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?r(0,"error"):r(a.status,a.statusText):r(Ft[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=i(),n=a.onerror=a.ontimeout=i("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&e.setTimeout(function(){i&&n()})},i=i("abort");try{a.send(t.hasContent&&t.data||null)}catch(e){if(i)throw e}},abort:function(){i&&i()}}}),b.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),b.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return b.globalEval(e),e}}}),b.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),b.ajaxTransport("script",function(e){var t,i;if(e.crossDomain)return{send:function(o,r){t=b("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&r("error"===e.type?404:200,e.type)}),n.head.appendChild(t[0])},abort:function(){i&&i()}}});var Ut=[],zt=/(=)\?(?=&|$)|\?\?/;b.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ut.pop()||b.expando+"_"+vt++;return this[e]=!0,e}}),b.ajaxPrefilter("json jsonp",function(t,i,n){var o,r,s,a=!1!==t.jsonp&&(zt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&zt.test(t.data)&&"data");if(a||"jsonp"===t.dataTypes[0])return o=t.jsonpCallback=f(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(zt,"$1"+o):!1!==t.jsonp&&(t.url+=(wt.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return s||b.error(o+" was not called"),s[0]},t.dataTypes[0]="json",r=e[o],e[o]=function(){s=arguments},n.always(function(){void 0===r?b(e).removeProp(o):e[o]=r,t[o]&&(t.jsonpCallback=i.jsonpCallback,Ut.push(o)),s&&f(r)&&r(s[0]),s=r=void 0}),"script"}),m.createHTMLDocument=function(){var e=n.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),b.parseHTML=function(e,t,i){return"string"!=typeof e?[]:("boolean"==typeof t&&(i=t,t=!1),t||(m.createHTMLDocument?((o=(t=n.implementation.createHTMLDocument("")).createElement("base")).href=n.location.href,t.head.appendChild(o)):t=n),r=k.exec(e),s=!i&&[],r?[t.createElement(r[1])]:(r=ge([e],t,s),s&&s.length&&b(s).remove(),b.merge([],r.childNodes)));var o,r,s},b.fn.load=function(e,t,i){var n,o,r,s=this,a=e.indexOf(" ");return a>-1&&(n=ut(e.slice(a)),e=e.slice(0,a)),f(t)?(i=t,t=void 0):t&&"object"==typeof t&&(o="POST"),s.length>0&&b.ajax({url:e,type:o||"GET",dataType:"html",data:t}).done(function(e){r=arguments,s.html(n?b("<div>").append(b.parseHTML(e)).find(n):e)}).always(i&&function(e,t){s.each(function(){i.apply(this,r||[e.responseText,t,e])})}),this},b.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){b.fn[t]=function(e){return this.on(t,e)}}),b.expr.pseudos.animated=function(e){return b.grep(b.timers,function(t){return e===t.elem}).length},b.offset={setOffset:function(e,t,i){var n,o,r,s,a,h,l=b.css(e,"position"),c=b(e),u={};"static"===l&&(e.style.position="relative"),a=c.offset(),r=b.css(e,"top"),h=b.css(e,"left"),("absolute"===l||"fixed"===l)&&(r+h).indexOf("auto")>-1?(s=(n=c.position()).top,o=n.left):(s=parseFloat(r)||0,o=parseFloat(h)||0),f(t)&&(t=t.call(e,i,b.extend({},a))),null!=t.top&&(u.top=t.top-a.top+s),null!=t.left&&(u.left=t.left-a.left+o),"using"in t?t.using.call(e,u):c.css(u)}},b.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){b.offset.setOffset(this,e,t)});var t,i,n=this[0];return n?n.getClientRects().length?(t=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:t.top+i.pageYOffset,left:t.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,i,n=this[0],o={top:0,left:0};if("fixed"===b.css(n,"position"))t=n.getBoundingClientRect();else{for(t=this.offset(),i=n.ownerDocument,e=n.offsetParent||i.documentElement;e&&(e===i.body||e===i.documentElement)&&"static"===b.css(e,"position");)e=e.parentNode;e&&e!==n&&1===e.nodeType&&((o=b(e).offset()).top+=b.css(e,"borderTopWidth",!0),o.left+=b.css(e,"borderLeftWidth",!0))}return{top:t.top-o.top-b.css(n,"marginTop",!0),left:t.left-o.left-b.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===b.css(e,"position");)e=e.offsetParent;return e||ye})}}),b.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var i="pageYOffset"===t;b.fn[e]=function(n){return V(this,function(e,n,o){var r;if(g(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===o)return r?r[t]:e[n];r?r.scrollTo(i?r.pageXOffset:o,i?o:r.pageYOffset):e[n]=o},e,n,arguments.length)}}),b.each(["top","left"],function(e,t){b.cssHooks[t]=Ue(m.pixelPosition,function(e,i){if(i)return i=je(e,t),De.test(i)?b(e).position()[t]+"px":i})}),b.each({Height:"height",Width:"width"},function(e,t){b.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){b.fn[n]=function(o,r){var s=arguments.length&&(i||"boolean"!=typeof o),a=i||(!0===o||!0===r?"margin":"border");return V(this,function(t,i,o){var r;return g(t)?0===n.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===o?b.css(t,i,a):b.style(t,i,o,a)},t,s?o:void 0,s)}})}),b.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){b.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),b.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),b.fn.extend({bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}}),b.proxy=function(e,t){var i,n,o;if("string"==typeof t&&(i=e[t],t=e,e=i),f(e))return n=r.call(arguments,2),(o=function(){return e.apply(t||this,n.concat(r.call(arguments)))}).guid=e.guid=e.guid||b.guid++,o},b.holdReady=function(e){e?b.readyWait++:b.ready(!0)},b.isArray=Array.isArray,b.parseJSON=JSON.parse,b.nodeName=S,b.isFunction=f,b.isWindow=g,b.camelCase=W,b.type=w,b.now=Date.now,b.isNumeric=function(e){var t=b.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return b});var Vt=e.jQuery,Ht=e.$;return b.noConflict=function(t){return e.$===b&&(e.$=Ht),t&&e.jQuery===b&&(e.jQuery=Vt),b},t||(e.jQuery=e.$=b),b}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.io=t():e.io=t()}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";function n(e,t){"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),t=t||{};var i,n=r(e),s=n.source,c=n.id,u=n.path,d=l[c]&&u in l[c].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(h("ignoring socket cache for %s",s),i=a(s,t)):(l[c]||(h("new io instance for %s",s),l[c]=a(s,t)),i=l[c]),n.query&&!t.query&&(t.query=n.query),i.socket(n.path,t)}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=i(1),s=i(7),a=i(13),h=i(3)("socket.io-client");e.exports=t=n;var l=t.managers={};t.protocol=s.protocol,t.connect=n,t.Manager=i(13),t.Socket=i(37)},function(e,t,i){(function(t){"use strict";var n=i(2),o=i(3)("socket.io-client:url");e.exports=function(e,i){var r=e;i=i||t.location,null==e&&(e=i.protocol+"//"+i.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?i.protocol+e:i.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==i?i.protocol+"//"+e:"https://"+e),o("parse %s",e),r=n(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var s=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port,r.href=r.protocol+"://"+s+(i&&i.port===r.port?"":":"+r.port),r}}).call(t,function(){return this}())},function(e,t){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,o=e.indexOf("["),r=e.indexOf("]");-1!=o&&-1!=r&&(e=e.substring(0,o)+e.substring(o,r).replace(/:/g,";")+e.substring(r,e.length));for(var s=i.exec(e||""),a={},h=14;h--;)a[n[h]]=s[h]||"";return-1!=o&&-1!=r&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(e,t,i){(function(n){function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(t=e.exports=i(5)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var i=this.useColors;if(e[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+e[0]+(i?"%c ":" ")+"+"+t.humanize(this.diff),i){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var o=0,r=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(r=++o)}),e.splice(r,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(t,i(4))},function(e,t){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(l===setTimeout)return setTimeout(e,0);if((l===i||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function r(){m&&d&&(m=!1,d.length?p=d.concat(p):f=-1,p.length&&s())}function s(){if(!m){var e=o(r);m=!0;for(var t=p.length;t;){for(d=p,p=[];++f<t;)d&&d[f].run();f=-1,t=p.length}d=null,m=!1,function(e){if(c===clearTimeout)return clearTimeout(e);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}(e)}}function a(e,t){this.fun=e,this.array=t}function h(){}var l,c,u=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:i}catch(e){l=i}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(e){c=n}}();var d,p=[],m=!1,f=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];p.push(new a(e,t)),1!==p.length||m||o(s)},a.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=h,u.addListener=h,u.once=h,u.off=h,u.removeListener=h,u.removeAllListeners=h,u.emit=h,u.prependListener=h,u.prependOnceListener=h,u.listeners=function(e){return[]},u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t,i){function n(e){function i(){if(i.enabled){var e=i,n=+new Date,r=n-(o||n);e.diff=r,e.prev=o,e.curr=n,o=n;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var h=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(i,n){if("%%"===i)return i;h++;var o=t.formatters[n];if("function"==typeof o){var r=s[h];i=o.call(e,r),s.splice(h,1),h--}return i}),t.formatArgs.call(e,s),(i.log||t.log||console.log.bind(console)).apply(e,s)}}return i.namespace=e,i.enabled=t.enabled(e),i.useColors=t.useColors(),i.color=function(e){var i,n=0;for(i in e)n=(n<<5)-n+e.charCodeAt(i),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),"function"==typeof t.init&&t.init(i),i}var o;(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var i=("string"==typeof e?e:"").split(/[\s,]+/),n=i.length,o=0;o<n;o++)i[o]&&("-"===(e=i[o].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var i,n;for(i=0,n=t.skips.length;i<n;i++)if(t.skips[i].test(e))return!1;for(i=0,n=t.names.length;i<n;i++)if(t.names[i].test(e))return!0;return!1},t.humanize=i(6),t.names=[],t.skips=[],t.formatters={}},function(e,t){function i(e){return n(e,a,"day")||n(e,s,"hour")||n(e,r,"minute")||n(e,o,"second")||e+" ms"}function n(e,t,i){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+i:Math.ceil(e/t)+" "+i+"s"}var o=1e3,r=60*o,s=60*r,a=24*s,h=365.25*a;e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var i=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return i*h;case"days":case"day":case"d":return i*a;case"hours":case"hour":case"hrs":case"hr":case"h":return i*s;case"minutes":case"minute":case"mins":case"min":case"m":return i*r;case"seconds":case"second":case"secs":case"sec":case"s":return i*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(e);if("number"===n&&!1===isNaN(e))return t.long?i(e):function(e){return e>=a?Math.round(e/a)+"d":e>=s?Math.round(e/s)+"h":e>=r?Math.round(e/r)+"m":e>=o?Math.round(e/o)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,i){function n(){}function o(e){var i=""+e.type;return t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(i+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(i+=e.nsp+","),null!=e.id&&(i+=e.id),null!=e.data&&(i+=JSON.stringify(e.data)),l("encoded %j as %s",e,i),i}function r(){this.reconstructor=null}function s(e){var i=0,n={type:Number(e.charAt(0))};if(null==t.types[n.type])return h();if(t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type){for(var o="";"-"!==e.charAt(++i)&&(o+=e.charAt(i),i!=e.length););if(o!=Number(o)||"-"!==e.charAt(i))throw new Error("Illegal attachments");n.attachments=Number(o)}if("/"===e.charAt(i+1))for(n.nsp="";++i;){if(","===(s=e.charAt(i)))break;if(n.nsp+=s,i===e.length)break}else n.nsp="/";var r=e.charAt(i+1);if(""!==r&&Number(r)==r){for(n.id="";++i;){var s;if(null==(s=e.charAt(i))||Number(s)!=s){--i;break}if(n.id+=e.charAt(i),i===e.length)break}n.id=Number(n.id)}return e.charAt(++i)&&(n=function(e,t){try{e.data=JSON.parse(t)}catch(e){return h()}return e}(n,e.substr(i))),l("decoded %s as %j",e,n),n}function a(e){this.reconPack=e,this.buffers=[]}function h(){return{type:t.ERROR,data:"parser error"}}var l=i(3)("socket.io-parser"),c=i(8),u=i(9),d=i(11),p=i(12);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=n,t.Decoder=r,n.prototype.encode=function(e,i){(e.type!==t.EVENT&&e.type!==t.ACK||!u(e.data)||(e.type=e.type===t.EVENT?t.BINARY_EVENT:t.BINARY_ACK),l("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){d.removeBlobs(e,function(e){var i=d.deconstructPacket(e),n=o(i.packet),r=i.buffers;r.unshift(n),t(r)})}(e,i):i([o(e)])},c(r.prototype),r.prototype.add=function(e){var i;if("string"==typeof e)i=s(e),t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type?(this.reconstructor=new a(i),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",i)):this.emit("decoded",i);else{if(!p(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(i=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",i))}},r.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},a.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=d.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},a.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,i){function n(e){if(e)return function(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function i(){this.off(e,i),t.apply(this,arguments)}return i.fn=t,this.on(e,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var n,o=0;o<i.length;o++)if((n=i[o])===t||n.fn===t){i.splice(o,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),i=this._callbacks["$"+e];if(i)for(var n=0,o=(i=i.slice(0)).length;n<o;++n)i[n].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,i){(function(t){var n=i(10),o=Object.prototype.toString,r="function"==typeof t.Blob||"[object BlobConstructor]"===o.call(t.Blob),s="function"==typeof t.File||"[object FileConstructor]"===o.call(t.File);e.exports=function e(i){if(!i||"object"!=typeof i)return!1;if(n(i)){for(var o=0,a=i.length;o<a;o++)if(e(i[o]))return!0;return!1}if("function"==typeof t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(i)||"function"==typeof t.ArrayBuffer&&i instanceof ArrayBuffer||r&&i instanceof Blob||s&&i instanceof File)return!0;if(i.toJSON&&"function"==typeof i.toJSON&&1===arguments.length)return e(i.toJSON(),!0);for(var h in i)if(Object.prototype.hasOwnProperty.call(i,h)&&e(i[h]))return!0;return!1}}).call(t,function(){return this}())},function(e,t){var i={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},function(e,t,i){(function(e){var n=i(10),o=i(12),r=Object.prototype.toString,s="function"==typeof e.Blob||"[object BlobConstructor]"===r.call(e.Blob),a="function"==typeof e.File||"[object FileConstructor]"===r.call(e.File);t.deconstructPacket=function(e){var t=[],i=e.data,r=e;return r.data=function e(t,i){if(!t)return t;if(o(t)){var r={_placeholder:!0,num:i.length};return i.push(t),r}if(n(t)){for(var s=new Array(t.length),a=0;a<t.length;a++)s[a]=e(t[a],i);return s}if("object"==typeof t&&!(t instanceof Date)){for(var h in s={},t)s[h]=e(t[h],i);return s}return t}(i,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,i){if(!t)return t;if(t&&t._placeholder)return i[t.num];if(n(t))for(var o=0;o<t.length;o++)t[o]=e(t[o],i);else if("object"==typeof t)for(var r in t)t[r]=e(t[r],i);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var i=0,r=e;(function e(h,l,c){if(!h)return h;if(s&&h instanceof Blob||a&&h instanceof File){i++;var u=new FileReader;u.onload=function(){c?c[l]=this.result:r=this.result,--i||t(r)},u.readAsArrayBuffer(h)}else if(n(h))for(var d=0;d<h.length;d++)e(h[d],d,h);else if("object"==typeof h&&!o(h))for(var p in h)e(h[p],p,h)})(r),i||t(r)}}).call(t,function(){return this}())},function(e,t){(function(t){e.exports=function(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}}).call(t,function(){return this}())},function(e,t,i){"use strict";function n(e,t){if(!(this instanceof n))return new n(e,t);e&&"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new p({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var i=t.parser||h;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=i(14),s=i(37),a=i(8),h=i(7),l=i(39),c=i(40),u=i(3)("socket.io-client:manager"),d=i(36),p=i(41),m=Object.prototype.hasOwnProperty;e.exports=n,n.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)m.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},n.prototype.updateSocketIds=function(){for(var e in this.nsps)m.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},n.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},a(n.prototype),n.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},n.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},n.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(e,t){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=r(this.uri,this.opts);var i=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var o=l(i,"open",function(){n.onopen(),e&&e()}),s=l(i,"error",function(t){if(u("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var i=new Error("Connection error");i.data=t,e(i)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;u("connect attempt will timeout after %d",a);var h=setTimeout(function(){u("connect attempt timed out after %d",a),o.destroy(),i.close(),i.emit("error","timeout"),n.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(h)}})}return this.subs.push(o),this.subs.push(s),this},n.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(l(e,"data",c(this,"ondata"))),this.subs.push(l(e,"ping",c(this,"onping"))),this.subs.push(l(e,"pong",c(this,"onpong"))),this.subs.push(l(e,"error",c(this,"onerror"))),this.subs.push(l(e,"close",c(this,"onclose"))),this.subs.push(l(this.decoder,"decoded",c(this,"ondecoded")))},n.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},n.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},n.prototype.ondata=function(e){this.decoder.add(e)},n.prototype.ondecoded=function(e){this.emit("packet",e)},n.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},n.prototype.socket=function(e,t){function i(){~d(o.connecting,n)||o.connecting.push(n)}var n=this.nsps[e];if(!n){n=new s(this,e,t),this.nsps[e]=n;var o=this;n.on("connecting",i),n.on("connect",function(){n.id=o.generateId(e)}),this.autoConnect&&i()}return n},n.prototype.destroy=function(e){var t=d(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},n.prototype.packet=function(e){u("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(i){for(var n=0;n<i.length;n++)t.engine.write(i[n],e.options);t.encoding=!1,t.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},n.prototype.cleanup=function(){u("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(e){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var i=setTimeout(function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(i)}})}},n.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,i){e.exports=i(15),e.exports.parser=i(22)},function(e,t,i){(function(t){function n(e,i){if(!(this instanceof n))return new n(e,i);i=i||{},e&&"object"==typeof e&&(i=e,e=null),e?(e=l(e),i.hostname=e.host,i.secure="https"===e.protocol||"wss"===e.protocol,i.port=e.port,e.query&&(i.query=e.query)):i.host&&(i.hostname=l(i.host).host),this.secure=null!=i.secure?i.secure:t.location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.agent=i.agent||!1,this.hostname=i.hostname||(t.location?location.hostname:"localhost"),this.port=i.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=i.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==i.upgrade,this.path=(i.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!i.forceJSONP,this.jsonp=!1!==i.jsonp,this.forceBase64=!!i.forceBase64,this.enablesXDR=!!i.enablesXDR,this.timestampParam=i.timestampParam||"t",this.timestampRequests=i.timestampRequests,this.transports=i.transports||["polling","websocket"],this.transportOptions=i.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=i.policyPort||843,this.rememberUpgrade=i.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=i.onlyBinaryUpgrades,this.perMessageDeflate=!1!==i.perMessageDeflate&&(i.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=i.pfx||null,this.key=i.key||null,this.passphrase=i.passphrase||null,this.cert=i.cert||null,this.ca=i.ca||null,this.ciphers=i.ciphers||null,this.rejectUnauthorized=void 0===i.rejectUnauthorized||i.rejectUnauthorized,this.forceNode=!!i.forceNode;var o="object"==typeof t&&t;o.global===o&&(i.extraHeaders&&Object.keys(i.extraHeaders).length>0&&(this.extraHeaders=i.extraHeaders),i.localAddress&&(this.localAddress=i.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}var o=i(16),r=i(8),s=i(3)("engine.io-client:socket"),a=i(36),h=i(22),l=i(2),c=i(30);e.exports=n,n.priorWebsocketSuccess=!1,r(n.prototype),n.protocol=h.protocol,n.Socket=n,n.Transport=i(21),n.transports=i(16),n.parser=i(22),n.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}(this.query);t.EIO=h.protocol,t.transport=e;var i=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new o[e]({query:t,socket:this,agent:i.agent||this.agent,hostname:i.hostname||this.hostname,port:i.port||this.port,secure:i.secure||this.secure,path:i.path||this.path,forceJSONP:i.forceJSONP||this.forceJSONP,jsonp:i.jsonp||this.jsonp,forceBase64:i.forceBase64||this.forceBase64,enablesXDR:i.enablesXDR||this.enablesXDR,timestampRequests:i.timestampRequests||this.timestampRequests,timestampParam:i.timestampParam||this.timestampParam,policyPort:i.policyPort||this.policyPort,pfx:i.pfx||this.pfx,key:i.key||this.key,passphrase:i.passphrase||this.passphrase,cert:i.cert||this.cert,ca:i.ca||this.ca,ciphers:i.ciphers||this.ciphers,rejectUnauthorized:i.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:i.perMessageDeflate||this.perMessageDeflate,extraHeaders:i.extraHeaders||this.extraHeaders,forceNode:i.forceNode||this.forceNode,localAddress:i.localAddress||this.localAddress,requestTimeout:i.requestTimeout||this.requestTimeout,protocols:i.protocols||void 0})},n.prototype.open=function(){var e;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},n.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},n.prototype.probe=function(e){function t(){if(d.onlyBinaryUpgrades){var t=!this.supportsBinary&&d.transport.supportsBinary;u=u||t}u||(s('probe transport "%s" opened',e),c.send([{type:"ping",data:"probe"}]),c.once("packet",function(t){if(!u)if("pong"===t.type&&"probe"===t.data){if(s('probe transport "%s" pong',e),d.upgrading=!0,d.emit("upgrading",c),!c)return;n.priorWebsocketSuccess="websocket"===c.name,s('pausing current transport "%s"',d.transport.name),d.transport.pause(function(){u||"closed"!==d.readyState&&(s("changing transport and sending upgrade packet"),l(),d.setTransport(c),c.send([{type:"upgrade"}]),d.emit("upgrade",c),c=null,d.upgrading=!1,d.flush())})}else{s('probe transport "%s" failed',e);var i=new Error("probe error");i.transport=c.name,d.emit("upgradeError",i)}}))}function i(){u||(u=!0,l(),c.close(),c=null)}function o(t){var n=new Error("probe error: "+t);n.transport=c.name,i(),s('probe transport "%s" failed because of error: %s',e,t),d.emit("upgradeError",n)}function r(){o("transport closed")}function a(){o("socket closed")}function h(e){c&&e.name!==c.name&&(s('"%s" works - aborting "%s"',e.name,c.name),i())}function l(){c.removeListener("open",t),c.removeListener("error",o),c.removeListener("close",r),d.removeListener("close",a),d.removeListener("upgrading",h)}s('probing transport "%s"',e);var c=this.createTransport(e,{probe:1}),u=!1,d=this;n.priorWebsocketSuccess=!1,c.once("open",t),c.once("error",o),c.once("close",r),this.once("close",a),this.once("upgrading",h),c.open()},n.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},n.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},n.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},n.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},n.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(e,t,i){return this.sendPacket("message",e,t,i),this},n.prototype.sendPacket=function(e,t,i,n){if("function"==typeof t&&(n=t,t=void 0),"function"==typeof i&&(n=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){(i=i||{}).compress=!1!==i.compress;var o={type:e,data:t,options:i};this.emit("packetCreate",o),this.writeBuffer.push(o),n&&this.once("flush",n),this.flush()}},n.prototype.close=function(){function e(){n.onClose("forced close"),s("socket closing - telling transport to close"),n.transport.close()}function t(){n.removeListener("upgrade",t),n.removeListener("upgradeError",t),e()}function i(){n.once("upgrade",t),n.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():e()}):this.upgrading?i():e()}return this},n.prototype.onError=function(e){s("socket error %j",e),n.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},n.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){s('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},n.prototype.filterUpgrades=function(e){for(var t=[],i=0,n=e.length;i<n;i++)~a(this.transports,e[i])&&t.push(e[i]);return t}}).call(t,function(){return this}())},function(e,t,i){(function(e){var n=i(17),o=i(19),r=i(33),s=i(34);t.polling=function(t){var i=!1,s=!1,a=!1!==t.jsonp;if(e.location){var h="https:"===location.protocol,l=location.port;l||(l=h?443:80),i=t.hostname!==location.hostname||l!==t.port,s=t.secure!==h}if(t.xdomain=i,t.xscheme=s,"open"in new n(t)&&!t.forceJSONP)return new o(t);if(!a)throw new Error("JSONP disabled");return new r(t)},t.websocket=s}).call(t,function(){return this}())},function(e,t,i){(function(t){var n=i(18);e.exports=function(e){var i=e.xdomain,o=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!i||n))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!o&&r)return new XDomainRequest}catch(e){}if(!i)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(t,function(){return this}())},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,i){(function(t){function n(){}function o(e){if(h.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,t.location){var i="https:"===location.protocol,n=location.port;n||(n=i?443:80),this.xd=e.hostname!==t.location.hostname||n!==e.port,this.xs=e.secure!==i}}function r(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function s(){for(var e in r.requests)r.requests.hasOwnProperty(e)&&r.requests[e].abort()}var a=i(17),h=i(20),l=i(8),c=i(31),u=i(3)("engine.io-client:polling-xhr");e.exports=o,e.exports.Request=r,c(o,h),o.prototype.supportsBinary=!0,o.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new r(e)},o.prototype.doWrite=function(e,t){var i="string"!=typeof e&&void 0!==e,n=this.request({method:"POST",data:e,isBinary:i}),o=this;n.on("success",t),n.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=n},o.prototype.doPoll=function(){u("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},l(r.prototype),r.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var i=this.xhr=new a(e),n=this;try{u("xhr open %s: %s",this.method,this.uri),i.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this.extraHeaders[o])}catch(e){}if("POST"===this.method)try{this.isBinary?i.setRequestHeader("Content-type","application/octet-stream"):i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{i.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in i&&(i.withCredentials=!0),this.requestTimeout&&(i.timeout=this.requestTimeout),this.hasXDR()?(i.onload=function(){n.onLoad()},i.onerror=function(){n.onError(i.responseText)}):i.onreadystatechange=function(){if(2===i.readyState){var e;try{e=i.getResponseHeader("Content-Type")}catch(e){}"application/octet-stream"===e&&(i.responseType="arraybuffer")}4===i.readyState&&(200===i.status||1223===i.status?n.onLoad():setTimeout(function(){n.onError(i.status)},0))},u("xhr data %s",this.data),i.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}t.document&&(this.index=r.requestsCount++,r.requests[this.index]=this)},r.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},r.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},r.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},r.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,e)try{this.xhr.abort()}catch(e){}t.document&&delete r.requests[this.index],this.xhr=null}},r.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},r.prototype.hasXDR=function(){return void 0!==t.XDomainRequest&&!this.xs&&this.enablesXDR},r.prototype.abort=function(){this.cleanup()},r.requestsCount=0,r.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",s):t.addEventListener&&t.addEventListener("beforeunload",s,!1))}).call(t,function(){return this}())},function(e,t,i){function n(e){var t=e&&e.forceBase64;c&&!t||(this.supportsBinary=!1),o.call(this,e)}var o=i(21),r=i(30),s=i(22),a=i(31),h=i(32),l=i(3)("engine.io-client:polling");e.exports=n;var c=null!=new(i(17))({xdomain:!1}).responseType;a(n,o),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(e){function t(){l("paused"),i.readyState="paused",e()}var i=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(l("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){l("pre-pause polling complete"),--n||t()})),this.writable||(l("we are currently writing - waiting to pause"),n++,this.once("drain",function(){l("pre-pause writing complete"),--n||t()}))}else t()},n.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(e){var t=this;l("polling got data %s",e);s.decodePayload(e,this.socket.binaryType,function(e,i,n){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function e(){l("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(l("transport open - closing"),e()):(l("transport not open - deferring close"),this.once("open",e))},n.prototype.write=function(e){var t=this;this.writable=!1;var i=function(){t.writable=!0,t.emit("drain")};s.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,i)})},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(e[this.timestampParam]=h()),this.supportsBinary||e.sid||(e.b64=1),e=r.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(i=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+e}},function(e,t,i){function n(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var o=i(22),r=i(8);e.exports=n,r(n.prototype),n.prototype.onError=function(e,t){var i=new Error(e);return i.type="TransportError",i.description=t,this.emit("error",i),this},n.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(e){var t=o.decodePacket(e,this.socket.binaryType);this.onPacket(t)},n.prototype.onPacket=function(e){this.emit("packet",e)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,i){(function(e){function n(e,i){return i("b"+t.packets[e.type]+e.data.data)}function o(e,i,n){if(!i)return t.encodeBase64Packet(e,n);var o=e.data,r=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=g[e.type];for(var a=0;a<r.length;a++)s[a+1]=r[a];return n(s.buffer)}function r(e,i,n){if(!i)return t.encodeBase64Packet(e,n);if(f)return function(e,i,n){if(!i)return t.encodeBase64Packet(e,n);var o=new FileReader;return o.onload=function(){e.data=o.result,t.encodePacket(e,i,!0,n)},o.readAsArrayBuffer(e.data)}(e,i,n);var o=new Uint8Array(1);return o[0]=g[e.type],n(new w([o.buffer,e.data]))}function s(e,t,i){for(var n=new Array(e.length),o=u(e.length,i),r=function(e,i,o){t(i,function(t,i){n[e]=i,o(t,n)})},s=0;s<e.length;s++)r(s,e[s],o)}var a,h=i(23),l=i(9),c=i(24),u=i(25),d=i(26);e&&e.ArrayBuffer&&(a=i(28));var p="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),m="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),f=p||m;t.protocol=3;var g=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},y=h(g),v={type:"error",data:"parser error"},w=i(29);t.encodePacket=function(t,i,s,a){"function"==typeof i&&(a=i,i=!1),"function"==typeof s&&(a=s,s=null);var h=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&h instanceof ArrayBuffer)return o(t,i,a);if(w&&h instanceof e.Blob)return r(t,i,a);if(h&&h.base64)return n(t,a);var l=g[t.type];return void 0!==t.data&&(l+=s?d.encode(String(t.data),{strict:!1}):String(t.data)),a(""+l)},t.encodeBase64Packet=function(i,n){var o,r="b"+t.packets[i.type];if(w&&i.data instanceof e.Blob){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];n(r+e)},s.readAsDataURL(i.data)}try{o=String.fromCharCode.apply(null,new Uint8Array(i.data))}catch(e){for(var a=new Uint8Array(i.data),h=new Array(a.length),l=0;l<a.length;l++)h[l]=a[l];o=String.fromCharCode.apply(null,h)}return r+=e.btoa(o),n(r)},t.decodePacket=function(e,i,n){if(void 0===e)return v;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),i);if(n&&!1===(e=function(e){try{e=d.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return v;var o=e.charAt(0);return Number(o)==o&&y[o]?e.length>1?{type:y[o],data:e.substring(1)}:{type:y[o]}:v}o=new Uint8Array(e)[0];var r=c(e,1);return w&&"blob"===i&&(r=new w([r])),{type:y[o],data:r}},t.decodeBase64Packet=function(e,t){var i=y[e.charAt(0)];if(!a)return{type:i,data:{base64:!0,data:e.substr(1)}};var n=a.decode(e.substr(1));return"blob"===t&&w&&(n=new w([n])),{type:i,data:n}},t.encodePayload=function(e,i,n){"function"==typeof i&&(n=i,i=null);var o=l(e);return i&&o?w&&!f?t.encodePayloadAsBlob(e,n):t.encodePayloadAsArrayBuffer(e,n):e.length?void s(e,function(e,n){t.encodePacket(e,!!o&&i,!1,function(e){n(null,function(e){return e.length+":"+e}(e))})},function(e,t){return n(t.join(""))}):n("0:")},t.decodePayload=function(e,i,n){if("string"!=typeof e)return t.decodePayloadAsBinary(e,i,n);var o;if("function"==typeof i&&(n=i,i=null),""===e)return n(v,0,1);for(var r,s,a="",h=0,l=e.length;h<l;h++){var c=e.charAt(h);if(":"===c){if(""===a||a!=(r=Number(a)))return n(v,0,1);if(a!=(s=e.substr(h+1,r)).length)return n(v,0,1);if(s.length){if(o=t.decodePacket(s,i,!1),v.type===o.type&&v.data===o.data)return n(v,0,1);if(!1===n(o,h+r,l))return}h+=r,a=""}else a+=c}return""!==a?n(v,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,i){return e.length?void s(e,function(e,i){t.encodePacket(e,!0,!0,function(e){return i(null,e)})},function(e,t){var n=t.reduce(function(e,t){var i;return e+(i="string"==typeof t?t.length:t.byteLength).toString().length+i+2},0),o=new Uint8Array(n),r=0;return t.forEach(function(e){var t="string"==typeof e,i=e;if(t){for(var n=new Uint8Array(e.length),s=0;s<e.length;s++)n[s]=e.charCodeAt(s);i=n.buffer}o[r++]=t?0:1;var a=i.byteLength.toString();for(s=0;s<a.length;s++)o[r++]=parseInt(a[s]);o[r++]=255;for(n=new Uint8Array(i),s=0;s<n.length;s++)o[r++]=n[s]}),i(o.buffer)}):i(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,i){s(e,function(e,i){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);e=n.buffer,t[0]=0}var r=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),s=new Uint8Array(r.length+1);for(o=0;o<r.length;o++)s[o]=parseInt(r[o]);if(s[r.length]=255,w){var a=new w([t.buffer,s.buffer,e]);i(null,a)}})},function(e,t){return i(new w(t))})},t.decodePayloadAsBinary=function(e,i,n){"function"==typeof i&&(n=i,i=null);for(var o=e,r=[];o.byteLength>0;){for(var s=new Uint8Array(o),a=0===s[0],h="",l=1;255!==s[l];l++){if(h.length>310)return n(v,0,1);h+=s[l]}o=c(o,2+h.length),h=parseInt(h);var u=c(o,0,h);if(a)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var d=new Uint8Array(u);u="";for(l=0;l<d.length;l++)u+=String.fromCharCode(d[l])}r.push(u),o=c(o,h)}var p=r.length;r.forEach(function(e,o){n(t.decodePacket(e,i,!0),o,p)})}}).call(t,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t=[],i=Object.prototype.hasOwnProperty;for(var n in e)i.call(e,n)&&t.push(n);return t}},function(e,t){e.exports=function(e,t,i){var n=e.byteLength;if(t=t||0,i=i||n,e.slice)return e.slice(t,i);if(t<0&&(t+=n),i<0&&(i+=n),i>n&&(i=n),t>=n||t>=i||0===n)return new ArrayBuffer(0);for(var o=new Uint8Array(e),r=new Uint8Array(i-t),s=t,a=0;s<i;s++,a++)r[a]=o[s];return r.buffer}},function(e,t){function i(){}e.exports=function(e,t,n){function o(e,i){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(r=!0,t(e),t=n):0!==o.count||r||t(null,i)}var r=!1;return n=n||i,o.count=e,0===e?t():o}},function(e,t,i){var n;(function(e,o){!function(r){function s(e){for(var t,i,n=[],o=0,r=e.length;o<r;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<r?56320==(64512&(i=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&i)+65536):(n.push(t),o--):n.push(t);return n}function a(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function h(e,t){return g(e>>t&63|128)}function l(e,t){if(0==(4294967168&e))return g(e);var i="";return 0==(4294965248&e)?i=g(e>>6&31|192):0==(4294901760&e)?(a(e,t)||(e=65533),i=g(e>>12&15|224),i+=h(e,6)):0==(4292870144&e)&&(i=g(e>>18&7|240),i+=h(e,12),i+=h(e,6)),i+g(63&e|128)}function c(){if(f>=m)throw Error("Invalid byte index");var e=255&p[f];if(f++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function u(e){var t,i;if(f>m)throw Error("Invalid byte index");if(f==m)return!1;if(t=255&p[f],f++,0==(128&t))return t;if(192==(224&t)){if((i=(31&t)<<6|c())>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&t)){if((i=(15&t)<<12|c()<<6|c())>=2048)return a(i,e)?i:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&((i=(7&t)<<18|c()<<12|c()<<6|c())>=65536&&i<=1114111))return i;throw Error("Invalid UTF-8 detected")}var d=("object"==typeof e&&e&&e.exports,"object"==typeof o&&o);d.global!==d&&d.window;var p,m,f,g=String.fromCharCode,y={version:"2.1.2",encode:function(e,t){for(var i=!1!==(t=t||{}).strict,n=s(e),o=n.length,r=-1,a="";++r<o;)a+=l(n[r],i);return a},decode:function(e,t){var i=!1!==(t=t||{}).strict;p=s(e),m=p.length,f=0;for(var n,o=[];!1!==(n=u(i));)o.push(n);return function(e){for(var t,i=e.length,n=-1,o="";++n<i;)(t=e[n])>65535&&(o+=g((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=g(t);return o}(o)}};void 0===(n=function(){return y}.call(t,i,t,e))||(e.exports=n)}()}).call(t,i(27)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),n=0;n<e.length;n++)i[e.charCodeAt(n)]=n;t.encode=function(t){var i,n=new Uint8Array(t),o=n.length,r="";for(i=0;i<o;i+=3)r+=e[n[i]>>2],r+=e[(3&n[i])<<4|n[i+1]>>4],r+=e[(15&n[i+1])<<2|n[i+2]>>6],r+=e[63&n[i+2]];return o%3==2?r=r.substring(0,r.length-1)+"=":o%3==1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(e){var t,n,o,r,s,a=.75*e.length,h=e.length,l=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),u=new Uint8Array(c);for(t=0;t<h;t+=4)n=i[e.charCodeAt(t)],o=i[e.charCodeAt(t+1)],r=i[e.charCodeAt(t+2)],s=i[e.charCodeAt(t+3)],u[l++]=n<<2|o>>4,u[l++]=(15&o)<<4|r>>2,u[l++]=(3&r)<<6|63&s;return c}}()},function(e,t){(function(t){function i(e){for(var t=0;t<e.length;t++){var i=e[t];if(i.buffer instanceof ArrayBuffer){var n=i.buffer;if(i.byteLength!==n.byteLength){var o=new Uint8Array(i.byteLength);o.set(new Uint8Array(n,i.byteOffset,i.byteLength)),n=o.buffer}e[t]=n}}}function n(e,t){t=t||{};var n=new r;i(e);for(var o=0;o<e.length;o++)n.append(e[o]);return t.type?n.getBlob(t.type):n.getBlob()}function o(e,t){return i(e),new Blob(e,t||{})}var r=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,s=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),a=s&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),h=r&&r.prototype.append&&r.prototype.getBlob;e.exports=s?a?t.Blob:o:h?n:void 0}).call(t,function(){return this}())},function(e,t){t.encode=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&(t.length&&(t+="&"),t+=encodeURIComponent(i)+"="+encodeURIComponent(e[i]));return t},t.decode=function(e){for(var t={},i=e.split("&"),n=0,o=i.length;n<o;n++){var r=i[n].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}},function(e,t){e.exports=function(e,t){var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},function(e,t){"use strict";function i(e){var t="";do{t=r[e%s]+t,e=Math.floor(e/s)}while(e>0);return t}function n(){var e=i(+new Date);return e!==o?(h=0,o=e):e+"."+i(h++)}for(var o,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s=64,a={},h=0,l=0;l<s;l++)a[r[l]]=l;n.encode=i,n.decode=function(e){var t=0;for(l=0;l<e.length;l++)t=t*s+a[e.charAt(l)];return t},e.exports=n},function(e,t,i){(function(t){function n(){}function o(e){r.call(this,e),this.query=this.query||{},a||(t.___eio||(t.___eio=[]),a=t.___eio),this.index=a.length;var i=this;a.push(function(e){i.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){i.script&&(i.script.onerror=n)},!1)}var r=i(20),s=i(31);e.exports=o;var a,h=/\n/g,l=/\\n/g;s(o,r),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},o.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(t,i):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},o.prototype.doWrite=function(e,t){function i(){n(),t()}function n(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+o.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=o.iframeId,r.src="javascript:0"}r.id=o.iframeId,o.form.appendChild(r),o.iframe=r}var o=this;if(!this.form){var r,s=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=c,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}this.form.action=this.uri(),n(),e=e.replace(l,"\\\n"),this.area.value=e.replace(h,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&i()}:this.iframe.onload=i}}).call(t,function(){return this}())},function(e,t,i){(function(t){function n(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=u&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(d=o),r.call(this,e)}var o,r=i(21),s=i(22),a=i(30),h=i(31),l=i(32),c=i(3)("engine.io-client:websocket"),u=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{o=i(35)}catch(e){}var d=u;d||"undefined"!=typeof window||(d=o),e.exports=n,h(n,r),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.localAddress&&(i.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new d(e,t):new d(e):new d(e,t,i)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},n.prototype.write=function(e){var i=this;this.writable=!1;for(var n=e.length,o=0,r=n;o<r;o++)!function(e){s.encodePacket(e,i.supportsBinary,function(o){if(!i.usingBrowserWebSocket){var r={};if(e.options&&(r.compress=e.options.compress),i.perMessageDeflate)("string"==typeof o?t.Buffer.byteLength(o):o.length)<i.perMessageDeflate.threshold&&(r.compress=!1)}try{i.usingBrowserWebSocket?i.ws.send(o):i.ws.send(o,r)}catch(e){c("websocket closed before onclose event")}--n||(i.emit("flush"),setTimeout(function(){i.writable=!0,i.emit("drain")},0))})}(e[o])},n.prototype.onClose=function(){r.prototype.onClose.call(this)},n.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",i="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(i=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=l()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+e},n.prototype.check=function(){return!(!d||"__initialize"in d&&this.name===n.prototype.name)}}).call(t,function(){return this}())},function(e,t){},function(e,t){var i=[].indexOf;e.exports=function(e,t){if(i)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},function(e,t,i){"use strict";function n(e,t,i){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=i(7),s=i(8),a=i(38),h=i(39),l=i(40),c=i(3)("socket.io-client:socket"),u=i(30);e.exports=n;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=s.prototype.emit;s(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[h(e,"open",l(this,"onopen")),h(e,"packet",l(this,"onpacket")),h(e,"close",l(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},n.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},n.prototype.emit=function(e){if(d.hasOwnProperty(e))return p.apply(this,arguments),this;var t=a(arguments),i={type:r.EVENT,data:t,options:{}};return i.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),delete this.flags,this},n.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},n.prototype.onopen=function(){if(c("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===o(this.query)?u.encode(this.query):this.query;c("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},n.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},n.prototype.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},n.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},n.prototype.ack=function(e){var t=this,i=!1;return function(){if(!i){i=!0;var n=a(arguments);c("sending ack %j",n),t.packet({type:r.ACK,id:e,data:n})}}},n.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){e.exports=function(e,t){for(var i=[],n=(t=t||0)||0;n<e.length;n++)i[n-t]=e[n];return i}},function(e,t){"use strict";e.exports=function(e,t,i){return e.on(t,i),{destroy:function(){e.removeListener(t,i)}}}},function(e,t){var i=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=i.call(arguments,2);return function(){return t.apply(e,n.concat(i.call(arguments)))}}},function(e,t){function i(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=i,i.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),i=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-i:e+i}return 0|Math.min(e,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(e){this.ms=e},i.prototype.setMax=function(e){this.max=e},i.prototype.setJitter=function(e){this.jitter=e}}])}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).store=e()}}(function(){return function e(t,i,n){function o(s,a){if(!i[s]){if(!t[s]){var h="function"==typeof require&&require;if(!a&&h)return h(s,!0);if(r)return r(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[s]={exports:{}};t[s][0].call(c.exports,function(e){var i=t[s][1][e];return o(i||e)},c,c.exports,e,t,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,i){"use strict";var n=e("../src/store-engine"),o=[e("../storages/localStorage"),e("../storages/sessionStorage"),e("../storages/cookieStorage"),e("../storages/memoryStorage")];t.exports=n.createStore(o,[])},{"../src/store-engine":2,"../storages/cookieStorage":4,"../storages/localStorage":5,"../storages/memoryStorage":6,"../storages/sessionStorage":7}],2:[function(e,t,i){"use strict";function n(e,t,i){i||(i=""),e&&!c(e)&&(e=[e]),t&&!c(t)&&(t=[t]);var n=i?"__storejs_"+i+"_":"",o=i?new RegExp("^"+n):null;if(!/^[a-zA-Z0-9_\-]*$/.test(i))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var m=l({_namespacePrefix:n,_namespaceRegexp:o,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var i=e.read(t)===t;return e.remove(t),i}catch(e){return!1}},_assignPluginFnProp:function(e,t){var i=this[t];this[t]=function(){var t=r(arguments,0),n=this,o=[function(){if(i)return a(arguments,function(e,i){t[i]=e}),i.apply(n,t)}].concat(t);return e.apply(n,o)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var i="";try{i=JSON.parse(e)}catch(t){i=e}return void 0!==i?i:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(c(e))a(e,function(e){t._addPlugin(e)});else if(!s(this.plugins,function(t){return e===t})){if(this.plugins.push(e),!u(e))throw new Error("Plugins must be function values that return objects");var i=e.call(this);if(!d(i))throw new Error("Plugins must return an object of function properties");a(i,function(i,n){if(!u(i))throw new Error("Bad plugin property: "+n+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(i,n)})}},addStorage:function(e){(function(){var e="undefined"==typeof console?null:console;e&&(e.warn?e.warn:e.log).apply(e,arguments)})("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},p,{plugins:[]});return m.raw={},a(m,function(e,t){u(e)&&(m.raw[t]=h(m,e))}),a(e,function(e){m._addStorage(e)}),a(t,function(e){m._addPlugin(e)}),m}var o=e("./util"),r=o.slice,s=o.pluck,a=o.each,h=o.bind,l=o.create,c=o.isList,u=o.isFunction,d=o.isObject;t.exports={createStore:n};var p={version:"2.0.12",enabled:!1,get:function(e,t){var i=this.storage.read(this._namespacePrefix+e);return this._deserialize(i,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each(function(i,n){e.call(t,t._deserialize(i),(n||"").replace(t._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return n.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return n(this.storage,this.plugins,e)}}},{"./util":3}],3:[function(e,t,i){(function(e){"use strict";function i(e,t){return Array.prototype.slice.call(e,t||0)}function n(e,t){o(e,function(e,i){return t(e,i),!1})}function o(e,t){if(r(e)){for(var i=0;i<e.length;i++)if(t(e[i],i))return e[i]}else for(var n in e)if(e.hasOwnProperty(n)&&t(e[n],n))return e[n]}function r(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}var s=Object.assign?Object.assign:function(e,t,i,o){for(var r=1;r<arguments.length;r++)n(Object(arguments[r]),function(t,i){e[i]=t});return e},a=function(){if(Object.create)return function(e,t,n,o){var r=i(arguments,1);return s.apply(this,[Object.create(e)].concat(r))};var e=function(){};return function(t,n,o,r){var a=i(arguments,1);return e.prototype=t,s.apply(this,[new e].concat(a))}}(),h=String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},l="undefined"!=typeof window?window:e;t.exports={assign:s,create:a,trim:h,bind:function(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}},slice:i,each:n,map:function(e,t){var i=r(e)?[]:{};return o(e,function(e,n){return i[n]=t(e,n),!1}),i},pluck:o,isList:r,isFunction:function(e){return e&&"[object Function]"==={}.toString.call(e)},isObject:function(e){return e&&"[object Object]"==={}.toString.call(e)},Global:l}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,i){"use strict";function n(e){for(var t=l.cookie.split(/; ?/g),i=t.length-1;i>=0;i--)if(h(t[i])){var n=t[i].split("="),o=unescape(n[0]);e(unescape(n[1]),o)}}function o(e){e&&r(e)&&(l.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function r(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(l.cookie)}var s=e("../src/util"),a=s.Global,h=s.trim;t.exports={name:"cookieStorage",read:function(e){if(!e||!r(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(l.cookie.replace(new RegExp(t),"$1"))},write:function(e,t){e&&(l.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")},each:n,remove:o,clearAll:function(){n(function(e,t){o(t)})}};var l=a.document},{"../src/util":3}],5:[function(e,t,i){"use strict";function n(){return r.localStorage}function o(e){return n().getItem(e)}var r=e("../src/util").Global;t.exports={name:"localStorage",read:o,write:function(e,t){return n().setItem(e,t)},each:function(e){for(var t=n().length-1;t>=0;t--){var i=n().key(t);e(o(i),i)}},remove:function(e){return n().removeItem(e)},clearAll:function(){return n().clear()}}},{"../src/util":3}],6:[function(e,t,i){"use strict";t.exports={name:"memoryStorage",read:function(e){return n[e]},write:function(e,t){n[e]=t},each:function(e){for(var t in n)n.hasOwnProperty(t)&&e(n[t],t)},remove:function(e){delete n[e]},clearAll:function(e){n={}}};var n={}},{}],7:[function(e,t,i){"use strict";function n(){return r.sessionStorage}function o(e){return n().getItem(e)}var r=e("../src/util").Global;t.exports={name:"sessionStorage",read:o,write:function(e,t){return n().setItem(e,t)},each:function(e){for(var t=n().length-1;t>=0;t--){var i=n().key(t);e(o(i),i)}},remove:function(e){return n().removeItem(e)},clearAll:function(){return n().clear()}}},{"../src/util":3}]},{},[1])(1)});const game={onload(){if(this.options={},me.device.isMobile?this.options=this.default_options.mobile:this.options=this.default_options.default,this.options.sound=this.default_options.sound,this.options=this.storage.checkOptions(this.options),!me.video.init(this.options.resolution.width,this.options.resolution.height,this.options.rendering))return void alert("Your browser does not support HTML5 canvas.");let e;switch(me.audio.setVolume(this.options.sound.volume),this.options.sound.muted?me.audio.muteAll():me.audio.unmuteAll(),!0===me.game.HASH.debug&&me.device.onReady(()=>{me.plugin.register.defer(this,me.debug.Panel,"debug",me.input.KEY.P)}),me.device.isMobile&&me.device.hasAccelerometer&&me.device.watchAccelerometer(),me.audio.init("mp3,ogg"),me.loader.onload=this.loaded.bind(this),me.loader.preload(game.resources),game.options.sound.quality){case"high":e="high_res/";break;case"mid":e="mid_res/";break;default:e=""}for(let t=0;t<game.music_resources.length;t+=1)game.music_resources[t].src+=e;me.loader.preload(game.music_resources),me.state.change(me.state.LOADING),me.sys.gravity=0},loaded(){me.pool.register("player",game.Entities.Player),me.pool.register("enemy",game.Entities.Enemy,!0),me.pool.register("boss",game.Entities.Boss,!0),me.pool.register("laser",game.Entities.Laser,!0),me.pool.register("bomb",game.Entities.Weapons.Bomb,!0),me.pool.register("trident",game.Entities.Weapons.Trident,!0),me.pool.register("trident-bomb",game.Entities.Weapons.Trident,!0),me.pool.register("shotgun",game.Entities.Weapons.Shotgun,!0),me.pool.register("single",game.Entities.Weapons.Enemy.Single,!0),me.pool.register("dual",game.Entities.Weapons.Enemy.Dual,!0),this.playing=new game.Screens.Play,me.state.set(me.state.PLAY,this.playing),me.state.set(me.state.GAMEOVER,new game.Screens.Lost),me.state.set(me.state.GAME_END,new game.Screens.Won),me.state.set(me.state.MENU,new game.Screens.Start),me.state.set(me.state.SCORE,new game.Screens.Highscores),me.state.set(me.state.SETTINGS,new game.Screens.Settings),me.state.HELP=me.state.USER,me.state.set(me.state.HELP,new game.Screens.Help),me.state.CREDITS=me.state.USER+1,me.state.set(me.state.CREDITS,new game.Screens.Credits),game.data.startPlayTime=new Date,me.state.change(me.state.MENU)},resources:[{name:"fire",type:"audio",src:"data/sfx/"},{name:"hit",type:"audio",src:"data/sfx/"},{name:"lost",type:"audio",src:"data/sfx/"},{name:"won",type:"audio",src:"data/sfx/"},{name:"bosses",type:"image",src:"data/img/bosses.png"},{name:"player",type:"image",src:"data/img/player.png"},{name:"ships",type:"image",src:"data/img/ships.png"},{name:"ships2",type:"image",src:"data/img/ships2.png"},{name:"exit_hover",type:"image",src:"data/img/ui/settings/exit_hover.png"},{name:"exit",type:"image",src:"data/img/ui/settings/exit.png"},{name:"save_hover",type:"image",src:"data/img/ui/settings/save_hover.png"},{name:"save",type:"image",src:"data/img/ui/settings/save.png"},{name:"sound",type:"image",src:"data/img/ui/sound.png"},{name:"1_hover",type:"image",src:"data/img/ui/startMenu/1_hover.png"},{name:"1",type:"image",src:"data/img/ui/startMenu/1.png"},{name:"2_hover",type:"image",src:"data/img/ui/startMenu/2_hover.png"},{name:"2",type:"image",src:"data/img/ui/startMenu/2.png"},{name:"3_hover",type:"image",src:"data/img/ui/startMenu/3_hover.png"},{name:"3",type:"image",src:"data/img/ui/startMenu/3.png"},{name:"4_hover",type:"image",src:"data/img/ui/startMenu/4_hover.png"},{name:"4",type:"image",src:"data/img/ui/startMenu/4.png"},{name:"5_hover",type:"image",src:"data/img/ui/startMenu/5_hover.png"},{name:"5",type:"image",src:"data/img/ui/startMenu/5.png"},{name:"weapons",type:"image",src:"data/img/ui/weapons.png"}],music_resources:[{name:"cold_stone",type:"audio",src:"data/bgm/"},{name:"deathmatch",type:"audio",src:"data/bgm/"},{name:"rain_of_lasers",type:"audio",src:"data/bgm/"},{name:"tronicles",type:"audio",src:"data/bgm/"}],constants:{highscoresURI:"https://spaceinvader-highscores.herokuapp.com",version:"0.2.4",version_date:"2018/03/17",bufferTimeLimitMS:3e3}};game.data={score:0,levelscore:0,level:0,player:{startingHealth:200,positionOffset:25},startPlayTime:new Date,weaponEquipped:0},game.default_options={sound:{quality:"low",volume:.7,muted:!1,changeRatio:{wheel:5e-4,keys:.025}},mobile:{resolution:{width:1024,height:768},rendering:{wrapper:"screen",scale:"auto",scaleMethod:"flex-width",antiAlias:"true",doubleBuffering:"true"}},default:{resolution:{width:1024,height:768},rendering:{wrapper:"screen",scale:"auto",scaleMethod:"flex-width",antiAlias:"true",doubleBuffering:"true"}}},game.settingsOptions=[{title:"RESOLUTION",id:"resolution",options:[{value:{width:800,height:600},text:"800x600"},{value:{width:1024,height:768},text:"1024x768"},{value:{width:1600,height:900},text:"1600x900"},{value:{width:1920,height:1080},text:"1920x1080"}]},{title:"SCALE",id:"scale",options:[{value:"auto",text:"auto"},{value:"1",text:"1"},{value:"0.5",text:"0.5"},{value:"2",text:"2"}]},{title:"SCALE METHOD",id:"scaleMethod",options:[{value:"fit",text:"fit"},{value:"fill-min",text:"fill-min"},{value:"fill-max",text:"fill-max"},{value:"flex",text:"flex"},{value:"flex-width",text:"flex-width"},{value:"flex-height",text:"flex-height"},{value:"stretch",text:"stretch"}]},{title:"ANTI-ALIAS",id:"antiAlias",options:[{value:"true",text:"Enabled"},{value:"false",text:"Disabled"}]},{title:"DOUBLE BUFFERING",id:"doubleBuffering",options:[{value:"true",text:"Enabled"},{value:"false",text:"Disabled"}]},{title:"SOUND QUALITY",id:"sound",options:[{value:"low",text:"Low"},{value:"mid",text:"Mid"},{value:"high",text:"High"}]}];const optionsKey="options";game.storage={checkOptions(e){const t=store.get(optionsKey);return t||this.saveOptions(e)},saveOptions:e=>store.set(optionsKey,e),clearOptions:()=>store.remove(optionsKey),clearAll:()=>store.clearAll()},game.data=game.data||{},game.data.weapons=[{name:"shotgun",damage:100,ammunition:3,reloadAmount:3,reloadCost:9,extraArg:3},{name:"trident",damage:150,ammunition:4,reloadAmount:4,reloadCost:15,extraArg:!0},{name:"bomb",damage:50,ammunition:2,reloadAmount:2,reloadCost:20},{name:"trident-bomb",damage:100,ammunition:5,reloadAmount:5,reloadCost:15}],game.data.enemyWeapons=[{name:"single",damage:50},{name:"dual",damage:50}],game.Entities=game.Entities||{},game.Entities.Boss=me.Entity.extend({init(e,t,{type:i,grid:n}){this._super(me.Entity,"init",[e,t,{image:"bosses",width:128,height:128}]),this.anchorPoint.set(.5,.5),this.body.setVelocity(0,0),this.body.collisionType=me.collision.types.ENEMY_OBJECT,this.grid=n,this.alive=!0,this.buildShip(i)},update(e){return this._super(me.Entity,"update",[e]),this.body.update(),!0},buildShip(e){this.type=game.Entities.EnemyList[e].boss,this.renderable.addAnimation("idle",[this.type.frame],1),this.renderable.setCurrentAnimation("idle"),this.stats={health:this.type.health,armor:this.type.armor,points:this.type.points},this.weapons=this.type.fire.weapons.map(e=>game.data.enemyWeapons[e]),this.fireInterval=setInterval(()=>{const{name:e}=this.weapons[Math.floor(Math.random()*this.weapons.length)];me.game.world.addChild(me.pool.pull(e,this._absPos.x+this.width/2,this._absPos.y+this.height))},this.type.fire.rate)},onDestroyEvent(){clearInterval(this.fireInterval)}}),game.Entities=game.Entities||{},game.Entities.Enemy=me.Entity.extend({init(e,t,{type:i,grid:n}){this._super(me.Entity,"init",[e,t,{image:"ships",width:64,height:64}]),this.anchorPoint.set(.5,.5),this.body.setVelocity(0,0),this.body.collisionType=me.collision.types.ENEMY_OBJECT,this.grid=n,this.alive=!0,this.buildShip(i)},update(e){return this._super(me.Entity,"update",[e]),this.body.update(),!0},buildShip(e){this.type=game.Entities.EnemyList[e],this.renderable.addAnimation("idle",[this.type.frame],1),this.renderable.setCurrentAnimation("idle"),this.stats={health:this.type.health,armor:this.type.armor,points:this.type.points}}}),game.Entities=game.Entities||{},game.Entities.EnemyManager=me.Container.extend({init(e){this.enemyConfig=e,me.device.isMobile?this.baseAmountOfMoves=20:this.baseAmountOfMoves=32,this.COLS=Math.floor((me.game.viewport.width-32)/96),this.ROWS=4;const t=me.game.viewport.width-96*this.COLS+32;this.baseSpeed={x:t/this.baseAmountOfMoves,y:15},this._super(me.Container,"init",[0,32,96*this.COLS-32,76*this.ROWS-32]),this.anchorPoint.set(0,0),this.alwaysUpdate=!0,(game.data.level+1)%10==0?(this.baseSpeed.x*=1.1,this.baseSpeed.y*=.5):(game.data.level+1)%5==0&&(this.baseSpeed.x*=1.05),this.vel=this.baseSpeed.x,this.createEnemies()},update(e){0===this.children.length&&this.createdEnemies&&(game.data.endPlayTime=new Date-game.data.startPlayTime,me.state.change(me.state.GAME_END)),this._super(me.Container,"update",[e]),this.updateChildBounds()},onActivateEvent(){game.data.movementTime=50-(1.05*game.data.level)**1.5,this.timer={current:null,start(e,t){return this.current=me.timer.setInterval(e,t),this.current},stop(){me.timer.clearInterval(this.current),this.current=null},change(e,t){return me.timer.clearInterval(this.current),this.current=me.timer.setInterval(e,t),this.current}},this.moveEnemies(!0)},onDeactivateEvent(){this.timer.stop()},removeChildNow(e){const t=this.childBounds.width;this._super(me.Container,"removeChildNow",[e]),this.updateChildBounds(),t>this.childBounds.width&&(this.vel*=1.05)},createEnemies(){let e,t,i=0;const n=[];let{probability:o,boss:r}=this.enemyConfig;if(!o)for(o=[],e=0;e<this.enemyConfig.enemies.length;e+=1)o.push(~~(4*Math.random()));for(e=0;e<o.length;e+=1)n.push({weight:o[e],id:this.enemyConfig.enemies[e]});const s=Math.round(this.COLS/2)-1;let a=!r;for(t=0;t<this.ROWS;t+=1)for(e=0;e<this.COLS;e+=1){if(a||e!==s)(!r||r&&e!==s&&e!==s+1||t>=this.ROWS-2)&&this.addChild(me.pool.pull("enemy",96*e,76*t,{type:rwc(n),grid:{x:e,y:t}}));else for(a=!0,this.addChild(me.pool.pull("boss",96*e+24,0,{type:r[0],grid:{x:e,y:t}})),e+=2;e<this.COLS;)this.addChild(me.pool.pull("enemy",96*e,76*t,{type:rwc(n),grid:{x:e,y:t}})),e+=1,i+=1;i+=1}return this.updateChildBounds(),this.createdEnemies=!0,this.amountOfEnemiesCreated=i,i},outOfBounds(){const e=this.vel,{left:t,right:i}=this.childBounds;return e>0&&i+e>=me.game.viewport.width||e<0&&t+e<=0},moveEnemies(e){this.outOfBounds(this.vel)?(game.data.movementTime-=.25,this.vel*=-1,this.pos.y+=this.baseSpeed.y+.25*game.data.level,game.playing.checkIfLoss(this.childBounds.bottom)||this.timer.change(()=>{this.moveEnemies()},game.data.movementTime)):(e&&this.timer.start(()=>{this.moveEnemies()},game.data.movementTime),this.pos.x+=this.vel)}}),game.Entities.EnemyList=[{health:100,armor:1,frame:0,points:10,boss:{health:5e3,armor:3,frame:0,points:450,fire:{rate:1e3,weapons:[0,1]}}},{health:155,armor:2,frame:1,points:15,boss:{health:7500,armor:3,frame:1,points:600}},{health:200,armor:2,frame:2,points:20,boss:{health:8e3,armor:3,frame:1,points:750}},{health:300,armor:3,frame:3,points:25,boss:{health:1e4,armor:3,frame:1,points:1e3}}],game.Entities=game.Entities||{},game.Entities.Laser=me.Entity.extend({init(e,t,i="n",n=50,o){switch(this._super(me.Entity,"init",[e,t,{width:game.Entities.Laser.width,height:game.Entities.Laser.height}]),this.z=5,this.damage=n,this.firedByEnemy=o,this.alwaysUpdate=!0,this.renderable=new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,0,game.Entities.Laser.width,game.Entities.Laser.height])},destroy(){},draw(e){const t=e.getColor();o?(e.setColor("#5EFF7E"),e.fillRect(0,0,this.width,this.height),e.setColor("#822929"),e.fillRect(1,1,this.width-2,this.height-2)):(e.setColor("#5EFF7E"),e.fillRect(0,0,this.width,this.height)),e.setColor(t)}})),this.direction=i,this.body.collisionType=me.collision.types.PROJECTILE_OBJECT,this.direction){case"n":case"s":this.body.setVelocity(0,100);break;case"w":case"e":this.body.setVelocity(100,0),this.renderable.currentTransform.rotate(1.55);break;case"ne":case"sw":this.body.setVelocity(50,50),this.renderable.currentTransform.rotate(.75);break;case"nw":case"se":this.body.setVelocity(50,50),this.renderable.currentTransform.rotate(-.75)}},update(e){const t=this.body.accel.x*e/1e3,i=this.body.accel.y*e/1e3;switch(this.direction){case"n":this.body.vel.y-=i;break;case"s":this.body.vel.y+=i;break;case"w":this.body.vel.x-=t;break;case"e":this.body.vel.x+=t;break;case"ne":this.body.vel.x+=t,this.body.vel.y-=i;break;case"nw":this.body.vel.x-=t,this.body.vel.y-=i;break;case"se":this.body.vel.x+=t,this.body.vel.y+=i;break;case"sw":this.body.vel.x-=t,this.body.vel.y+=i}return this.pos.y+this.height<=0&&me.game.world.removeChild(this),this.inViewport||me.game.world.removeChild(this),this.body.update(),me.collision.check(this),!0},onCollision(e,t){if(e.a.firedByEnemy)return t.body.collisionType===me.collision.types.PLAYER_OBJECT&&(me.game.world.removeChild(this),t.stats.health-=this.damage,t.renderable.flicker(500),t.stats.health<=0&&(me.audio.pauseTrack(),game.data.endPlayTime=new Date-game.data.startPlayTime,me.state.change(me.state.GAMEOVER)),me.audio.play("hit"),!0);if(t.body.collisionType===me.collision.types.ENEMY_OBJECT){if(me.game.world.removeChild(this),t.stats.health-=this.damage,t.renderable.flicker(500),t.stats.health<=0&&t.alive){const e=t.stats.points;game.playing.enemyManager.removeChild(t),t.alive&&(t.alive=!1,game.data.levelscore+=e,game.data.score+=e),me.audio.play("hit")}return!0}return!1}}),game.Entities.Laser.width=4,game.Entities.Laser.height=20,game.Entities=game.Entities||{},game.Entities.Player=me.Entity.extend({init(){const e=me.loader.getImage("player");this._super(me.Entity,"init",[me.game.viewport.width/2-e.width/2,me.game.viewport.height-e.height-game.data.player.positionOffset,{image:e,width:64,height:64}]),this.body.collisionType=me.collision.types.PLAYER_OBJECT,this.stats={health:game.data.player.startingHealth},this.maxX=me.game.viewport.width-this.width},update(e){return this._super(me.Entity,"update",[e]),this.movementControls(e),this.shootingControls(),this.volumeControls(),this.pos.x=this.pos.x.clamp(this.width,this.maxX),!0},movementControls(e){(me.input.isKeyPressed("left")||me.device.accelerationX>1)&&(this.pos.x-=450*e/1e3),(me.input.isKeyPressed("right")||me.device.accelerationX<-1)&&(this.pos.x+=450*e/1e3),me.device.isMobile&&(me.device.accelerationX>.4?this.pos.x-=150*e/1e3:me.device.accelerationX<-.4&&(this.pos.x+=150*e/1e3))},shootingControls(){const e=game.data.weaponEquipped;me.input.isKeyPressed("shoot")&&game.data.weapons[e].ammunition>0&&(game.data.weapons[e].ammunition-=1,this.shoot(e)),me.input.isKeyPressed("reload")&&0===game.data.weapons[e].ammunition&&this.reloadEquippedWeapon(),me.input.isKeyPressed("weapon-minus")&&(game.data.weaponEquipped-=1,game.data.weaponEquipped<0&&(game.data.weaponEquipped=3)),me.input.isKeyPressed("weapon-plus")&&(game.data.weaponEquipped+=1,game.data.weaponEquipped>3&&(game.data.weaponEquipped=0),me.device.isMobile&&this.reloadEquippedWeapon())},reloadEquippedWeapon(){const{weaponEquipped:e}=game.data,{ammunition:t,reloadAmount:i,reloadCost:n}=game.data.weapons[e],o=i-t;game.data.score-=Math.floor(o*n/i),game.data.weapons[e].ammunition=game.data.weapons[e].reloadAmount},shoot(e){const{name:t,extraArg:i}=game.data.weapons[e];me.game.world.addChild(me.pool.pull(t,this.pos.x+this.width/2-2,this.pos.y-game.data.player.positionOffset/3-2,i))},volumeControls(){if(me.input.isKeyPressed("volume-plus")){const e=me.audio.getVolume();if(e<=1){const t=e+game.options.sound.changeRatio.keys;game.options.sound.volume=t,me.audio.setVolume(t)}}if(me.input.isKeyPressed("volume-mute")&&(game.options.sound.muted?me.audio.unmuteAll():me.audio.muteAll(),game.options.sound.muted=!game.options.sound.muted),me.input.isKeyPressed("volume-minus")){const e=me.audio.getVolume();if(e>=game.options.sound.changeRatio.keys){const t=e-game.options.sound.changeRatio.keys;game.options.sound.volume=t,me.audio.setVolume(t)}}me.event.subscribe("wheel",e=>{const t=me.audio.getVolume();if(me.input.releasePointerEvent("wheel",me.game.viewport),e.deltaY<0){if(t<=1){const e=t+game.options.sound.changeRatio.wheel;game.options.sound.volume=e,me.audio.setVolume(e)}}else if(t>=game.options.sound.changeRatio.wheel){const e=t-game.options.sound.changeRatio.wheel;game.options.sound.volume=e,me.audio.setVolume(e)}me.input.registerPointerEvent("wheel",me.game.viewport,e=>{me.event.publish("wheel",[e])})})}}),game.Entities=game.Entities||{},game.Entities.Weapons=game.Entities.Weapons||{},game.Entities.Weapons.Bomb=me.Entity.extend({init(e,t){this._super(me.Entity,"init",[e,t,{width:game.Entities.Weapons.Bomb.width/2,height:game.Entities.Weapons.Bomb.height/2}]),this.alwaysUpdate=!0,this.renderable=new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,0,game.Entities.Weapons.Bomb.width,game.Entities.Weapons.Bomb.height])},destroy(){},draw(e){const t=e.getColor();e.setColor("#B80015"),e.fillRect(0,0,this.width,this.height),e.setColor("#FF0"),e.fillRect(5,5,this.width-10,this.height-10),e.setColor(t)}})),this.body.setVelocity(0,10),this.body.collisionType=me.collision.types.PROJECTILE_OBJECT,me.audio.play("fire")},update(e){return this.body.vel.y-=this.body.accel.y*e/1e3,this.inViewport||me.game.world.removeChild(this),this.body.update(),me.collision.check(this),!0},onCollision(e,t){return t.body.collisionType===me.collision.types.ENEMY_OBJECT?(me.game.world.removeChild(this),this.explode(e.a.pos.x,e.a.pos.y),!0):t.body.collisionType!==me.collision.types.PROJECTILE_OBJECT&&void 0},explode(e,t){const{damage:i}=game.Entities.Weapons.Bomb;me.game.world.addChild(me.pool.pull("laser",e,t-15,"n",i)),me.game.world.addChild(me.pool.pull("laser",e+10,t-10,"ne",i)),me.game.world.addChild(me.pool.pull("laser",e-10,t-10,"nw",i)),me.game.world.addChild(me.pool.pull("laser",e,t,"w",i)),me.game.world.addChild(me.pool.pull("laser",e,t,"e",i)),me.game.world.addChild(me.pool.pull("laser",e,t+15,"s",i)),me.game.world.addChild(me.pool.pull("laser",e+10,t+10,"se",i)),me.game.world.addChild(me.pool.pull("laser",e-10,t+10,"sw",i))}}),game.Entities.Weapons.Bomb.damage=game.data.weapons[2].damage,game.Entities.Weapons.Bomb.width=15,game.Entities.Weapons.Bomb.height=15,game.Entities=game.Entities||{},game.Entities.Weapons=game.Entities.Weapons||{},game.Entities.Weapons.Enemy=game.Entities.Weapons.Enemy||{},game.Entities.Weapons.Enemy.Dual=me.Entity.extend({init(e,t){this._super(me.Entity,"init",[e,t,{width:0,height:0}]);const{damage:i}=game.data.enemyWeapons[1];me.game.world.addChild(me.pool.pull("laser",e-15,t,"s",i,!0)),me.game.world.addChild(me.pool.pull("laser",e+15,t,"s",i,!0)),me.audio.play("fire")},update(){me.game.world.removeChild(this)}}),game.Entities=game.Entities||{},game.Entities.Weapons=game.Entities.Weapons||{},game.Entities.Weapons.Enemy=game.Entities.Weapons.Enemy||{},game.Entities.Weapons.Enemy.Single=me.Entity.extend({init(e,t){this._super(me.Entity,"init",[e,t,{width:0,height:0}]);const{damage:i}=game.data.enemyWeapons[0];me.game.world.addChild(me.pool.pull("laser",e,t,"s",i,!0)),me.audio.play("fire")},update(){me.game.world.removeChild(this)}}),game.Entities=game.Entities||{},game.Entities.Weapons=game.Entities.Weapons||{},game.Entities.Weapons.Shotgun=me.Entity.extend({init(e,t,i=3){this._super(me.Entity,"init",[e,t,{width:0,height:0}]),this.split(this.pos.x,this.pos.y,i),me.audio.play("fire")},update(){return me.game.world.removeChild(this),!0},split(e,t,i){const{damage:n}=game.data.weapons[0];me.game.world.addChild(me.pool.pull("laser",e,t-5,"n",n));let o=!0;for(let r=1,s=1;s<i;s+=1)o?me.game.world.addChild(me.pool.pull("laser",e+5*r,t-5-3*r,"n",n)):(me.game.world.addChild(me.pool.pull("laser",e-5*r,t-5-3*r,"n",n)),r+=1),o=!o}}),game.Entities=game.Entities||{},game.Entities.Weapons=game.Entities.Weapons||{},game.Entities.Weapons.Trident=me.Entity.extend({init(e,t,i){this._super(me.Entity,"init",[e,t,{width:game.Entities.Weapons.Trident.width/2,height:game.Entities.Weapons.Trident.height/2}]),this.alwaysUpdate=!0,this.splitFire=i,this.body.setVelocity(0,35),this.body.collisionType=me.collision.types.PROJECTILE_OBJECT,this.renderable=new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,0,game.Entities.Weapons.Trident.width,game.Entities.Weapons.Trident.height])},destroy(){},draw(e){if(!i){const t=e.getColor();e.setColor("#B80015"),e.fillRect(0,0,this.width,this.height),e.setColor("#D90"),e.fillRect(2,2,this.width-5,this.height-5),e.setColor(t)}}})),me.audio.play("fire")},update(e){return this.body.vel.y-=this.body.accel.y*e/1e3,this.inViewport||me.game.world.removeChild(this),this.splitFire&&(me.game.world.removeChild(this),this.split(this.pos.x,this.pos.y)),this.body.update(),me.collision.check(this),!0},onCollision(e,t){return t.body.collisionType===me.collision.types.ENEMY_OBJECT?(me.game.world.removeChild(this),this.split(e.a.pos.x,e.a.pos.y),!0):t.body.collisionType!==me.collision.types.PROJECTILE_OBJECT&&void 0},split(e,t){const{damageRegular:i,damageSplitfire:n}=game.Entities.Weapons.Trident,o=this.splitFire?n:i;me.game.world.addChild(me.pool.pull("laser",e,t-15,"n",o)),me.game.world.addChild(me.pool.pull("laser",e+10,t-10,"ne",o)),me.game.world.addChild(me.pool.pull("laser",e-10,t-10,"nw",o))}}),game.Entities.Weapons.Trident.damage=game.data.weapons[1].damage,game.Entities.Weapons.Trident.damageSplitfire=game.data.weapons[3].damage,game.Entities.Weapons.Trident.width=10,game.Entities.Weapons.Trident.height=20,game.menuButton=me.GUI_Object.extend({init(e,t,i,n,o){this.settings={image:o,imageHover:me.utils.getImage(`${o}_hover`),framewidth:i,frameheight:n},this._super(me.GUI_Object,"init",[e,t,this.settings])},onOver(){this.image=this.settings.imageHover},onOut(){this.image=this.settings.image}}),game.settingsSaveButton=game.menuButton.extend({init(e,t){me.device.isMobile&&(e=me.game.viewport.width/2),this._super(game.menuButton,"init",[e,t,300,50,"settings/save"])},onClick(){me.input.triggerKeyEvent(me.input.KEY.NUM1,!0)},onRelease(){me.input.triggerKeyEvent(me.input.KEY.NUM1,!1)}}),game.settingsExitButton=game.menuButton.extend({init(e,t){me.device.isMobile&&(e=me.game.viewport.width/2,t-=50),this._super(game.menuButton,"init",[e,t,300,50,"settings/exit"])},onClick(){me.input.triggerKeyEvent(me.input.KEY.NUM2,!0)},onRelease(){me.input.triggerKeyEvent(me.input.KEY.NUM2,!1)}}),game.GUI=game.GUI||{},game.GUI.ScoreInput=me.Renderable.extend({init(e,t,i,n){switch(this.$wrapper=$('<div class="wrapper ui action input">').css({top:e}),this.$input=$(`<input type="${t}" placeholder="Your name here" required>`),this.$button=$('<button class="ui button">').text("Submit score").on("click",()=>{const e=this.$input.val();e.length>0&&(this.$input.val("Score sent!"),this.$input.attr("disabled",!0),game.socket.on("score saved",()=>{this.$input.val("Score saved.")}),this.$button.remove(),n(e))}),this.$wrapper.append(this.$input).append(this.$button),t){case"text":this.$input.attr("maxlength",i).attr("pattern","[a-zA-Z0-9_]+");break;case"number":this.$input.attr("max",i)}$(me.video.getWrapper()).append(this.$wrapper)},destroy(){this.$wrapper.remove(),this.$input.remove(),this.$button.remove()}}),game.GUI=game.GUI||{},game.GUI.HUD=game.GUI.HUD||{},game.GUI.HUD.debugContainer=me.Container.extend({init(){this._super(me.Container,"init"),this.isPersistent=!1,this.floating=!0,this.name="debugHUD",this.addChild(new game.GUI.HUD.debugHUD(5,5))}}),game.GUI.HUD.debugHUD=me.Renderable.extend({init(e,t){this._super(me.Renderable,"init",[e,t,10,10]),this.data={font:new me.Font("Serif",24,"#FFFF5C","left"),values:[]}},update(){return this.data.values.length>0},draw(e){let t=30;for(let i=0;i<this.data.values.length;i+=1,t+=20)this.data.font.draw(e,this.data.values[i],5,t);this.data.values.length=0}}),game.GUI=game.GUI||{},game.GUI.HUD=game.GUI.HUD||{},game.GUI.HUD.Container=me.Container.extend({init(){this._super(me.Container,"init"),this.isPersistent=!1,this.floating=!0,this.name="HUD",this.addChild(new game.GUI.HUD.ScoreItem(5,5))}}),game.GUI.HUD.ScoreItem=me.Renderable.extend({init(e,t){this._super(me.Renderable,"init",[e,t,10,10]),this.data={currentWeapon:{sprite:new(me.GUI_Object.extend({init(){const e=me.loader.getImage("weapons");this._super(me.GUI_Object,"init",[50,50,{image:e,frameheight:64,framewidth:64}]),this.pos.z=5,this.addAnimation("shotgun",[0]),this.addAnimation("trident",[1]),this.addAnimation("bomb",[2]),this.addAnimation("trident-bomb",[3])},update(){switch(game.data.weaponEquipped){case 0:return this.setCurrentAnimation("shotgun"),!0;case 1:return this.setCurrentAnimation("trident"),!0;case 2:return this.setCurrentAnimation("bomb"),!0;case 3:return this.setCurrentAnimation("trident-bomb"),!0;default:return!1}},onClick(){me.input.triggerKeyEvent(me.input.KEY.E,!0)},onRelease(){me.input.triggerKeyEvent(me.input.KEY.E,!1)},onOver(){this.onClick()},onOut(){this.onRelease()}}))},sound:new(me.GUI_Object.extend({init(){const e=me.loader.getImage("sound");this._super(me.GUI_Object,"init",[me.game.viewport.width-64,50,{image:e,frameheight:64,framewidth:64}]),this.pos.z=5,this.addAnimation("muted",[0]),this.addAnimation("unmuted",[1])},update(){game.options.sound.muted?this.setCurrentAnimation("muted"):this.setCurrentAnimation("unmuted")},onClick(){me.input.triggerKeyEvent(me.input.KEY.K,!0)},onRelease(){me.input.triggerKeyEvent(me.input.KEY.K,!1)}})),ammo:{value:0,font:new me.Font("Arial",32,"#FFFF5C","left")},damage:{value:0,font:new me.Font("Arial",16,"#C91D03","left")},reloadCost:{value:0,font:new me.Font("Arial",16,"#FFF","left")},score:{value:0,font:new me.Font("Arial",64,"#FFFF5C","center")},health:{value:0,font:new me.Font("Serif",24,"#C91D03","center")},line:new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,game.playing.player.pos.y,me.game.viewport.width,2]),this.anchorPoint.set(0,0),console.log("init")},draw(e){e.setColor("#CBA"),console.log(this.width),e.fillRect(this.pos.x,this.pos.y,this.width,this.height)},update:()=>!1}))},me.game.world.addChild(this.data.currentWeapon.sprite,3),me.game.world.addChild(this.data.sound,4),me.game.world.addChild(this.data.line,1)},update(){let e=!1;return this.data.ammo.value!==game.data.weapons[game.data.weaponEquipped].ammunition&&(this.data.ammo.value=game.data.weapons[game.data.weaponEquipped].ammunition,e=!0),this.data.damage.value!==game.data.weapons[game.data.weaponEquipped].damage&&(this.data.damage.value=game.data.weapons[game.data.weaponEquipped].damage,e=!0),this.data.reloadCost.value!==game.data.weapons[game.data.weaponEquipped].reloadCost&&(this.data.reloadCost.value=game.data.weapons[game.data.weaponEquipped].reloadCost,e=!0),this.data.health.value!==game.playing.player.stats.health&&(this.data.health.value=game.playing.player.stats.health,e=!0),this.data.score.value!==game.data.score&&(this.data.score.value=game.data.score,e=!0),e},draw(e){this.data.ammo.font.draw(e,this.data.ammo.value,64,50),this.data.damage.font.draw(e,`${this.data.damage.value}`,25,25),this.data.reloadCost.font.draw(e,`${this.data.reloadCost.value}`,25,70),this.data.score.font.draw(e,this.data.score.value,me.game.viewport.width/2,5),this.data.health.font.draw(e,this.data.health.value,game.playing.player.pos.x+game.playing.player.width/2+5,me.game.viewport.height-20)}}),game.GUI=game.GUI||{},game.GUI.SelectInput=me.Renderable.extend({init(e,t,i){this.$wrapper=$('<div class="dropdown wrapper">').css({top:e,left:0,right:0});const{title:n,id:o,options:r}=t;this.$select=$('<div class="select"></div>'),this.$selectBox=$(`\n\t\t\t<select name="${o}" id="${o}">\n\t\t\t\t<option disabled selected>${n}</option>\n\t\t\t</select>\n\t\t`);for(let e=0;e<r.length;e+=1){const t=r[e];this.$selectBox.append($(`<option value="${i?t.text:t.value}" ${me.device.isMobile&&t.active?"selected":""} ${t.active?'class="active"':""}>${t.text}</option>`))}this.$select.append(this.$selectBox),this.$wrapper.append(this.$select),$(me.video.getWrapper()).append(this.$wrapper)},destroy(){this.$wrapper.remove(),this.$selectBox.remove()}});const FontSize={header:36,subheader:18,p:24},minHeight=160;function creditElement(e,t,i){const n={text:e,height:game.Credits.currentHeight};game.Credits.currentHeight+=FontSize.header;const o={};t&&(o.text=t,o.height=game.Credits.currentHeight,game.Credits.currentHeight+=FontSize.subheader);const r=[];if(i)for(let e=0;e<i.length;e+=1)r.push({text:i[e],height:game.Credits.currentHeight}),game.Credits.currentHeight+=FontSize.p;return game.Credits.currentHeight+=FontSize.header,{header:n,subheader:o,items:r}}function findTheme(e){let t,i=0;for(let n=0;n<game.themes.length;n+=1)for(let o=0;o<game.themes[n].levels.length;o+=1){if(e===i)return t={theme:game.themes[n],stage:game.themes[n].levels[o]};i+=1}const n=game.Entities.EnemyList.length;return{theme:{track:"cold_stone",enemies:Array.from(Array(n).keys())},stage:{play:"#000",won:"#63C664",lost:"#FFF"}}}game.Credits={FontSize:FontSize,minHeight:minHeight,transitionSpeed:.5,buildElements:()=>{const e=[];for(let t=0;t<game.Credits.elements.length;t+=1)e.push(creditElement(game.Credits.elements[t].header,game.Credits.elements[t].subheader,game.Credits.elements[t].items));return e}},game.Credits=game.Credits||{},game.Credits.elements=[{header:"Author",items:["Francisco Knebel"]},{header:"Artwork"},{header:"MillionthVector",subheader:"(http://millionthvector.blogspot.com.br/p/free-sprites.html)",items:["Player Spaceship:","F5S3","","Enemy Spaceship:","att2","att5","blueship2","blueship3","RD1","RD2","RD3"]},{header:"Freepik",items:["Weapon icons:","Bomb","Trident"]},{header:"Creaticca Creative Agency",items:["Weapon icons:","Shotgun"]},{header:"Smashicons",subheader:"https://www.flaticon.com/packs/essential-set-2/",items:["Sound icons"]},{header:"Music"},{header:"Sirius Beat",subheader:"(http://youtu.be/zIRo7NJ4uLE)",items:["Tronicles"]},{header:"OBLIDIVM",subheader:"(http://oblidivmmusic.blogspot.com.es)",items:["Rain of Lasers","Defeated","Victory Tune","DeathMatch"]},{header:"cyguration",subheader:"(https://modarchive.org/forums/index.php?topic=1620.0)",items:["Tranquil Trance Express","Cold Stone"]}],game.Screens=game.Screens||{},game.Screens.Credits=me.ScreenObject.extend({onResetEvent(){me.audio.playTrack("cold_stone");const e=me.game.viewport.width/2;me.game.world.addChild(new me.ColorLayer("background","#000000"),0),game.Credits.currentHeight=me.game.viewport.height;const t=game.Credits.buildElements();me.game.world.addChild(new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,0,me.game.viewport.width,game.Credits.minHeight]),this.setOpacity(1),this.anchorPoint.set(0,0),this.title=new me.Font("Serif",72,"#FFFFFF","center"),this.version=new me.Font("Serif",24,"#FFFFFF","center")},draw(e){e.setColor("#000"),e.fillRect(0,0,this.width,this.height),game.Title.draw(e,this.title,this.version)},update:()=>!0,onDestroyEvent(){}})),2),me.game.world.addChild(new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,150,me.game.viewport.width,me.game.viewport.height]),this.anchorPoint.set(0,0),this.btnFont=new me.Font("Serif",32,"#FFFFFF","center"),this.header=new me.Font("Serif",game.Credits.FontSize.header,"#FFFFFF","center"),this.subheader=new me.Font("Serif",game.Credits.FontSize.subheader,"#FFFFFF","center"),this.p=new me.Font("Serif",game.Credits.FontSize.p,"#FFFFFF","center")},draw(i){0===t.length&&(me.device.isMobile?this.btnFont.draw(i,"TOUCH TO CONTINUE",e,400):this.btnFont.draw(i,"PRESS ENTER TO CONTINUE",e,400));for(let n=0;n<t.length;n+=1){if(t[n].header.height-=game.Credits.transitionSpeed,this.header.draw(i,t[n].header.text,e,t[n].header.height),t[n].subheader.text&&(t[n].subheader.height-=game.Credits.transitionSpeed,this.subheader.draw(i,t[n].subheader.text,e,t[n].subheader.height)),t[n].items)for(let o=0;o<t[n].items.length;o+=1)t[n].items[o].height-=game.Credits.transitionSpeed,this.p.draw(i,t[n].items[o].text,e,t[n].items[o].height);let o,r=!1;t[n].items.length>0?(o=t[n].items[t[n].items.length-1].height)<game.Credits.minHeight-game.Credits.FontSize.p&&(r=!0):t[n].subheader.text?(o=t[n].subheader.height)<game.Credits.minHeight-game.Credits.FontSize.subheader&&(r=!0):(o=t[n].header.height)<game.Credits.minHeight-game.Credits.FontSize.header&&(r=!0),r&&t.splice(n,1)}},update:()=>!0,onDestroyEvent(){}})),1),me.input.bindKey(me.input.KEY.ENTER,"resume",!0),me.input.bindPointer(me.input.pointer.LEFT,me.input.KEY.ENTER),this.handler=me.event.subscribe(me.event.KEYDOWN,e=>{"resume"===e&&me.state.change(me.state.MENU)})},onDestroyEvent(){me.input.unbindKey(me.input.KEY.ENTER),me.input.unbindPointer(me.input.pointer.LEFT),me.event.unsubscribe(this.handler),me.audio.stopTrack()}}),game.Screens=game.Screens||{},game.Screens.Help=me.ScreenObject.extend({onResetEvent(e){me.audio.pauseTrack(),me.audio.play("hit"),me.game.world.addChild(new me.ColorLayer("background","#000000"),0),me.game.world.addChild(new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,0,me.game.viewport.width,me.game.viewport.height]),this.anchorPoint.set(0,0),this.titleFont=new me.Font("Serif",72,"#FFFFFF","center"),this.version=new me.Font("Serif",24,"#FFFFFF","center"),this.commandFont=new me.Font("Serif",24,"#FFFFFF","left"),this.descriptionFont=new me.Font("Serif",24,"#FFFFFF","right"),this.btnFont=new me.Font("Serif",32,"#FFFFFF","center")},draw(e){game.Title.draw(e,this.titleFont,this.version);let t=175;me.device.isMobile?(this.commandFont.draw(e,"Movement",50,t),t+=35,this.descriptionFont.draw(e,"use your accelerometer",me.game.viewport.width-50,t),t+=75,this.commandFont.draw(e,"Touch screen",50,t),t+=35,this.descriptionFont.draw(e,"shoot",me.game.viewport.width-50,t),t+=75,this.commandFont.draw(e,"Touch weapon",50,t),t+=35,this.descriptionFont.draw(e,"switch weapons",me.game.viewport.width-50,t)):(this.commandFont.draw(e,"A & LEFT",50,t),this.descriptionFont.draw(e,"move left",me.game.viewport.width-50,t),t+=35,this.commandFont.draw(e,"D & RIGHT",50,t),this.descriptionFont.draw(e,"move right",me.game.viewport.width-50,t),t+=35,this.commandFont.draw(e,"SPACE & LCLICK",50,t),this.descriptionFont.draw(e,"shoot",me.game.viewport.width-50,t),t+=35,this.commandFont.draw(e,"Q & E",50,t),this.descriptionFont.draw(e,"switch weapons",me.game.viewport.width-50,t),t+=35,this.commandFont.draw(e,"R",50,t),this.descriptionFont.draw(e,"reload",me.game.viewport.width-50,t),t+=35,this.commandFont.draw(e,"J/K/L & 1/2/3",50,t),this.descriptionFont.draw(e,"+/Mute/- Volume",me.game.viewport.width-50,t)),t+=50,me.device.isMobile?this.btnFont.draw(e,"TOUCH TO CONTINUE",me.game.viewport.width/2,t):this.btnFont.draw(e,"PRESS ENTER TO CONTINUE",me.game.viewport.width/2,t)},update:()=>!0,onDestroyEvent(){}})),2),me.input.bindKey(me.input.KEY.ENTER,"resume",!0),me.input.bindPointer(me.input.pointer.LEFT,me.input.KEY.ENTER),this.handler=me.event.subscribe(me.event.KEYDOWN,t=>{"resume"===t&&(e?me.state.change(me.state.MENU):me.state.change(me.state.PLAY,game.data.level,!1))})},onDestroyEvent(){me.input.unbindKey(me.input.KEY.ENTER),me.input.unbindPointer(me.input.pointer.LEFT),me.event.unsubscribe(this.handler)}}),game.Screens=game.Screens||{},game.Screens.Highscores=me.ScreenObject.extend({onResetEvent(){me.audio.pauseTrack(),me.audio.play("hit"),me.game.world.addChild(new me.ColorLayer("background","#000000"),0);const e=[];let t="Fetching scores...";const i=`${game.constants.highscoresURI}/api/v1/scores/top10/all-time/${game.constants.version}`;fetch(i).then(e=>e.json()).then(i=>{e.push(...i.data),0===i.data.length&&(t="No results.")}),me.game.world.addChild(new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,0,me.game.viewport.width,me.game.viewport.height]),this.anchorPoint.set(0,0),this.titleFont=new me.Font("Serif",32,"#FFFFFF","center"),this.version=new me.Font("Serif",20,"#FFFFFF","center"),this.scores=new me.Font("Serif",28,"#FFFFFF","left"),this.btnFont=new me.Font("Serif",32,"#FFFFFF","center")},draw(i){if(game.Title.draw(i,this.titleFont,this.version,50,82),e.length>0){let t=130;this.titleFont.draw(i,"TOP 10",me.game.viewport.width/2,t),t+=30;for(let n=0;n<e.length&&n<10;n+=1)t+=30,this.scores.draw(i,`${n+1}: ${e[n].score} - level ${e[n].level} - ${e[n].player}`,me.game.viewport.width/4,t)}else this.btnFont.draw(i,t,me.game.viewport.width/2,200);me.device.isMobile?this.btnFont.draw(i,"TOUCH TO CONTINUE",me.game.viewport.width/2,550):this.btnFont.draw(i,"PRESS ENTER TO CONTINUE",me.game.viewport.width/2,550)},update:()=>!0,onDestroyEvent(){}})),2),me.input.bindKey(me.input.KEY.ENTER,"resume",!0),me.input.bindPointer(me.input.pointer.LEFT,me.input.KEY.ENTER),this.handler=me.event.subscribe(me.event.KEYDOWN,e=>{"resume"===e&&me.state.change(me.state.MENU)})},onDestroyEvent(){me.input.unbindKey(me.input.KEY.ENTER),me.input.unbindPointer(me.input.pointer.LEFT),me.event.unsubscribe(this.handler)}}),game.socket=io(game.constants.highscoresURI),game.socket.submitNewScore=((e,t,i)=>{game.socket.emit("new score",e,t,i,me.device.isMobile,game.constants.version)}),game.socket.on("score saved",()=>{console.log("Score is saved")}),game.themes=[{track:"tronicles",enemies:[0,1,2,3],levels:[{probability:[6,2,0,0],play:"#246482",won:"#63C664",lost:"#FFF"},{probability:[4,2,1,0],play:"#1D5068",won:"#63C664",lost:"#FFF"},{probability:[3,3,1,0],play:"#174053",won:"#63C664",lost:"#FFF"},{probability:[2,5,1,0],play:"#123342",won:"#63C664",lost:"#FFF"},{probability:[4,0,3,1],play:"#0E2935",won:"#63C664",lost:"#FFF"},{probability:[4,3,2,0],play:"#5A7D8A",won:"#C78213",lost:"#66D8E8"},{probability:[4,4,3,2],play:"#48646E",won:"#C78213",lost:"#66D8E8"},{probability:[1,5,1,3],play:"#3A5058",won:"#C78213",lost:"#66D8E8"},{probability:[1,5,3,5],play:"#2E4046",won:"#C78213",lost:"#66D8E8"},{track:"deathmatch",boss:[0],probability:[2,1,2,1],play:"#81451B",won:"#C78213",lost:"#66D8E8"}]},{track:"rain_of_lasers",enemies:[2,3],levels:[{probability:[1,3],play:"#0B4FE1",won:"#BE166C",lost:"#E1B65D"}]}],game.buildLevel=((e,t)=>{const{theme:i,stage:n}=findTheme(e),{boss:o,probability:r}=n,{enemies:s}=i,a=n[t];return me.game.world.addChild(new me.ColorLayer("background",a),0),{theme:i,stage:n,enemyConfig:{probability:r,enemies:s,boss:o},background:a}}),game.Screens=game.Screens||{},game.Screens.Lost=me.ScreenObject.extend({onResetEvent(){const{level:e}=game.data;game.buildLevel(e,"lost"),me.audio.stopTrack(),me.audio.play("lost");const t=new Date;let i=game.constants.bufferTimeLimitMS;me.game.world.addChild(new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,0,me.game.viewport.width,me.game.viewport.height]),this.anchorPoint.set(0,0),this.titleFont=new me.Font("Serif",72,"#000","center"),this.level=new me.Font("Serif",32,"#000","center"),this.points=new me.Font("Serif",32,"#000","center"),this.btnFont=new me.Font("Serif",32,"#000","center"),this.timeCountdown=new Date},draw(e){this.titleFont.draw(e,"YOU LOSE!",me.game.viewport.width/2,150),this.level.draw(e,`Final level: ${game.data.level+1}`,me.game.viewport.width/2,250),this.points.draw(e,`Total Points: ${game.data.score}`,me.game.viewport.width/2,300),this.points.draw(e,`Total Time: ${(game.data.endPlayTime/1e3).toFixed(3)}s`,me.game.viewport.width/2,350),me.device.isMobile?this.btnFont.draw(e,"TOUCH TO CONTINUE",me.game.viewport.width/2,410):this.btnFont.draw(e,"PRESS ENTER TO CONTINUE",me.game.viewport.width/2,410),i>0&&(i=game.constants.bufferTimeLimitMS-(new Date-t)),i>0&&this.points.draw(e,`${(i/1e3).toFixed(3)}s`,me.game.viewport.width/2,440)},update:()=>!0,onDestroyEvent(){}})),2),me.game.world.addChild(new game.GUI.ScoreInput(500,"text",10,e=>{e.length>0&&game.socket.submitNewScore(game.data.score,game.data.level+1,e)}),3),me.input.bindKey(me.input.KEY.ENTER,"continue",!0),me.input.bindPointer(me.input.pointer.LEFT,me.input.KEY.ENTER),this.handler=me.event.subscribe(me.event.KEYDOWN,e=>{"continue"===e&&i<=0&&(game.data.level=0,game.data.score=0,me.state.change(me.state.MENU))})},onDestroyEvent(){me.input.unbindKey(me.input.KEY.ENTER),me.input.unbindPointer(me.input.pointer.LEFT),me.event.unsubscribe(this.handler),me.audio.stopTrack()}}),game.Screens=game.Screens||{},game.Screens.Play=me.ScreenObject.extend({onResetEvent(e,t){const{theme:i,stage:n,enemyConfig:o}=game.buildLevel(e,"play");me.audio.pauseTrack(),t?me.audio.playTrack(game.themes[0].track):o.boss?(me.audio.stopTrack(),me.audio.playTrack(n.track)):me.audio.getCurrentTrack()!==i.track?(me.audio.stopTrack(),me.audio.playTrack(i.track)):me.audio.resumeTrack(),this.player=me.pool.pull("player"),me.game.world.addChild(this.player,1),this.enemyManager=new game.Entities.EnemyManager(o),me.game.world.addChild(this.enemyManager,2),this.HUD=new game.GUI.HUD.Container,me.game.world.addChild(this.HUD),me.input.bindKey(me.input.KEY.LEFT,"left"),me.input.bindKey(me.input.KEY.RIGHT,"right"),me.input.bindKey(me.input.KEY.A,"left"),me.input.bindKey(me.input.KEY.D,"right"),me.input.bindKey(me.input.KEY.SPACE,"shoot",!0),me.input.bindPointer(me.input.pointer.LEFT,me.input.KEY.SPACE),me.input.bindKey(me.input.KEY.J,"volume-plus"),me.input.bindKey(me.input.KEY.K,"volume-mute",!0),me.input.bindKey(me.input.KEY.L,"volume-minus"),me.input.bindKey(me.input.KEY.NUM1,"volume-plus"),me.input.bindKey(me.input.KEY.NUM2,"volume-mute",!0),me.input.bindKey(me.input.KEY.NUM3,"volume-minus"),me.input.registerPointerEvent("wheel",me.game.viewport,e=>{me.event.publish("wheel",[e])}),me.input.bindKey(me.input.KEY.H,"help",!0),this.handler=me.event.subscribe(me.event.KEYDOWN,e=>{"help"===e&&(game.data.score-=game.data.levelscore,game.data.levelscore=0,me.state.change(me.state.HELP))}),me.input.bindKey(me.input.KEY.Q,"weapon-minus",!0),me.input.bindKey(me.input.KEY.E,"weapon-plus",!0),me.input.bindKey(me.input.KEY.R,"reload",!0)},onDestroyEvent(){me.input.unbindKey(me.input.KEY.LEFT),me.input.unbindKey(me.input.KEY.RIGHT),me.input.unbindKey(me.input.KEY.A),me.input.unbindKey(me.input.KEY.D),me.input.unbindKey(me.input.KEY.SPACE),me.input.unbindPointer(me.input.pointer.LEFT),me.input.unbindKey(me.input.KEY.H),me.input.unbindKey(me.input.KEY.J),me.input.unbindKey(me.input.KEY.K),me.input.unbindKey(me.input.KEY.L),me.input.unbindKey(me.input.KEY.NUM1),me.input.unbindKey(me.input.KEY.NUM2),me.input.unbindKey(me.input.KEY.NUM3),me.input.releasePointerEvent("wheel",me.game.viewport),me.input.unbindKey(me.input.KEY.Q),me.input.unbindKey(me.input.KEY.E),me.input.unbindKey(me.input.KEY.R)},checkIfLoss(e){return e>=this.player.pos.y&&(me.audio.pauseTrack(),game.data.endPlayTime=new Date-game.data.startPlayTime,me.state.change(me.state.GAMEOVER),!0)}}),game.Screens=game.Screens||{},game.Screens.Won=me.ScreenObject.extend({onResetEvent(){const{level:e}=game.data;game.buildLevel(e,"won"),me.audio.play("won"),game.data.levelscore=0;const t=new Date;let i=game.constants.bufferTimeLimitMS;me.game.world.addChild(new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,0,me.game.viewport.width,me.game.viewport.height]),this.anchorPoint.set(0,0),this.titleFont=new me.Font("Serif",48,"#000","center"),this.points=new me.Font("Serif",32,"#000","center"),this.time=new me.Font("Serif",32,"#000","center"),this.btnFont=new me.Font("Serif",32,"#000","center")},draw(e){this.titleFont.draw(e,`LEVEL ${game.data.level+1} CLEARED!`,me.game.viewport.width/2,150),this.points.draw(e,`Total Points: ${game.data.score}`,me.game.viewport.width/2,300),this.time.draw(e,`Total Time: ${(game.data.endPlayTime/1e3).toFixed(3)}s`,me.game.viewport.width/2,350),me.device.isMobile?this.btnFont.draw(e,"TOUCH TO CONTINUE",me.game.viewport.width/2,410):this.btnFont.draw(e,"PRESS ENTER TO CONTINUE",me.game.viewport.width/2,410),i>0&&(i=game.constants.bufferTimeLimitMS-(new Date-t)),i>0&&this.points.draw(e,`${(i/1e3).toFixed(3)}s`,me.game.viewport.width/2,440)},update:()=>!0,onDestroyEvent(){}})),2),me.input.bindKey(me.input.KEY.ENTER,"continue",!0),me.input.bindPointer(me.input.pointer.LEFT,me.input.KEY.ENTER),this.handler=me.event.subscribe(me.event.KEYDOWN,e=>{"continue"===e&&i<=0&&(game.data.level+=1,me.state.change(me.state.PLAY,game.data.level,!1))})},onDestroyEvent(){me.input.unbindKey(me.input.KEY.ENTER),me.input.unbindPointer(me.input.pointer.LEFT),me.event.unsubscribe(this.handler)}}),game.Screens=game.Screens||{},game.Screens.Settings=me.ScreenObject.extend({onResetEvent(){me.audio.play("hit"),me.game.world.addChild(new me.ColorLayer("background","#000000"),0),me.game.world.addChild(new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,0,me.game.viewport.width,me.game.viewport.height]),this.anchorPoint.set(0,0),this.titleFont=new me.Font("Serif",32,"#FFFFFF","center"),this.version=new me.Font("Serif",20,"#FFFFFF","center")},draw(e){game.Title.draw(e,this.titleFont,this.version,50,82)},update:()=>!0,onDestroyEvent(){}})),2),this.createSelectBoxes(),this.createMenuButtons(),me.input.bindKey(me.input.KEY.NUM1,"exit_save",!0),me.input.bindKey(me.input.KEY.NUM2,"exit_clear",!0),this.handler=me.event.subscribe(me.event.KEYDOWN,e=>{if("exit_save"===e){const e=this.updateOptions();game.storage.saveOptions(e),iziToast.info({id:"settings",title:"Changes saved!",message:"Reloading to apply changes.",position:"topCenter",toastOnce:"settings",close:!1,animateInside:!1,timeout:2e3,onClosing:()=>{document.location.reload()}})}"exit_clear"===e&&me.state.change(me.state.MENU)})},createSelectBoxes(){let e=game.storage.checkOptions();e||(e=game.storage.saveOptions(game.game_options));let t=150;for(const e of game.settingsOptions){const i=this.setActiveOptions(e);let n=!1;"resolution"===e.id&&(n=!0),me.game.world.addChild(new game.GUI.SelectInput(t,i,n)),t+=50}},setActiveOptions(e){let t=0;switch(e.id){case"resolution":for(t=0;t<e.options.length;t+=1)e.options[t].active=game.options.resolution.width===e.options[t].value.width&&game.options.resolution.height===e.options[t].value.height;break;case"scale":case"scaleMethod":case"antiAlias":case"doubleBuffering":for(t=0;t<e.options.length;t+=1)e.options[t].active=e.options[t].value===game.options.rendering[e.id];break;case"sound":for(t=0;t<e.options.length;t+=1)e.options[t].active=e.options[t].value===game.options.sound.quality}return e},updateOptions(){const e=game.settingsOptions.map(e=>e.id);let t;for(const i of e)switch(i){case"resolution":if(t=$(`#${i}`).val())for(const e of game.settingsOptions[0].options)e.text===t&&(game.options.resolution=e.value);break;case"scale":case"scaleMethod":case"antiAlias":case"doubleBuffering":(t=$(`#${i}`).val())&&(game.options.rendering[i]=t);break;case"sound":(t=$(`#${i}`).val())&&(game.options.sound.quality=t)}return game.options},createMenuButtons(){const e=me.game.viewport.height-35;me.game.world.addChild(new game.settingsSaveButton(me.game.viewport.width/3,e)),me.game.world.addChild(new game.settingsExitButton(me.game.viewport.width/1.5,e))},onDestroyEvent(){me.input.unbindKey(me.input.KEY.NUM1),me.input.unbindKey(me.input.KEY.NUM2),me.event.unsubscribe(this.handler)}}),game.menuButton1=game.menuButton.extend({onClick(){me.input.triggerKeyEvent(me.input.KEY.NUM1,!0)},onRelease(){me.input.triggerKeyEvent(me.input.KEY.NUM1,!1)}}),game.menuButton2=game.menuButton.extend({onClick(){me.input.triggerKeyEvent(me.input.KEY.NUM2,!0)},onRelease(){me.input.triggerKeyEvent(me.input.KEY.NUM2,!1)}}),game.menuButton3=game.menuButton.extend({onClick(){me.input.triggerKeyEvent(me.input.KEY.NUM3,!0)},onRelease(){me.input.triggerKeyEvent(me.input.KEY.NUM3,!1)}}),game.menuButton4=game.menuButton.extend({onClick(){me.input.triggerKeyEvent(me.input.KEY.NUM4,!0)},onRelease(){me.input.triggerKeyEvent(me.input.KEY.NUM4,!1)}}),game.menuButton5=game.menuButton.extend({onClick(){me.input.triggerKeyEvent(me.input.KEY.NUM5,!0)},onRelease(){me.input.triggerKeyEvent(me.input.KEY.NUM5,!1)}}),game.Screens=game.Screens||{},game.Screens.Start=me.ScreenObject.extend({onResetEvent(){me.game.world.addChild(new me.ColorLayer("background","#000"),0),me.game.world.addChild(new(me.Renderable.extend({init(){this._super(me.Renderable,"init",[0,0,me.game.viewport.width,me.game.viewport.height]),this.anchorPoint.set(0,0),this.title=new me.Font("Serif",72,"#FFFFFF","center"),this.version=new me.Font("Serif",24,"#FFFFFF","center")},draw(e){game.Title.draw(e,this.title,this.version)},update:()=>!0,onDestroyEvent(){}})),2),this.createMenuButtons(),me.input.bindKey(me.input.KEY.ENTER,"enter",!0),me.input.bindKey(me.input.KEY.UP,"up",!0),me.input.bindKey(me.input.KEY.W,"up",!0),me.input.bindKey(me.input.KEY.DOWN,"down",!0),me.input.bindKey(me.input.KEY.S,"down",!0),me.input.bindKey(me.input.KEY.NUM1,"numericEnter",!0),me.input.bindKey(me.input.KEY.NUM2,"numericEnter",!0),me.input.bindKey(me.input.KEY.NUM3,"numericEnter",!0),me.input.bindKey(me.input.KEY.NUM4,"numericEnter",!0),me.input.bindKey(me.input.KEY.NUM5,"numericEnter",!0),me.input.bindKey(me.input.KEY.NUMPAD1,"numericEnter",!0),me.input.bindKey(me.input.KEY.NUMPAD2,"numericEnter",!0),me.input.bindKey(me.input.KEY.NUMPAD3,"numericEnter",!0),me.input.bindKey(me.input.KEY.NUMPAD4,"numericEnter",!0),me.input.bindKey(me.input.KEY.NUMPAD5,"numericEnter",!0),this.handleMenuOptions()},createMenuButtons(){const e=me.game.viewport.width/2,t=[220,280,370,430,490];me.game.world.addChild(new game.menuButton1(e,t[0],300,50,"ui/startMenu/1")),me.game.world.addChild(new game.menuButton2(e,t[1],300,50,"ui/startMenu/2")),me.game.world.addChild(new game.menuButton3(e,t[2],300,50,"ui/startMenu/3")),me.game.world.addChild(new game.menuButton4(e,t[3],300,50,"ui/startMenu/4")),me.game.world.addChild(new game.menuButton5(e,t[4],300,50,"ui/startMenu/5"))},handleMenuOptions(){const e={bounds:{up:1,down:5},current:1};this.handler=me.event.subscribe(me.event.KEYDOWN,(t,i)=>{if("up"===t&&e.current>e.bounds.up)e.current-=1;else if("down"===t&&e.current<e.bounds.down)e.current+=1;else if("enter"===t||"numericEnter"===t)switch("numericEnter"===t&&(e.current=this.handleNumericInput(i)),e.current){case 1:game.data.startPlayTime=new Date,game.data.level=0,game.data.score=0,me.state.change(me.state.PLAY,game.data.level,!0);break;case 2:me.state.change(me.state.HELP,!0);break;case 3:me.state.change(me.state.SETTINGS,!0);break;case 4:me.state.change(me.state.CREDITS);break;case 5:me.state.change(me.state.SCORE)}})},handleNumericInput(e){switch(e){case me.input.KEY.NUM1:case me.input.KEY.NUMPAD1:return 1;case me.input.KEY.NUM2:case me.input.KEY.NUMPAD2:return 2;case me.input.KEY.NUM3:case me.input.KEY.NUMPAD3:return 3;case me.input.KEY.NUM4:case me.input.KEY.NUMPAD4:return 4;case me.input.KEY.NUM5:case me.input.KEY.NUMPAD5:return 5;default:return 0}},onDestroyEvent(){me.input.unbindKey(me.input.KEY.ENTER),me.input.unbindKey(me.input.KEY.UP),me.input.unbindKey(me.input.KEY.W),me.input.unbindKey(me.input.KEY.DOWN),me.input.unbindKey(me.input.KEY.S),me.input.unbindKey(me.input.KEY.NUM1),me.input.unbindKey(me.input.KEY.NUM2),me.input.unbindKey(me.input.KEY.NUM3),me.input.unbindKey(me.input.KEY.NUM4),me.input.unbindKey(me.input.KEY.NUM5),me.input.unbindKey(me.input.KEY.NUMPAD1),me.input.unbindKey(me.input.KEY.NUMPAD2),me.input.unbindKey(me.input.KEY.NUMPAD3),me.input.unbindKey(me.input.KEY.NUMPAD4),me.input.unbindKey(me.input.KEY.NUMPAD5),me.event.unsubscribe(this.handler)}}),game.Title={version:game.constants.version,version_date:game.constants.version_date,draw(e,t,i,n=50,o=130){t.draw(e,"Space Invader",me.game.viewport.width/2,n),i.draw(e,`version ${this.version} - ${this.version_date}`,me.game.viewport.width/2,o)}};